<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[使用python实现BLE通讯]]></title>
      <url>https://draapho.github.io/2016/11/15/1616-python-ble/</url>
      <content type="html"><![CDATA[<h1 id="环境与资源"><a href="#环境与资源" class="headerlink" title="环境与资源"></a>环境与资源</h1><ul>
<li>windows 开发环境</li>
<li>python 2.7</li>
<li><a href="https://github.com/peplin/pygatt" target="_blank" rel="external">pygatt</a></li>
<li>Bluegiga 的 <a href="http://www.silabs.com/products/wireless/bluetooth/bluetooth-smart-modules/Pages/bled112-bluetooth-smart-dongle.aspx" target="_blank" rel="external">BLED112 Bluetooth Smart Dongle</a></li>
</ul>
<h1 id="闲扯"><a href="#闲扯" class="headerlink" title="闲扯"></a>闲扯</h1><ul>
<li>背景, 需要在windows上做一款基于BLE通讯的软件. 第一反应, 痛苦.</li>
<li>使用的是 Bluegiga 的BLE方案, 协议栈芯片内置, 串口通讯即可, 并寻得 <a href="https://github.com/jrowberg/bglib" target="_blank" rel="external">bglib</a> 这么一个python库, 还有范例!</li>
<li>不幸的是, 自己功力不够, 基于此函数库开发出的BLE通讯, 非常不稳定… 没有痛下决心自己写, 于是继续尝试寻找资源.</li>
<li>觅得 <a href="https://github.com/peplin/pygatt" target="_blank" rel="external">pygatt</a> 方案, 三平台全支持! windows 和 mac 下正是基于bglib实现的!</li>
<li><a href="https://github.com/peplin/pygatt" target="_blank" rel="external">pygatt</a> 是python的第三方库, 说明文档比较少, 测试了一下非常好用!</li>
</ul>
<h1 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h1><ul>
<li>DEVICE_ADDRESS, 默认的需要connect的BLE地址</li>
<li>基于 Bluegiga 的 <code>cable_replacement</code> 范例, 其 characteristic uuid 为 <code>e7add780-b042-4876-aae1-112855353cc1</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pygatt</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Many devices, e.g. Fitbit, use random addressing - this is required to connect.</span></div><div class="line">ADDRESS_TYPE = pygatt.BLEAddressType.random</div><div class="line">DEVICE_ADDRESS = <span class="string">"00:07:80:BF:6A:73"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">indication_callback</span><span class="params">(handle, value)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"indication, handle %d: %s "</span> % (handle, value)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pytest</span><span class="params">(address=DEVICE_ADDRESS, type=pygatt.BLEAddressType.public)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        adapter = pygatt.BGAPIBackend()</div><div class="line">        adapter.start()</div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"===== adapter.scan() ====="</span></div><div class="line">        devices = adapter.scan()</div><div class="line">        <span class="keyword">for</span> dev <span class="keyword">in</span> devices:</div><div class="line">            <span class="comment"># print dev</span></div><div class="line">            <span class="keyword">print</span> <span class="string">"address: %s, name: %s "</span> % (dev[<span class="string">'address'</span>], dev[<span class="string">'name'</span>])</div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"===== adapter.connect() ====="</span></div><div class="line">        device = adapter.connect(address, address_type=type)</div><div class="line">        <span class="keyword">print</span> <span class="string">"address: "</span> + str(device._address)</div><div class="line">        <span class="keyword">print</span> <span class="string">"handle : "</span> + str(device._handle)</div><div class="line">        <span class="keyword">print</span> <span class="string">"rssi   : "</span> + str(device.get_rssi())</div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"====== device.discover_characteristics() ====="</span></div><div class="line">        <span class="keyword">for</span> uuid <span class="keyword">in</span> device.discover_characteristics().keys():</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                print(<span class="string">"Read UUID %s (handle %d): %s"</span> %</div><div class="line">                      (uuid, device.get_handle(uuid), binascii.hexlify(device.char_read(uuid))))</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                print(<span class="string">"Read UUID %s (handle %d): %s"</span> %</div><div class="line">                      (uuid, device.get_handle(uuid), <span class="string">"!deny!"</span>))</div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"====== device.char_read() / device.char_read_handle() ====="</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"2a00: "</span> + device.char_read(<span class="string">"00002a00-0000-1000-8000-00805f9b34fb"</span>)</div><div class="line">        <span class="keyword">print</span> <span class="string">"2a00: "</span> + device.char_read_handle(<span class="number">3</span>)</div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"====== device.subscribe() ====="</span></div><div class="line">        device.subscribe(<span class="string">"e7add780-b042-4876-aae1-112855353cc1"</span>,</div><div class="line">                         callback=indication_callback, indication=<span class="keyword">True</span>)</div><div class="line">        <span class="comment"># device.receive_notification(8, "test")</span></div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"====== device.char_write_handle() ====="</span></div><div class="line">        in_buf = map(ord, <span class="string">"hello world, hello BLE!!!"</span>)</div><div class="line">        <span class="comment"># send via uuid &amp; handle, maximum is 20 bytes</span></div><div class="line">        device.char_write(<span class="string">"e7add780-b042-4876-aae1-112855353cc1"</span>, in_buf[:<span class="number">20</span>])</div><div class="line">        device.char_write_handle(<span class="number">0x08</span>, in_buf[<span class="number">20</span>:])</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (<span class="keyword">True</span>):</div><div class="line">            time.sleep(<span class="number">0.1</span>)</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        adapter.stop()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="comment"># logging.basicConfig()</span></div><div class="line">    <span class="comment"># logging.getLogger('pygatt').setLevel(logging.DEBUG)</span></div><div class="line">    pytest()</div></pre></td></tr></table></figure>
<h1 id="BleDevice-类"><a href="#BleDevice-类" class="headerlink" title="BleDevice 类"></a>BleDevice 类</h1><ul>
<li>为了方便使用, 自己基于 pygatt 再打包一层</li>
<li>遗憾的是没有disconnect的通知. 可以参考 <a href="https://github.com/peplin/pygatt/issues/72" target="_blank" rel="external">Disconnect event not shown</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pygatt</div><div class="line"><span class="keyword">import</span> logging</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BleDevice</span><span class="params">(pygatt.BGAPIBackend)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.device = <span class="keyword">None</span></div><div class="line">        self.adapter = pygatt.BGAPIBackend()</div><div class="line">        self.adapter.start()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(self)</span>:</span></div><div class="line">        self.adapter.stop()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(self, timeout=<span class="number">5</span>)</span>:</span></div><div class="line">        self.devices = self.adapter.scan(timeout)</div><div class="line">        <span class="keyword">return</span> self.devices</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connect_name</span><span class="params">(self, name, devices=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> devices <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            devices = self.devices</div><div class="line">        <span class="keyword">for</span> dev <span class="keyword">in</span> self.devices:</div><div class="line">            <span class="keyword">if</span> name == dev[<span class="string">'name'</span>]:</div><div class="line">                <span class="keyword">return</span> self.connect(dev[<span class="string">'address'</span>])</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(self, address)</span>:</span></div><div class="line">        self.device = self.adapter.connect(address)</div><div class="line">        <span class="keyword">return</span> self.device</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">discover_characteristics</span><span class="params">(self, device=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        characteristics = []</div><div class="line">        <span class="keyword">for</span> uuid <span class="keyword">in</span> device.discover_characteristics().keys():</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                device.char_read(uuid)</div><div class="line">                characteristics.append(</div><div class="line">                    &#123;<span class="string">'uuid'</span>: uuid, <span class="string">'handle'</span>: device.get_handle(uuid), <span class="string">'readable'</span>: <span class="keyword">True</span>&#125;)</div><div class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">                <span class="keyword">if</span> <span class="string">"unable to read"</span> <span class="keyword">in</span> str(e).lower():</div><div class="line">                    characteristics.append(</div><div class="line">                        &#123;<span class="string">'uuid'</span>: uuid, <span class="string">'handle'</span>: device.get_handle(uuid), <span class="string">'readable'</span>: <span class="keyword">False</span>&#125;)</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    <span class="keyword">raise</span> e</div><div class="line">        <span class="keyword">return</span> characteristics</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_indication</span><span class="params">(self, uuid, device=None, callback=None, indication=True)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        device.subscribe(uuid, callback, indication)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_characteristics</span><span class="params">(self, uuid, device=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        <span class="keyword">return</span> device.char_read(uuid)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_characteristics_handle</span><span class="params">(self, handle, device=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        <span class="keyword">return</span> device.char_read_handle(handle)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_characteristics</span><span class="params">(self, str, uuid, device=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        data = map(ord, str)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(data), <span class="number">20</span>):</div><div class="line">            device.char_write(uuid, data[i:i + <span class="number">20</span>])</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_characteristics_handle</span><span class="params">(self, str, handle, device=None)</span>:</span></div><div class="line">        <span class="keyword">if</span> device <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            device = self.device</div><div class="line">        data = map(ord, str)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(data), <span class="number">20</span>):</div><div class="line">            device.char_write_handle(handle, data[i:i + <span class="number">20</span>])</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="comment"># logging.basicConfig()</span></div><div class="line">    <span class="comment"># logging.getLogger('pygatt').setLevel(logging.DEBUG)</span></div><div class="line">    ble = BleDevice()</div><div class="line">    <span class="keyword">print</span> ble.scan()</div><div class="line">    device = ble.connect_name(<span class="string">"Bluegiga CR Demo"</span>)</div><div class="line">    <span class="keyword">print</span> device._address</div><div class="line">    chars = ble.discover_characteristics(device)</div><div class="line">    <span class="keyword">print</span> chars</div><div class="line">    <span class="comment"># print chars[0]['uuid']</span></div><div class="line">    <span class="keyword">print</span> ble.read_characteristics(chars[<span class="number">1</span>][<span class="string">'uuid'</span>])</div><div class="line">    ble.write_characteristics(<span class="string">"hello world"</span>, chars[<span class="number">0</span>][<span class="string">'uuid'</span>])</div></pre></td></tr></table></figure>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Python线程同步机制(Locks, RLocks, Semaphores, Conditions, Events和Queues)]]></title>
      <url>https://draapho.github.io/2016/11/03/1615-python-ipc/</url>
      <content type="html"><![CDATA[<p>本文详细地阐述了Python线程同步机制。你将学习到以下有关Python线程同步机制：Lock，RLock，Semaphore，Condition，Event和Queue，还有Python的内部是如何实现这些机制的。 本文给出的程序的源代码可以在github上找到。</p>
<p>首先让我们来看一个没有使用线程同步的简单程序。</p>
<h1 id="线程（Threading）"><a href="#线程（Threading）" class="headerlink" title="线程（Threading）"></a>线程（Threading）</h1><p>我们希望编程一个从一些URL中获得内容并且将内容写入文件的程序，完成这个程序可以不使用线程，为了加快获取的速度，我们使用2个线程，每个线程处理一半的URL。</p>
<p>注：完成这个程序的最好方式是使用一个URL队列，但是以下面的例子开始我的讲解更加合适。<br>类FetchUrls是threading.Thread的子类，他拥有一个URL列表和一个写URL内容的文件对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FetchUrls</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  下载URL内容的线程</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, urls, output)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param urls 需要下载的URL列表</div><div class="line">    @param output 写URL内容的输出文件</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.urls = urls</div><div class="line">    self.output = output</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现父类Thread的run方法，打开URL，并且一个一个的下载URL的内容</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> self.urls:</div><div class="line">      url = self.urls.pop()</div><div class="line">      req = urllib2.Request(url)</div><div class="line">      <span class="keyword">try</span>:</div><div class="line">        d = urllib2.urlopen(req)</div><div class="line">      <span class="keyword">except</span> urllib2.URLError, e:</div><div class="line">        <span class="keyword">print</span> <span class="string">'URL %s failed: %s'</span> % (url, e.reason)</div><div class="line">      self.output.write(d.read())</div><div class="line">      <span class="keyword">print</span> <span class="string">'write done by %s'</span> % self.name</div><div class="line">      <span class="keyword">print</span> <span class="string">'URL %s fetched by %s'</span> % (url, self.name)</div></pre></td></tr></table></figure>
<p>main函数启动了两个线程，之后让他们下载URL内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">  <span class="comment"># URL列表1</span></div><div class="line">  urls1 = [<span class="string">'http://www.google.com'</span>, <span class="string">'http://www.facebook.com'</span>]</div><div class="line">  <span class="comment"># URL列表2</span></div><div class="line">  urls2 = [<span class="string">'http://www.yahoo.com'</span>, <span class="string">'http://www.youtube.com'</span>]</div><div class="line">  f = open(<span class="string">'output.txt'</span>, <span class="string">'w+'</span>)</div><div class="line">  t1 = FetchUrls(urls1, f)</div><div class="line">  t2 = FetchUrls(urls2, f)</div><div class="line">  t1.start()</div><div class="line">  t2.start()</div><div class="line">  t1.join()</div><div class="line">  t2.join()</div><div class="line">  f.close()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">  main()</div></pre></td></tr></table></figure>
<p>上面的程序将出现两个线程同时写一个文件的情况，导致文件一团乱码。我们需要找到一种在给定的时间里只有一个线程写文件的方法。实现的方法就是使用像锁（Locks）这样的线程同步机制。</p>
<h1 id="锁（Lock）"><a href="#锁（Lock）" class="headerlink" title="锁（Lock）"></a>锁（Lock）</h1><p>锁有两种状态：被锁（locked）和没有被锁（unlocked）。拥有acquire()和release()两种方法，并且遵循一下的规则：</p>
<ul>
<li>如果一个锁的状态是unlocked，调用acquire()方法改变它的状态为locked；</li>
<li>如果一个锁的状态是locked，acquire()方法将会阻塞，直到另一个线程调用release()方法释放了锁；</li>
<li>如果一个锁的状态是unlocked调用release()会抛出RuntimeError异常；</li>
<li>如果一个锁的状态是locked，调用release()方法改变它的状态为unlocked。</li>
</ul>
<p>解决上面两个线程同时写一个文件的问题的方法就是：我们给类FetchUrls的构造器中传入一个锁（lock），使用这个锁来保护文件操作，实现在给定的时间只有一个线程写文件。下面的代码只显示了关于lock部分的修改。完整的源码可以在threads/lock.py中找到。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FetchUrls</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  ...</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, urls, output, lock)</span>:</span></div><div class="line">    ...</div><div class="line">    self.lock = lock    <span class="comment">#传入的lock对象</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">while</span> self.urls:</div><div class="line">      ...</div><div class="line">      self.lock.acquire()   <span class="comment">#获得lock对象，lock状态变为locked，并且阻塞其他线程获取lock对象（写文件的权利）</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'lock acquired by %s'</span> % self.name</div><div class="line">      self.output.write(d.read())</div><div class="line">      <span class="keyword">print</span> <span class="string">'write done by %s'</span> % self.name</div><div class="line">      <span class="keyword">print</span> <span class="string">'lock released by %s'</span> % self.name</div><div class="line">      self.lock.release()   <span class="comment">#释放lock对象，lock状态变为unlocked，其他的线程可以重新获取lock对象</span></div><div class="line">      ...</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">  ...</div><div class="line">  lock = threading.Lock()</div><div class="line">  ...</div><div class="line">  t1 = FetchUrls(urls1, f, lock)</div><div class="line">  t2 = FetchUrls(urls2, f, lock)</div><div class="line">  ...</div></pre></td></tr></table></figure>
<p><img src="https://draapho.github.io/images/1615/lock.png" alt="lock"></p>
<p>以下是程序的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$ python locks.py</div><div class="line">lock acquired by Thread-2</div><div class="line">write done by Thread-2</div><div class="line">lock released by Thread-2</div><div class="line">URL http://www.youtube.com fetched by Thread-2</div><div class="line">lock acquired by Thread-1</div><div class="line">write done by Thread-1</div><div class="line">lock released by Thread-1</div><div class="line">URL http://www.facebook.com fetched by Thread-1</div><div class="line">lock acquired by Thread-2</div><div class="line">write done by Thread-2</div><div class="line">lock released by Thread-2</div><div class="line">URL http://www.yahoo.com fetched by Thread-2</div><div class="line">lock acquired by Thread-1</div><div class="line">write done by Thread-1</div><div class="line">lock released by Thread-1</div><div class="line">URL http://www.google.com fetched by Thread-1</div></pre></td></tr></table></figure>
<p>从上面的输出我们可以看出，写文件的操作被锁保护，没有出现两个线程同时写一个文件的现象。</p>
<p>下面我们看一下Python内部是如何实现锁（Lock）的。我正在使用的Python版本是Linux操作系统上的Python 2.6.6。</p>
<p>threading模块的Lock()方法就是thread.allocate_lock，代码可以在Lib/threading.py中找到。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Lock = _allocate_lock</div><div class="line">_allocate_lock = thread.allocate_lock</div></pre></td></tr></table></figure>
<p>C的实现在Python/thread_pthread.h中。程序假定你的系统支持POSIX信号量（semaphores）。sem_init()初始化锁（Lock）所在地址的信号量。初始的信号量值是1，意味着锁没有被锁（unlocked）。信号量将在处理器的不同线程之间共享。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function">PyThread_type_lock</span></div><div class="line"><span class="title">PyThread_allocate_lock</span><span class="params">(<span class="keyword">void</span>)</span></div><div class="line">&#123;</div><div class="line">    ...</div><div class="line">    lock = (<span class="keyword">sem_t</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">sem_t</span>));</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (lock) &#123;</div><div class="line">        status = sem_init(lock,<span class="number">0</span>,<span class="number">1</span>);</div><div class="line">        CHECK_STATUS(<span class="string">"sem_init"</span>);</div><div class="line">        ....</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当acquire()方法被调用时，下面的C代码将被执行。默认的waitflag值是1，表示调用将被被阻塞直到锁被释放。sem_wait()方法减少信号量的值或者被阻塞直到信号量大于零。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span></span></div><div class="line"><span class="title">PyThread_acquire_lock</span><span class="params">(PyThread_type_lock lock, <span class="keyword">int</span> waitflag)</span></div><div class="line">&#123;</div><div class="line">    ...</div><div class="line">    <span class="keyword">do</span> &#123;</div><div class="line">        <span class="keyword">if</span> (waitflag)</div><div class="line">            status = fix_status(sem_wait(thelock));</div><div class="line">        <span class="keyword">else</span></div><div class="line">            status = fix_status(sem_trywait(thelock));</div><div class="line">    &#125; <span class="keyword">while</span> (status == EINTR); <span class="comment">/* Retry if interrupted by a signal */</span></div><div class="line">    ....</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当release()方法被调用时，下面的C代码将被执行。sem_post()方法增加信号量。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span></span></div><div class="line"><span class="title">PyThread_release_lock</span><span class="params">(PyThread_type_lock lock)</span></div><div class="line">&#123;</div><div class="line">    ...</div><div class="line">    status = sem_post(thelock);</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以将锁（Lock）与“with”语句一起使用，锁可以作为上下文管理器（context manager）。使用“with”语句的好处是：当程序执行到“with”语句时，acquire()方法将被调用，当程序执行完“with”语句时，release()方法会被调用（译注：这样我们就不用显示地调用acquire()和release()方法，而是由“with”语句根据上下文来管理锁的获取和释放。）下面我们用“with”语句重写FetchUrls类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FetchUrls</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  ...</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="keyword">while</span> self.urls:</div><div class="line">      ...</div><div class="line">      <span class="keyword">with</span> self.lock:   <span class="comment">#使用“with”语句管理锁的获取和释放</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'lock acquired by %s'</span> % self.name</div><div class="line">        self.output.write(d.read())</div><div class="line">        <span class="keyword">print</span> <span class="string">'write done by %s'</span> % self.name</div><div class="line">        <span class="keyword">print</span> <span class="string">'lock released by %s'</span> % self.name</div><div class="line">      ...</div></pre></td></tr></table></figure>
<h1 id="可重入锁（RLock）"><a href="#可重入锁（RLock）" class="headerlink" title="可重入锁（RLock）"></a>可重入锁（RLock）</h1><p>RLock是可重入锁（reentrant lock），acquire()能够不被阻塞的被同一个线程调用多次。要注意的是release()需要调用与acquire()相同的次数才能释放锁。</p>
<p>使用Lock，下面的代码第二次调用acquire()时将被阻塞：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">lock = threading.Lock()</div><div class="line">lock.acquire()</div><div class="line">lock.acquire()</div></pre></td></tr></table></figure>
<p>如果你使用的是RLock，下面的代码第二次调用acquire()不会被阻塞:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rlock = threading.RLock()</div><div class="line">rlock.acquire()</div><div class="line">rlock.acquire()</div></pre></td></tr></table></figure>
<p>RLock使用的同样是thread.allocate_lock()，不同的是他跟踪宿主线程（the owner thread）来实现可重入的特性。下面是RLock的acquire()实现。如果调用acquire()的线程是资源的所有者，记录调用acquire()次数的计数器就会加1。如果不是，就将试图去获取锁。线程第一次获得锁时，锁的拥有者将会被保存，同时计数器初始化为1。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">acquire</span><span class="params">(self, blocking=<span class="number">1</span>)</span>:</span></div><div class="line">    me = _get_ident()</div><div class="line">    <span class="keyword">if</span> self.__owner == me:</div><div class="line">        self.__count = self.__count + <span class="number">1</span></div><div class="line">        ...</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    rc = self.__block.acquire(blocking)</div><div class="line">    <span class="keyword">if</span> rc:</div><div class="line">        self.__owner = me</div><div class="line">        self.__count = <span class="number">1</span></div><div class="line">        ...</div><div class="line">    ...</div><div class="line">    <span class="keyword">return</span> rc</div></pre></td></tr></table></figure>
<p>下面我们看一下可重入锁（RLock）的release()方法。首先它会去确认调用者是否是锁的拥有者。如果是的话，计数器减1；如果计数器为0，那么锁将会被释放，这时其他线程就可以去获取锁了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">release</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">if</span> self.__owner != _get_ident():</div><div class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">"cannot release un-acquired lock"</span>)</div><div class="line">    self.__count = count = self.__count - <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> count:</div><div class="line">        self.__owner = <span class="keyword">None</span></div><div class="line">        self.__block.release()</div><div class="line">        ...</div><div class="line">    ...</div></pre></td></tr></table></figure>
<h1 id="条件（Condition）"><a href="#条件（Condition）" class="headerlink" title="条件（Condition）"></a>条件（Condition）</h1><p>条件同步机制是指：一个线程等待特定条件，而另一个线程发出特定条件满足的信号。 解释条件同步机制的一个很好的例子就是生产者/消费者（producer/consumer）模型。生产者随机的往列表中“生产”一个随机整数，而消费者从列表中“消费”整数。完整的源码可以在threads/condition.py中找到</p>
<p>在producer类中，producer获得锁，生产一个随机整数，通知消费者有了可用的“商品”，并且释放锁。producer无限地向列表中添加整数，同时在两个添加操作中间随机的停顿一会儿。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  向列表中生产随机整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, integers, condition)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表</div><div class="line">    @param condition 条件同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.integers = integers</div><div class="line">    self.condition = condition</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run方法。在随机时间向列表中添加一个随机整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      integer = random.randint(<span class="number">0</span>, <span class="number">256</span>)</div><div class="line">      self.condition.acquire()  <span class="comment">#获取条件锁</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'condition acquired by %s'</span> % self.name</div><div class="line">      self.integers.append(integer)</div><div class="line">      <span class="keyword">print</span> <span class="string">'%d appended to list by %s'</span> % (integer, self.name)</div><div class="line">      <span class="keyword">print</span> <span class="string">'condition notified by %s'</span> % self.name</div><div class="line">      self.condition.notify()   <span class="comment">#唤醒消费者线程</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'condition released by %s'</span> % self.name</div><div class="line">      self.condition.release()  <span class="comment">#释放条件锁</span></div><div class="line">      time.sleep(<span class="number">1</span>)     <span class="comment">#暂停1秒钟</span></div></pre></td></tr></table></figure>
<p>下面是消费者（consumer）类。它获取锁，检查列表中是否有整数，如果没有，等待生产者的通知。当消费者获取整数之后，释放锁。<br>注意在wait()方法中会释放锁，这样生产者就能获得资源并且生产“商品”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  从列表中消费整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, integers, condition)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表</div><div class="line">    @param condition 条件同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.integers = integers</div><div class="line">    self.condition = condition</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run()方法，从列表中消费整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      self.condition.acquire()  <span class="comment">#获取条件锁</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'condition acquired by %s'</span> % self.name</div><div class="line">      <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">if</span> self.integers:   <span class="comment">#判断是否有整数</span></div><div class="line">          integer = self.integers.pop()</div><div class="line">          <span class="keyword">print</span> <span class="string">'%d popped from list by %s'</span> % (integer, self.name)</div><div class="line">          <span class="keyword">break</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'condition wait by %s'</span> % self.name</div><div class="line">        self.condition.wait()   <span class="comment">#等待商品，并且释放资源</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'condition released by %s'</span> % self.name</div><div class="line">      self.condition.release()  <span class="comment">#最后释放条件锁</span></div></pre></td></tr></table></figure>
<p><img src="https://draapho.github.io/images/1615/condition.png" alt="condition"></p>
<p>下面我们编写main方法，创建两个线程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">  integers = []</div><div class="line">  condition = threading.Condition()</div><div class="line">  t1 = Producer(integers, condition)</div><div class="line">  t2 = Consumer(integers, condition)</div><div class="line">  t1.start()</div><div class="line">  t2.start()</div><div class="line">  t1.join()</div><div class="line">  t2.join()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">  main()</div></pre></td></tr></table></figure>
<p>下面是程序的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ python condition.py</div><div class="line">condition acquired by Thread-1</div><div class="line">159 appended to list by Thread-1</div><div class="line">condition notified by Thread-1</div><div class="line">condition released by Thread-1</div><div class="line">condition acquired by Thread-2</div><div class="line">159 popped from list by Thread-2</div><div class="line">condition released by Thread-2</div><div class="line">condition acquired by Thread-2</div><div class="line">condition wait by Thread-2</div><div class="line">condition acquired by Thread-1</div><div class="line">116 appended to list by Thread-1</div><div class="line">condition notified by Thread-1</div><div class="line">condition released by Thread-1</div><div class="line">116 popped from list by Thread-2</div><div class="line">condition released by Thread-2</div><div class="line">condition acquired by Thread-2</div><div class="line">condition wait by Thread-2</div></pre></td></tr></table></figure>
<p>Thread-1添加159到列表中，通知消费者同时释放锁，Thread-2获得锁，取回159，并且释放锁。此时因为执行time.sleep(1)，生产者正在睡眠，当消费者再次试图获取整数时，列表中并没有整数，这时消费者进入等待状态，等待生产者的通知。当wait()被调用时，它会释放资源，从而生产者能够利用资源生产整数。</p>
<p>下面我们看一下Python内部是如何实现条件同步机制的。如果用户没有传入锁（lock）对象，condition类的构造器创建一个可重入锁（RLock），这个锁将会在调用acquire()和release()时使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Condition</span><span class="params">(_Verbose)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, lock=None, verbose=None)</span>:</span></div><div class="line">        _Verbose.__init__(self, verbose)</div><div class="line">        <span class="keyword">if</span> lock <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            lock = RLock()</div><div class="line">        self.__lock = lock</div></pre></td></tr></table></figure>
<p>接下来是wait()方法。为了简化说明，我们假定在调用wait()方法时不使用timeout参数。wait()方法创建了一个名为waiter的锁，并且设置锁的状态为locked。这个waiter锁用于线程间的通讯，这样生产者（在生产完整数之后）就可以通知消费者释放waiter()锁。锁对象将会被添加到等待者列表，并且在调用waiter.acquire()时被阻塞。一开始condition锁的状态被保存，并且在wait()结束时被恢复。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">wait</span><span class="params">(self, timeout=None)</span>:</span></div><div class="line">    ...</div><div class="line">    waiter = _allocate_lock()</div><div class="line">    waiter.acquire()</div><div class="line">    self.__waiters.append(waiter)</div><div class="line">    saved_state = self._release_save()</div><div class="line">    <span class="keyword">try</span>:    <span class="comment"># 无论如何恢复状态 (例如, KeyboardInterrupt)</span></div><div class="line">        <span class="keyword">if</span> timeout <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            waiter.acquire()</div><div class="line">            ...</div><div class="line">        ...</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self._acquire_restore(saved_state)</div></pre></td></tr></table></figure>
<p>当生产者调用notify()方法时，notify()释放waiter锁，唤醒被阻塞的消费者。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">notify</span><span class="params">(self, n=<span class="number">1</span>)</span>:</span></div><div class="line">    ...</div><div class="line">    __waiters = self.__waiters</div><div class="line">    waiters = __waiters[:n]</div><div class="line">    ...</div><div class="line">    <span class="keyword">for</span> waiter <span class="keyword">in</span> waiters:</div><div class="line">        waiter.release()</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            __waiters.remove(waiter)</div><div class="line">        <span class="keyword">except</span> ValueError:</div><div class="line">            <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p>同样Condition对象也可以和“with”语句一起使用，这样“with”语句上下文会帮我们调用acquire()和release()方法。下面的代码使用“with”语句改写了生产者和消费者类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  ...</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      integer = random.randint(<span class="number">0</span>, <span class="number">256</span>)</div><div class="line">      <span class="keyword">with</span> self.condition:</div><div class="line">        <span class="keyword">print</span> <span class="string">'condition acquired by %s'</span> % self.name</div><div class="line">        self.integers.append(integer)</div><div class="line">        <span class="keyword">print</span> <span class="string">'%d appended to list by %s'</span> % (integer, self.name)</div><div class="line">        <span class="keyword">print</span> <span class="string">'condition notified by %s'</span> % self.name</div><div class="line">        self.condition.notify()</div><div class="line">        <span class="keyword">print</span> <span class="string">'condition released by %s'</span> % self.name</div><div class="line">      time.sleep(<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  ...</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      <span class="keyword">with</span> self.condition:</div><div class="line">        <span class="keyword">print</span> <span class="string">'condition acquired by %s'</span> % self.name</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">          <span class="keyword">if</span> self.integers:</div><div class="line">            integer = self.integers.pop()</div><div class="line">            <span class="keyword">print</span> <span class="string">'%d popped from list by %s'</span> % (integer, self.name)</div><div class="line">            <span class="keyword">break</span></div><div class="line">          <span class="keyword">print</span> <span class="string">'condition wait by %s'</span> % self.name</div><div class="line">          self.condition.wait()</div><div class="line">        <span class="keyword">print</span> <span class="string">'condition released by %s'</span> % self.name</div></pre></td></tr></table></figure>
<h1 id="信号量（Semaphore）"><a href="#信号量（Semaphore）" class="headerlink" title="信号量（Semaphore）"></a>信号量（Semaphore）</h1><p>信号量同步基于内部计数器，每调用一次acquire()，计数器减1；每调用一次release()，计数器加1.当计数器为0时，acquire()调用被阻塞。这是迪科斯彻（Dijkstra）信号量概念P()和V()的Python实现。信号量同步机制适用于访问像服务器这样的有限资源。</p>
<p>信号量同步的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">semaphore = threading.Semaphore()</div><div class="line">semaphore.acquire()</div><div class="line"> <span class="comment"># 使用共享资源</span></div><div class="line">...</div><div class="line">semaphore.release()</div></pre></td></tr></table></figure>
<p>让我们看一下信号量同步在Python内部是如何实现的。构造器使用参数value来表示计数器的初始值，默认值为1。一个条件锁实例用于保护计数器，同时当信号量被释放时通知其他线程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Semaphore</span><span class="params">(_Verbose)</span>:</span></div><div class="line">    ...</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value=<span class="number">1</span>, verbose=None)</span>:</span></div><div class="line">        _Verbose.__init__(self, verbose)</div><div class="line">        self.__cond = Condition(Lock())</div><div class="line">        self.__value = value</div><div class="line">        ...</div></pre></td></tr></table></figure>
<p>acquire()方法。如果信号量为0，线程被条件锁的wait()方法阻塞，直到被其他线程唤醒；如果计数器大于0，调用acquire()使计数器减1。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">acquire</span><span class="params">(self, blocking=<span class="number">1</span>)</span>:</span></div><div class="line">    rc = <span class="keyword">False</span></div><div class="line">    self.__cond.acquire()</div><div class="line">    <span class="keyword">while</span> self.__value == <span class="number">0</span>:</div><div class="line">        ...</div><div class="line">        self.__cond.wait()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        self.__value = self.__value - <span class="number">1</span></div><div class="line">        rc = <span class="keyword">True</span></div><div class="line">    self.__cond.release()</div><div class="line">    <span class="keyword">return</span> rc</div></pre></td></tr></table></figure>
<p>信号量类的release()方法增加计数器的值并且唤醒其他线程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">release</span><span class="params">(self)</span>:</span></div><div class="line">    self.__cond.acquire()</div><div class="line">    self.__value = self.__value + <span class="number">1</span></div><div class="line">    self.__cond.notify()</div><div class="line">    self.__cond.release()</div></pre></td></tr></table></figure>
<p>还有一个“有限”(bounded)信号量类，可以确保release()方法的调用次数不能超过给定的初始信号量数值(value参数)，下面是“有限”信号量类的Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">_BoundedSemaphore</span><span class="params">(_Semaphore)</span>:</span></div><div class="line">    <span class="string">"""检查release()的调用次数是否小于等于acquire()次数"""</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value=<span class="number">1</span>, verbose=None)</span>:</span></div><div class="line">        _Semaphore.__init__(self, value, verbose)</div><div class="line">        self._initial_value = value</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">release</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">if</span> self._Semaphore__value &gt;= self._initial_value:</div><div class="line">            <span class="keyword">raise</span> ValueError, <span class="string">"Semaphore released too many times"</span></div><div class="line">        <span class="keyword">return</span> _Semaphore.release(self)</div></pre></td></tr></table></figure>
<p>样信号量(Semaphore)对象可以和“with”一起使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">semaphore = threading.Semaphore()</div><div class="line"><span class="keyword">with</span> semaphore:</div><div class="line">  <span class="comment"># 使用共享资源</span></div><div class="line">  ...</div></pre></td></tr></table></figure>
<h1 id="事件（Event）"><a href="#事件（Event）" class="headerlink" title="事件（Event）"></a>事件（Event）</h1><p>基于事件的同步是指：一个线程发送/传递事件，另外的线程等待事件的触发。 让我们再来看看前面的生产者和消费者的例子，现在我们把它转换成使用事件同步而不是条件同步。完整的源码可以在threads/event.py里面找到。</p>
<p>首先是生产者类，我们传入一个Event实例给构造器而不是Condition实例。一旦整数被添加进列表，事件(event)被设置和发送去唤醒消费者。注意事件(event)实例默认是被发送的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  向列表中生产随机整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, integers, event)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表</div><div class="line">    @param event 事件同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.integers = integers</div><div class="line">    self.event = event</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run方法。在随机时间向列表中添加一个随机整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      integer = random.randint(<span class="number">0</span>, <span class="number">256</span>)</div><div class="line">      self.integers.append(integer)</div><div class="line">      <span class="keyword">print</span> <span class="string">'%d appended to list by %s'</span> % (integer, self.name)</div><div class="line">      <span class="keyword">print</span> <span class="string">'event set by %s'</span> % self.name</div><div class="line">      self.event.set()      <span class="comment">#设置事件</span></div><div class="line">      self.event.clear()    <span class="comment">#发送事件</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'event cleared by %s'</span> % self.name</div><div class="line">      time.sleep(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>同样我们传入一个Event实例给消费者的构造器，消费者阻塞在wait()方法，等待事件被触发，即有可供消费的整数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">   从列表中消费整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, integers, event)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表</div><div class="line">    @param event 事件同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.integers = integers</div><div class="line">    self.event = event</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run()方法，从列表中消费整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      self.event.wait() <span class="comment">#等待事件被触发</span></div><div class="line">      <span class="keyword">try</span>:</div><div class="line">        integer = self.integers.pop()</div><div class="line">        <span class="keyword">print</span> <span class="string">'%d popped from list by %s'</span> % (integer, self.name)</div><div class="line">      <span class="keyword">except</span> IndexError:</div><div class="line">        <span class="comment"># catch pop on empty list</span></div><div class="line">        time.sleep(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p><img src="https://draapho.github.io/images/1615/event.png" alt="event"></p>
<p>下面是程序的输出，Thread-1添加124到整数列表中，然后设置事件并且唤醒消费者。消费者从wait()方法中唤醒，在列表中获取到整数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ python event.py</div><div class="line">124 appended to list by Thread-1</div><div class="line">event set by Thread-1</div><div class="line">event cleared by Thread-1</div><div class="line">124 popped from list by Thread-2</div><div class="line">223 appended to list by Thread-1</div><div class="line">event set by Thread-1</div><div class="line">event cleared by Thread-1</div><div class="line">223 popped from list by Thread-2</div></pre></td></tr></table></figure>
<p>事件锁的Python内部实现，首先是Event锁的构造器。构造器中创建了一个条件（Condition）锁，来保护事件标志（event flag）,同事唤醒其他线程当事件被设置时。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Event</span><span class="params">(_Verbose)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, verbose=None)</span>:</span></div><div class="line">        _Verbose.__init__(self, verbose)</div><div class="line">        self.__cond = Condition(Lock())</div><div class="line">        self.__flag = <span class="keyword">False</span></div></pre></td></tr></table></figure>
<p>接下来是set()方法，它设置事件标志为True，并且唤醒其他线程。条件锁对象保护程序修改事件标志状态的关键部分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">set</span><span class="params">(self)</span>:</span></div><div class="line">    self.__cond.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        self.__flag = <span class="keyword">True</span></div><div class="line">        self.__cond.notify_all()</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.__cond.release()</div></pre></td></tr></table></figure>
<p>而clear()方法正好相反，它设置时间标志为False。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear</span><span class="params">(self)</span>:</span></div><div class="line">    self.__cond.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        self.__flag = <span class="keyword">False</span></div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.__cond.release()</div></pre></td></tr></table></figure>
<p>最后，wait()方法将阻塞直到调用了set()方法，当事件标志为True时，wait()方法就什么也不做。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">wait</span><span class="params">(self, timeout=None)</span>:</span></div><div class="line">    self.__cond.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.__flag: <span class="comment">#如果flag不为真</span></div><div class="line">            self.__cond.wait(timeout)</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.__cond.release()</div></pre></td></tr></table></figure>
<h1 id="队列（Queue）"><a href="#队列（Queue）" class="headerlink" title="队列（Queue）"></a>队列（Queue）</h1><p>队列是一个非常好的线程同步机制，使用队列我们不用关心锁，队列会为我们处理锁的问题。 队列(Queue)有以下4个用户感兴趣的方法：</p>
<ul>
<li>put: 向队列中添加一个项；</li>
<li>get: 从队列中删除并返回一个项；</li>
<li>task_done: 当某一项任务完成时调用；</li>
<li>join: 阻塞直到所有的项目都被处理完。</li>
</ul>
<p>下面我们将上面的生产者/消费者的例子转换成使用队列。源代码可以在threads/queue.py中找到。</p>
<p>首先是生产者类，我们不需要传入一个整数列表，因为我们使用队列就可以存储生成的整数。生产者线程在一个无限循环中生成整数并将生成的整数添加到队列中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  向队列中生产随机整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, queue)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表    #译注：不需要这个参数</div><div class="line">    @param queue 队列同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.queue = queue</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run方法。在随机时间向队列中添加一个随机整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      integer = random.randint(<span class="number">0</span>, <span class="number">256</span>)</div><div class="line">      self.queue.put(integer)   <span class="comment">#将生成的整数添加到队列</span></div><div class="line">      <span class="keyword">print</span> <span class="string">'%d put to queue by %s'</span> % (integer, self.name)</div><div class="line">      time.sleep(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>下面是消费者类。线程从队列中获取整数，并且在任务完成时调用task_done()方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">  <span class="string">"""</span></div><div class="line">  从队列中消费整数</div><div class="line">  """</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, queue)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    构造器</div><div class="line"></div><div class="line">    @param integers 整数列表    #译注：不需要这个参数</div><div class="line">    @param queue 队列同步对象</div><div class="line">    """</div><div class="line">    threading.Thread.__init__(self)</div><div class="line">    self.queue = queue</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    实现Thread的run()方法，从队列中消费整数</div><div class="line">    """</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">      integer = self.queue.get()</div><div class="line">      <span class="keyword">print</span> <span class="string">'%d popped from list by %s'</span> % (integer, self.name)</div><div class="line">      self.queue.task_done()</div></pre></td></tr></table></figure>
<p>以下是程序的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ python queue.py</div><div class="line">61 put to queue by Thread-1</div><div class="line">61 popped from list by Thread-2</div><div class="line">6 put to queue by Thread-1</div><div class="line">6 popped from list by Thread-2</div></pre></td></tr></table></figure>
<p>队列同步的最大好处就是队列帮我们处理了锁。现在让我们去看看在Python内部是如何实现队列同步机制的。</p>
<p>队列（Queue）构造器创建一个锁，保护队列元素的添加和删除操作。同时创建了一些条件锁对象处理队列事件，比如队列不空事件（削除get()的阻塞），队列不满事件（削除put()的阻塞）和所有项目都被处理完事件（削除join()的阻塞）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, maxsize=<span class="number">0</span>)</span>:</span></div><div class="line">        ...</div><div class="line">        self.mutex = threading.Lock()</div><div class="line">        self.not_empty = threading.Condition(self.mutex)</div><div class="line">        self.not_full = threading.Condition(self.mutex)</div><div class="line">        self.all_tasks_done = threading.Condition(self.mutex)</div><div class="line">        self.unfinished_tasks = <span class="number">0</span></div></pre></td></tr></table></figure>
<p>put()方法向队列中添加一个项，或者阻塞如果队列已满。这时队列非空，它唤醒阻塞在get()方法中的线程。更多关于Condition锁的内容请查看上面的讲解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, item, block=True, timeout=None)</span>:</span></div><div class="line">    ...</div><div class="line">    self.not_full.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">if</span> self.maxsize &gt; <span class="number">0</span>:</div><div class="line">            ...</div><div class="line">            <span class="keyword">elif</span> timeout <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">                <span class="keyword">while</span> self._qsize() == self.maxsize:</div><div class="line">                    self.not_full.wait()</div><div class="line">        self._put(item)</div><div class="line">        self.unfinished_tasks += <span class="number">1</span></div><div class="line">        self.not_empty.notify()</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.not_full.release()</div></pre></td></tr></table></figure>
<p>get()方法从队列中获得并删除一个项，或者阻塞当队列为空时。这时队列不满，他唤醒阻塞在put()方法中的线程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, block=True, timeout=None)</span>:</span></div><div class="line">    ...</div><div class="line">    self.not_empty.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        ...</div><div class="line">        <span class="keyword">elif</span> timeout <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">while</span> <span class="keyword">not</span> self._qsize():</div><div class="line">                self.not_empty.wait()</div><div class="line">        item = self._get()</div><div class="line">        self.not_full.notify()</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.not_empty.release()</div></pre></td></tr></table></figure>
<p>当调用task_done()方法时，未完成任务的数量减1。如果未完成任务的数量为0，线程等待队列完成join()方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">task_done</span><span class="params">(self)</span>:</span></div><div class="line">    self.all_tasks_done.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        unfinished = self.unfinished_tasks - <span class="number">1</span></div><div class="line">        <span class="keyword">if</span> unfinished &lt;= <span class="number">0</span>:</div><div class="line">            <span class="keyword">if</span> unfinished &lt; <span class="number">0</span>:</div><div class="line">                <span class="keyword">raise</span> ValueError(<span class="string">'task_done() called too many times'</span>)</div><div class="line">            self.all_tasks_done.notify_all()</div><div class="line">        self.unfinished_tasks = unfinished</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.all_tasks_done.release()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">join</span><span class="params">(self)</span>:</span></div><div class="line">    self.all_tasks_done.acquire()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">while</span> self.unfinished_tasks:</div><div class="line">            self.all_tasks_done.wait()</div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        self.all_tasks_done.release()</div></pre></td></tr></table></figure>
<p><img src="https://draapho.github.io/images/1615/queue.png" alt="queue"></p>
<p>本文到此结束，希望您喜欢这篇文章。欢迎您的留言和反馈。</p>
<hr>
<blockquote>
<p>转载自 <a href="http://yoyzhou.github.io/blog/2013/02/28/python-threads-synchronization-locks/" target="_blank" rel="external">Zhou’s Blog</a><br>翻译自Laurent Luce的博客<br>原文名称：<a href="http://www.laurentluce.com/posts/python-threads-synchronization-locks-rlocks-semaphores-conditions-events-and-queues/" target="_blank" rel="external">Python threads synchronization: Locks, RLocks, Semaphores, Conditions, Events and Queues</a></p>
</blockquote>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Git 常用命令]]></title>
      <url>https://draapho.github.io/2016/10/24/1614-CheatSheet-git/</url>
      <content type="html"><![CDATA[<h1 id="git示意图"><a href="#git示意图" class="headerlink" title="git示意图"></a>git示意图</h1><p>  <img src="https://draapho.github.io/images/1614/git.jpg" alt="git"></p>
<h1 id="资料和参考"><a href="#资料和参考" class="headerlink" title="资料和参考"></a>资料和参考</h1><ul>
<li><a href="http://ndpsoftware.com/git-cheatsheet.html" target="_blank" rel="external">Visual Git Cheat Sheet</a></li>
<li><a href="https://git-scm.com/book/zh/v2" target="_blank" rel="external">Pro Git book</a></li>
<li>廖雪峰的 <a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="external">Git教程</a></li>
<li>设置SSH, 参考 <a href="https://help.github.com/categories/ssh/" target="_blank" rel="external">GitHub Help - SSH</a></li>
<li>设置GPG, 参考 <a href="https://help.github.com/categories/gpg/" target="_blank" rel="external">GitHub Help - GPG</a></li>
</ul>
<h1 id="一些理解"><a href="#一些理解" class="headerlink" title="一些理解"></a>一些理解</h1><ul>
<li>git的核心理解为指针即可, 包括 <code>workspace</code>, <code>index</code>, <code>commitHash</code><ul>
<li><code>repository</code>是基于<code>commitHash</code>管理版本的.</li>
<li><code>HEAD</code>, <code>HEAD^1</code>, <code>HEAD~3</code>, <code>branch</code>, <code>tags</code>都是<code>commitHash</code>的别名, 便于人们记忆和理解.</li>
<li>可以基于 <code>git reset</code> 来检测是否完全理解git基于指针的设计思路.  </li>
<li><code>HEAD^1</code>基于父节点, <code>HEAD~1</code>基于层次. 单层结构下没有差别. 复杂多层结构建议直接用 <code>commitHash</code></li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">       A ---------------------  A =      = A^0                       </div><div class="line">      / \                       </div><div class="line">     B   C                      B = A^   = A^1     = A~1</div><div class="line">    /|\  |                      C = A^2  = A^2     </div><div class="line">   / | \ |                                     </div><div class="line">  D  E   F -------------------  D = A^^  = A^1^1   = A~2  </div><div class="line"> / \    / \                     E = B^2  = A^^2</div><div class="line">/   \  /   \                    F = B^3  = A^^3   </div><div class="line">G   H  I   J -----------------  G = A^^^ = A^1^1^1 = A~3                               </div><div class="line">                                H = D^2  = B^^2    = A^^^2  = A~2^2</div><div class="line">                                I = F^   = B^3^    = A^^3^</div><div class="line">                                J = F^2  = B^3^2   = A^^3^2</div></pre></td></tr></table></figure>
<ul>
<li>git的命令, 常见格式为 <code>git diff p1 p2 -- file</code>. 意为, 比较<code>p1</code>与<code>p2</code>两处指定file的区别<ul>
<li><code>p1</code> 缺省指向workspace, <code>p2</code> 缺省指向index. </li>
<li><code>--</code> 接文件或目录, 名字无歧义时可以省去<code>--</code>. (如 git checkout name 就可能有歧义, branch OR file?)</li>
<li><code>.</code> 表示所有的文件, 如 <code>git add .</code></li>
</ul>
</li>
<li>学会查看帮助, 加上 <code>-h</code> 即可. 如 <code>git checkout -h</code><ul>
<li><code>[]</code> 表示可选项, <code>&lt;&gt;</code> 表示必填项</li>
</ul>
</li>
</ul>
<h1 id="初始安装"><a href="#初始安装" class="headerlink" title="初始安装"></a>初始安装</h1><ul>
<li><p>新建git仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># Create local repository</div><div class="line"># put &quot;.gitignore&quot; to project root direct.</div><div class="line">git init                        # create local repository</div><div class="line">git add README.md               # add somefiles</div><div class="line">git commit -m &quot;first commit&quot;    # commit to local repository</div><div class="line"></div><div class="line"># link with remote repository</div><div class="line">git remote add origin url       # add remote repository, &lt;url&gt; like https://... OR ssh://...</div><div class="line">git push -u origin master       # -u, 指定默认远程主机为 origin</div><div class="line"></div><div class="line"># Clone existing repository</div><div class="line">git clone url                   # &lt;url&gt; like https://... OR ssh://...</div><div class="line"></div><div class="line"># more cmd about config</div><div class="line">git config --list               # show config</div><div class="line">git config -e                   # edit local config file</div></pre></td></tr></table></figure>
</li>
<li><p>单独设置参数, –global表示全局参数, 不写就是仓库自有参数</p>
</li>
<li>需要安装 <a href="https://www.perforce.com/product/components/perforce-visual-merge-and-diff-tools" target="_blank" rel="external">p4merge</a> 用于支持 <code>difftool</code> 及 <code>mergetool</code></li>
<li><p>安装位置以 <code>D:\Program\Perforce\p4merge.exe</code> 为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"># global setting</div><div class="line">git config --global user.name &quot;Your Name&quot;</div><div class="line">git config --global user.email &quot;email@example.com&quot;</div><div class="line"></div><div class="line"># alise setting</div><div class="line">git config --global alias.a &apos;add&apos;</div><div class="line">git config --global alias.aa &apos;add .&apos;</div><div class="line">git config --global alias.b &apos;branch&apos;</div><div class="line">git config --global alias.bb &apos;branch -a -v&apos;</div><div class="line">git config --global alias.co &apos;checkout&apos;</div><div class="line">git config --global alias.cm &apos;commit -m&apos;</div><div class="line">git config --global alias.lg &quot;log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit&quot;</div><div class="line">git config --global alias.ll &quot;log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit -10&quot;</div><div class="line">git config --global alias.st &apos;status&apos;</div><div class="line"></div><div class="line"># set diff color</div><div class="line">git config --global color.diff.old &quot;red normal bold&quot;</div><div class="line">git config --global color.diff.new &quot;green normal bold&quot;</div><div class="line"></div><div class="line"># solve the warning, LF will be replaced by CRLF</div><div class="line">git config --global core.autocrlf false</div><div class="line">git config --global core.safecrlf false</div><div class="line"></div><div class="line"># set difftool mergetool (need p4merge)</div><div class="line">git config --global diff.tool p4merge</div><div class="line">git config --global difftool.p4merge.cmd &apos;&quot;D:\Program\Perforce\p4merge.exe&quot; &quot;$LOCAL&quot; &quot;$REMOTE&quot;&apos;</div><div class="line">git config --global difftool.prompt false</div><div class="line">git config --global merge.tool p4merge</div><div class="line">git config --global mergetool.p4merge.cmd &apos;&quot;D:\Program\Perforce\p4merge.exe&quot; &quot;$PWD/$BASE&quot; &quot;$PWD/$REMOTE&quot; &quot;$PWD/$LOCAL&quot; &quot;$PWD/$MERGED&quot;&apos;</div><div class="line">git config --global mergetool.p4merge.trustExitCode false</div><div class="line">git config --global mergetool.keepBackup false</div></pre></td></tr></table></figure>
</li>
<li><p>也可使用 <code>git config -e --global</code> 打开全局配置文件, 直接设置全局参数</p>
</li>
<li>需要安装 <a href="https://www.perforce.com/product/components/perforce-visual-merge-and-diff-tools" target="_blank" rel="external">p4merge</a> 用于支持 <code>difftool</code> 及 <code>mergetool</code></li>
<li>安装位置以 <code>D:\Program\Perforce\p4merge.exe</code> 为例<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">[user]</div><div class="line">    name = https://draapho.github.io/</div><div class="line">    email = draapho@gmail.com</div><div class="line">[alias]</div><div class="line">    a = add</div><div class="line">    aa = add .</div><div class="line">    b = branch</div><div class="line">    bb = branch -a -v</div><div class="line">    co = checkout</div><div class="line">    cm = commit -m</div><div class="line">    lg = log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit</div><div class="line">    ll = log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit -10</div><div class="line">    st = status</div><div class="line">[color &quot;diff&quot;]</div><div class="line">	old = red normal bold</div><div class="line">	new = green normal bold</div><div class="line">[core]</div><div class="line">    autocrlf = false</div><div class="line">    safecrlf = false</div><div class="line">[diff]</div><div class="line">	tool = p4merge</div><div class="line">[difftool &quot;p4merge&quot;]</div><div class="line">	cmd = \&quot;D:\\Program\\Perforce\\p4merge.exe\&quot; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot;</div><div class="line">[difftool]</div><div class="line">	prompt = false</div><div class="line">[merge]</div><div class="line">	tool = p4merge</div><div class="line">[mergetool &quot;p4merge&quot;]</div><div class="line">	cmd = \&quot;D:\\Program\\Perforce\\p4merge.exe\&quot; \&quot;$PWD/$BASE\&quot; \&quot;$PWD/$REMOTE\&quot; \&quot;$PWD/$LOCAL\&quot; \&quot;$PWD/$MERGED\&quot;</div><div class="line">	trustExitCode = false</div><div class="line">[mergetool]</div><div class="line">	keepBackup = false</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"># 查看信息</div><div class="line">git st                          # git status            # 显示工作区变更的文件</div><div class="line">git lg                          # git log 增强版        # 显示所有提交</div><div class="line">git ll                          # git lg -10            # 显示过去10次提交</div><div class="line">git shortlog -sn                                        # 显示所有提交过的用户</div><div class="line">git show --name-only commit                             # 显示某次提交发生变化的文件</div><div class="line"></div><div class="line"># stash                                                 # 少量且短时间的使用!</div><div class="line">git stash                                               # workspace-&gt;stash(藏匿处)</div><div class="line">git stash pop                                           # stash(不保存)-&gt;workspace</div><div class="line"></div><div class="line"># 提交文件</div><div class="line">git aa                          # git add .             # workspace-&gt;index</div><div class="line">git a *.c *.h                   # &lt;file | dir&gt;          # 添加指定文件</div><div class="line">git reset HEAD [file]           # discard file @index   # add的逆操作 HEAD-&gt;index</div><div class="line">git cm &quot;msg&quot;                    # git commit -m &quot;msg&quot;   # index-&gt;repository</div><div class="line">git commit --amend -m &quot;message&quot;                         # 修改/替换之前的提交</div><div class="line"> </div><div class="line"># 分支操作</div><div class="line">git b name                      # git branch name       # 创建分支</div><div class="line">git b name commit                                       # 基于指定 commit 创建分支</div><div class="line">git b -d name                   # branch delete         # 删除分支</div><div class="line">git b -dr origin/name           # delete remote         # 删除远程分支</div><div class="line">git b -m new_name               # git branch --move     # 重命名分支</div><div class="line">git bb                          # git branch -a         # 查看所有分支</div><div class="line">git remote -v                                           # 查看远程分支</div><div class="line">git co name                     # git checkout name     # 切换分支</div><div class="line">git co -b name                  # checkout &amp; branch     # 创建并切换分支</div><div class="line"></div><div class="line"># 版本合并和回退</div><div class="line">git merge branch                # 合并branch到当前分支</div><div class="line">git mergetool                   # 已图形化工具处理文件冲突 (如 p4merge.exe)</div><div class="line">git cherry-pick commit          # 合并commit到当前分支</div><div class="line">git rebase -i HEAD~3            # 修改/压缩多个提交, 根据提示操作, 第一行不能是squash!  </div><div class="line">git revert commit               # 提交逆操作来实现版本恢复, 不影响任何历史记录!        </div><div class="line">git push                                                # 推送到默认的远程主机</div><div class="line">git push -f                     # --force               # 忽略冲突, 强制推送</div><div class="line">git pull                        # fetch &amp; merge         # 合并远程分支到当前分支</div><div class="line"></div><div class="line"># tag                           # 用于标记一个版本, 可以替代 commitHash</div><div class="line">git tag                         # 查看版本</div><div class="line">git tag v100                    # 创建版本</div><div class="line">git tag -d v100                 # 删除版本</div><div class="line">git push --tags                 # 推送tag</div><div class="line"></div><div class="line"># 查看差异 </div><div class="line">git diff                        # workspace VS index (p1缺省指向workspace, p2缺省指向index)</div><div class="line">git diff p1 p2                  # p1 VS p2, 可以是 HEAD~1, commitHash值, TAG, 分支名称</div><div class="line">git diff p1 p2 -- *.c *.h       # -- 指定文件或目录, 可省</div><div class="line">git diff --name-status p1 p2    # 获得变更的文件列表</div><div class="line">git diff --stat p1 p2           # 统计变更的数据</div><div class="line">git difftool p1 p2 -- file      # 使用图形化工具显示差异 (如 p4merge.exe)</div><div class="line"></div><div class="line"># 撤销</div><div class="line">git checkout p1 -- file         # p1-&gt;index-&gt;workspace  # p1缺省为index, --和file可省</div><div class="line">git reset p1 -- file            # p1-&gt;HEAD-&gt;index,      # p1缺省为HEAD, --和file可省</div><div class="line">git reset --soft p1             # p1-&gt;HEAD                      # p1缺省为HEAD, 不可带file参</div><div class="line">git reset --hard p1             # p1-&gt;HEAD-&gt;index &amp; workspace   # p1缺省为HEAD, 不可带file参</div><div class="line"></div><div class="line">git checkout .                  # index-&gt;workspace      # 清除工作区的变更(!!!危险操作)</div><div class="line">git checkout branch             # branch-&gt;index-&gt;workspace      # 切换分支</div><div class="line">git reset --hard                # HEAD-&gt;index &amp; workspace       # 恢复仓库到HEAD状态</div><div class="line">git reset HEAD^ file            # HEAD^-&gt;HEAD-&gt;index            # 指定file, 进行版本回滚</div><div class="line">git reset --soft HEAD~3         # HEAD~3-&gt;HEAD                  # 版本回滚</div></pre></td></tr></table></figure>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[python调用命令行]]></title>
      <url>https://draapho.github.io/2016/10/21/1613-python-cli/</url>
      <content type="html"><![CDATA[<h1 id="python调用CLI"><a href="#python调用CLI" class="headerlink" title="python调用CLI"></a>python调用CLI</h1><ul>
<li>CLI = Command Line Interface, 即命令行</li>
<li>方法有很多, 通用性和安全性最好的就是<code>subprocess.Popen</code>这个方法. 见文档<ul>
<li><a href="https://docs.python.org/2.7/library/subprocess.html#popen-constructor" target="_blank" rel="external">Subprocess management</a></li>
<li><del><a href="https://docs.python.org/2.7/library/os.html#os.popen" target="_blank" rel="external">os.popen</a></del></li>
<li><del><a href="https://docs.python.org/2/library/commands.html" target="_blank" rel="external">Utilities for running commands</a></del></li>
</ul>
</li>
<li>example:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen, PIPE</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># CLI: Command Line Interface</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">runCLI</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># __cmd_link = self.cur_dir + "\\stlink_cli\\ST-LINK_CLI.exe -c SWD SWJCLK=5 UR"</span></div><div class="line">    __cmd_link = <span class="string">"dir"</span></div><div class="line"></div><div class="line">    <span class="comment"># 多用 shell=True. shell=False只能运行bat文件或直接在终端中执行. 此例中显示的内容也会有区别</span></div><div class="line">    _pp = Popen(__cmd_link, shell=<span class="keyword">True</span>, stdout=PIPE, stderr=PIPE)</div><div class="line">    out, err = _pp.communicate()</div><div class="line"></div><div class="line">    logging.debug(<span class="string">"cmd &gt; "</span> + __cmd_link)</div><div class="line">    logging.debug(<span class="string">"out &gt; "</span> + out.rstrip())</div><div class="line">    logging.debug(<span class="string">"err &gt; "</span> + err.rstrip())</div><div class="line">    <span class="keyword">return</span> _pp.returncode</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    logging.basicConfig(level=logging.DEBUG)</div><div class="line">    logging.debug(runCLI())</div></pre></td></tr></table></figure>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[PyQt 的交互操作]]></title>
      <url>https://draapho.github.io/2016/10/20/1612-python-pyqtui/</url>
      <content type="html"><![CDATA[<h1 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h1><ul>
<li>Windows</li>
<li><a href="https://www.python.org/downloads/" target="_blank" rel="external">python 2.7</a></li>
<li><a href="https://riverbankcomputing.com/software/pyqt/download" target="_blank" rel="external">PyQt 4.11.4</a></li>
</ul>
<h1 id="useful-guide-startup"><a href="#useful-guide-startup" class="headerlink" title="useful guide / startup"></a>useful guide / startup</h1><ul>
<li><a href="http://www.training.prace-ri.eu/uploads/tx_pracetmo/QtGuiIntro.pdf" target="_blank" rel="external">Introduction to GUI development using Qt</a>, 简单明了的介绍了qt gui的基本特性</li>
<li><a href="https://www.tutorialspoint.com/pyqt/" target="_blank" rel="external">PyQt Tutorial</a>, learn PyQt step by step.</li>
<li><a href="https://nikolak.com/pyqt-threading-tutorial/" target="_blank" rel="external">PyQt: Threading Basics Tutorial</a>, 防止UI阻塞, 使用线程</li>
</ul>
<h1 id="Generate-basic-UI-file"><a href="#Generate-basic-UI-file" class="headerlink" title="Generate basic UI file"></a>Generate basic UI file</h1><ul>
<li>use <code>Qt Designer</code> to create basic UI<ul>
<li><code>New</code>-&gt;<code>Widget</code>-&gt;drag <code>PushButton</code> to <code>Form</code> Window</li>
<li>Save it, for example <code>demo.ui</code></li>
</ul>
</li>
<li>make sure <code>pyuic4.bat</code> is in the System PATH<ul>
<li>input <code>pyuic4.bat -h</code> in shell, check the response.</li>
</ul>
</li>
<li>change <code>.ui</code> to <code>.py</code> file<ul>
<li>run <code>pyuic4.bat -x -o demo.py demo.ui</code> in the working folder.</li>
<li><code>-o</code> means output, set the output filename.</li>
<li><code>-x</code> will generate <code>if __name__ == &#39;__main__&#39;:</code> then can run directly</li>
<li><code>pyuic4.bat demo.ui &gt; demo.py</code> is also OK.</li>
</ul>
</li>
<li><del>the sample of <code>demo.py</code>, generated automatically by pyuic4.bat</del></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="comment"># Form implementation generated from reading ui file 'demo.ui'</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Created by: PyQt4 UI code generator 4.11.4</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># WARNING! All changes made in this file will be lost!</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> PyQt4 <span class="keyword">import</span> QtCore, QtGui</div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    _fromUtf8 = QtCore.QString.fromUtf8</div><div class="line"><span class="keyword">except</span> AttributeError:</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_fromUtf8</span><span class="params">(s)</span>:</span></div><div class="line">        <span class="keyword">return</span> s</div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">    _encoding = QtGui.QApplication.UnicodeUTF8</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_translate</span><span class="params">(context, text, disambig)</span>:</span></div><div class="line">        <span class="keyword">return</span> QtGui.QApplication.translate(context, text, disambig, _encoding)</div><div class="line"><span class="keyword">except</span> AttributeError:</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_translate</span><span class="params">(context, text, disambig)</span>:</span></div><div class="line">        <span class="keyword">return</span> QtGui.QApplication.translate(context, text, disambig)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ui_Form</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setupUi</span><span class="params">(self, Form)</span>:</span></div><div class="line">        Form.setObjectName(_fromUtf8(<span class="string">"Form"</span>))</div><div class="line">        self.pushButton = QtGui.QPushButton(Form)</div><div class="line">        self.pushButton.setGeometry(QtCore.QRect(<span class="number">40</span>, <span class="number">40</span>, <span class="number">75</span>, <span class="number">23</span>))</div><div class="line">        self.pushButton.setObjectName(_fromUtf8(<span class="string">"pushButton"</span>))</div><div class="line"></div><div class="line">        self.retranslateUi(Form)</div><div class="line">        QtCore.QMetaObject.connectSlotsByName(Form)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retranslateUi</span><span class="params">(self, Form)</span>:</span></div><div class="line">        Form.setWindowTitle(_translate(<span class="string">"Form"</span>, <span class="string">"Form"</span>, <span class="keyword">None</span>))</div><div class="line">        self.pushButton.setText(_translate(<span class="string">"Form"</span>, <span class="string">"PushButton"</span>, <span class="keyword">None</span>))</div><div class="line"></div><div class="line"><span class="comment"># using -x will generate the following code</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="keyword">import</span> sys</div><div class="line">    app = QtGui.QApplication(sys.argv)</div><div class="line">    Form = QtGui.QWidget()</div><div class="line">    ui = Ui_Form()</div><div class="line">    ui.setupUi(Form)</div><div class="line">    Form.show()</div><div class="line">    sys.exit(app.exec_())</div></pre></td></tr></table></figure>
<ul>
<li><del>run &amp; check the　UI</del><ul>
<li>run <code>python demo.py</code> in the working folder.</li>
<li>OR run directly in editor like atom.</li>
</ul>
</li>
</ul>
<h1 id="click-then-do-sth"><a href="#click-then-do-sth" class="headerlink" title="click then do sth"></a>click then do sth</h1><ul>
<li>create a new py file, for example <code>show.py</code>. input code like:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> demo  <span class="comment"># generated from xxx.ui</span></div><div class="line"><span class="keyword">from</span> PyQt4 <span class="keyword">import</span> QtGui</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyForm</span><span class="params">(QtGui.QWidget, demo.Ui_Form)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        super(self.__class__, self).__init__()  <span class="comment"># QtGui.QWidget.__init__()</span></div><div class="line">        self.setupUi(self)</div><div class="line">        self.pushButton.clicked.connect(</div><div class="line">            self.handleButton)  <span class="comment"># here is important line</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handleButton</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> (<span class="string">"hello, https://draapho.github.io/"</span>)</div><div class="line">        <span class="comment"># size = self.geometry()</span></div><div class="line">        <span class="comment"># self.resize(size.width() + 2, size.height() + 2)</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    app = QtGui.QApplication(sys.argv)</div><div class="line">    form = MyForm()</div><div class="line">    form.show()</div><div class="line">    sys.exit(app.exec_())</div></pre></td></tr></table></figure>
<ul>
<li>look at <code>self.ui.pushButton.clicked.connect(self.handleButton)</code><br>it links clicked event with handleButton function.</li>
<li>if you want to resize the window after clicked the button. change <code>handleButton</code> to</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">handleButton</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="comment"># print ("hello, https://draapho.github.io/")</span></div><div class="line">    size = self.geometry()</div><div class="line">    self.resize(size.width() + <span class="number">2</span>, size.height() + <span class="number">2</span>)</div></pre></td></tr></table></figure>
<h1 id="click-then-do-heavy-work"><a href="#click-then-do-heavy-work" class="headerlink" title="click then do heavy work"></a>click then do heavy work</h1><ul>
<li><p><del>bad code, UI totally dead</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> PyQt4 <span class="keyword">import</span> QtGui</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> demo</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyForm</span><span class="params">(QtGui.QWidget, demo.Ui_Form)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        super(self.__class__, self).__init__()</div><div class="line">        self.setupUi(self)</div><div class="line">        self.pushButton.clicked.connect(self.startCount)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startCount</span><span class="params">(self)</span>:</span></div><div class="line">        self.pushButton.clicked.disconnect()</div><div class="line">        self.pushButton.clicked.connect(self.stopCount)</div><div class="line">        i = <span class="number">0</span></div><div class="line">        <span class="keyword">while</span> i &lt; <span class="number">15</span>:</div><div class="line">            i += <span class="number">1</span></div><div class="line">            self.pushButton.setText(str(i))</div><div class="line">            <span class="keyword">print</span> i</div><div class="line">            time.sleep(<span class="number">1</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stopCount</span><span class="params">(self)</span>:</span></div><div class="line">        self.pushButton.clicked.disconnect()</div><div class="line">        self.pushButton.clicked.connect(self.startCount)</div><div class="line">        self.pushButton.setText(<span class="string">"PushButton"</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app = QtGui.QApplication(sys.argv)</div><div class="line">    form = MyForm()</div><div class="line">    form.show()</div><div class="line">    app.exec_()</div></pre></td></tr></table></figure>
</li>
<li><p>use thread, can do everything in UI</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> PyQt4 <span class="keyword">import</span> QtGui</div><div class="line"><span class="keyword">from</span> PyQt4.QtCore <span class="keyword">import</span> QThread, SIGNAL</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> demo</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">getCountThread</span><span class="params">(QThread)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        QThread.__init__(self)</div><div class="line">        self.count = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span><span class="params">(self)</span>:</span></div><div class="line">        self.wait()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">while</span> self.count &lt; <span class="number">15</span>:</div><div class="line">            self.count += <span class="number">1</span></div><div class="line">            self.emit(SIGNAL(<span class="string">'showCount(int)'</span>), self.count)</div><div class="line">            <span class="keyword">print</span> self.count</div><div class="line">            self.sleep(<span class="number">1</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyForm</span><span class="params">(QtGui.QWidget, demo.Ui_Form)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        super(self.__class__, self).__init__()</div><div class="line">        self.setupUi(self)</div><div class="line">        self.pushButton.clicked.connect(self.startCount)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startCount</span><span class="params">(self)</span>:</span></div><div class="line">        self.pushButton.clicked.disconnect()</div><div class="line">        self.get_thread = getCountThread()</div><div class="line">        self.connect(self.get_thread, SIGNAL(<span class="string">"showCount(int)"</span>), self.showCount)</div><div class="line">        self.connect(self.get_thread, SIGNAL(<span class="string">"finished()"</span>), self.done)</div><div class="line">        self.get_thread.start()</div><div class="line">        <span class="comment"># must be under the self.get_thread.start()</span></div><div class="line">        self.pushButton.clicked.connect(self.get_thread.terminate)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showCount</span><span class="params">(self, count)</span>:</span></div><div class="line">        self.pushButton.setText(str(count))</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">done</span><span class="params">(self)</span>:</span></div><div class="line">        self.pushButton.clicked.disconnect()</div><div class="line">        self.pushButton.setText(<span class="string">"PushButton"</span>)</div><div class="line">        self.pushButton.clicked.connect(self.startCount)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app = QtGui.QApplication(sys.argv)</div><div class="line">    form = MyForm()</div><div class="line">    form.show()</div><div class="line">    app.exec_()</div></pre></td></tr></table></figure>
</li>
<li><p>explanation</p>
<ul>
<li><code>getCountThread</code> 子线程类, 执行繁重任务</li>
<li><code>MyForm</code>-&gt;<code>startCount</code> 点击按键后执行, 设置好信号, 启动子线程</li>
<li><code>self.connect(self.get_thread, SIGNAL(&quot;showCount(int)&quot;), self.showCount)</code><br>准备接收来自线程的信号, 并在 <code>showCount</code> 更新UI</li>
<li><code>self.connect(self.get_thread, SIGNAL(&quot;finished()&quot;), self.done)</code><br>准备接收来自线程的结束信号, 然后在 <code>done</code> 下更新标记和UI</li>
<li><code>self.get_thread.start()</code><br>启动子线程</li>
<li><code>self.pushButton.clicked.connect(self.get_thread.terminate)</code><br>将按键的功能设置为终止子线程, 必须放在 <code>self.get_thread.start()</code> 下面</li>
</ul>
</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-开发软件]]></title>
      <url>https://draapho.github.io/2016/10/16/1611-WinSoft-other/</url>
      <content type="html"><![CDATA[<h1 id="eclipse"><a href="#eclipse" class="headerlink" title="eclipse"></a><a href="https://eclipse.org/downloads/" target="_blank" rel="external">eclipse</a></h1><ul>
<li><a href="https://eclipse.org/downloads/" target="_blank" rel="external">eclipse</a> 就不做介绍了.</li>
<li>设置主题<ul>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt;<code>General</code>-&gt;<code>Appearance</code>-&gt;<code>Color Theme</code>-&gt;<code>Sublime Text 2</code></li>
</ul>
</li>
<li>设置编辑界面<ul>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt; <code>General</code>-&gt;<code>Editors</code>-&gt;<code>Text Editors</code>-&gt;<ul>
<li><code>Insert spaces for tabs</code></li>
<li><code>Show print margin</code></li>
<li><code>Show whitespace characters</code>-&gt;<code>configure visibility</code>-&gt;<del><code>Carriage Return</code></del> <del><code>Line Feed</code></del></li>
</ul>
</li>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt; <code>General</code>-&gt;<code>Editors</code>-&gt;<code>Text Editors</code>-&gt;<code>Quick Diff</code><ul>
<li><code>Enable Quick Diff</code></li>
<li><code>Use this reference source:</code>-&gt;<code>A Git Revision</code></li>
<li>需要装好git</li>
</ul>
</li>
</ul>
</li>
<li>设置路径<ul>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt;<code>Team</code>-&gt;<code>Git</code>-&gt;<code>Default repository folder:</code>-&gt;<code>${project_loc}</code></li>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt;<code>Terminal</code>-&gt;<code>Local Terminal</code>-&gt;<code>Initial Working Directory</code>-&gt;<code>${project_loc}</code></li>
<li>注意, 上述两项需要有git项目并编译后, 才可以成功设置</li>
</ul>
</li>
<li>设置快捷键<ul>
<li><code>Window</code>-&gt;<code>Preferences</code>-&gt;<code>General</code>-&gt;<code>Keys</code> 可设置快捷键</li>
<li>快捷键设置要求见 <a href="https://draapho.github.io/2016/10/08/1607-Shortcut-win/">Windows快捷键</a></li>
<li>配置文件名为 <code>org.eclipse.ui.workbench.prefs</code>, 路径如下, $workspace$ 表示 eclipse 的工作路径.</li>
<li><code>$workspace$\.metadata\.plugins\org.eclipse.core.runtime\.settings</code>下</li>
<li>TrueSTUIDO版的快捷键见TureSTUDIO</li>
</ul>
</li>
</ul>
<h1 id="TrueSTUIDO"><a href="#TrueSTUIDO" class="headerlink" title="TrueSTUIDO"></a><a href="http://atollic.com/truestudio/" target="_blank" rel="external">TrueSTUIDO</a></h1><ul>
<li><a href="http://atollic.com/truestudio/" target="_blank" rel="external">TrueSTUIDO</a>是一款免费的ARM IDE, 基于eclipse. 免费版有5s广告.</li>
<li>快捷键配置文件<ul>
<li>我的配置文件 <a href="https://github.com/draapho/Blog/tree/master/_blog_stuff/eclipse/org.eclipse.ui.workbench.prefs" target="_blank" rel="external">org.eclipse.ui.workbench.prefs</a></li>
<li>下载后直接覆盖放入 <code>$workspace$/.metadata/.plugins/org.eclipse.core.runtime/.settings/</code></li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=R2hfq4S_-B0" target="_blank" rel="external">TrueSTUIDO Download and Reset (no debug)</a><ul>
<li><code>Run</code>-&gt;<code>Debug Configurations...</code>-&gt;<code>Embedded C/C++...</code>下的文件-&gt;<code>Startup Scripts</code></li>
<li>delete all context after <code>load</code> and input <code>quit</code></li>
<li><code>Window</code>-&gt;<code>Perspective</code>-&gt;<code>Customize Pespective...</code>-&gt;<code>Launch</code>-&gt;选择 <code>Debug</code> 和 <code>Run</code></li>
</ul>
</li>
<li>生成指定格式<ul>
<li>项目右键 <code>Properties</code>-&gt;<code>C/C++ Build</code>-&gt;<code>Settings</code>-&gt;<code>Tool Settings</code>-&gt;<code>Other</code>-&gt;<code>Output format</code>-&gt;<code>Convert build output</code>-&gt;<code>Intel Hex</code> or <code>Binary</code></li>
</ul>
</li>
</ul>
<h1 id="RealView-MDK"><a href="#RealView-MDK" class="headerlink" title="RealView MDK"></a>RealView MDK</h1><ul>
<li>RVMDK 设置成utf8格式. <code>Edit</code>-&gt;<code>Configuration</code>-&gt;<code>Editor</code>-&gt;<code>Encoding</code>-&gt;<code>UTF8</code></li>
</ul>
<h1 id="Source-Insight"><a href="#Source-Insight" class="headerlink" title="Source Insight"></a>Source Insight</h1><ul>
<li>添加完文件后, 需要同步. <code>Project</code>-&gt;<code>Synchronize Files...</code></li>
<li>添加文件类型. <code>Options</code>-&gt;<code>Document Options</code>-&gt;<code>Document Type</code>, 在file filter内增加文件类型即可</li>
</ul>
<h1 id="使用mingw编译C语言"><a href="#使用mingw编译C语言" class="headerlink" title="使用mingw编译C语言"></a>使用mingw编译C语言</h1><ul>
<li>主要用于写一些小程序用来验证或测试. 与linux开发习惯一致, 而且免费轻巧快捷.</li>
<li><p>下载 <a href="http://www.mingw.org/" target="_blank" rel="external">MinGW</a>, 安装并设置好环境变量.</p>
<ul>
<li>安装好后, 只是 MinGW Installation Manager, 实际上是个绿色软件. 打开后继续安装组件</li>
<li><code>Basic Setup</code>-&gt;<code>mingw32-base</code> 和 <code>mingw32-gcc-g++</code>-&gt;左上 <code>Installation</code>-&gt;<code>Apply changes</code>-&gt;等待安装完成.</li>
<li>这里只需要编译c和c++文件, 无需安装其它组件了.</li>
<li>设置 <code>...\MinGW\bin</code> 文件夹到系统环境变量中</li>
<li>复制一份 <code>mingw32-make.exe</code> 并重命名为 <code>make.exe</code>, 这样就能直接用 make 指令了</li>
<li>测试. 终端中输入 <code>make -v</code> 和 <code>gcc -v</code>, 看是否可以识别到指令</li>
</ul>
</li>
<li><p>建立一个工作目录, 建立2个文件即可. 一个 <code>.c</code>, 另一个 <code>makefile</code> 即可</p>
<ul>
<li><p>创建并命名为 <code>main.c</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\r\nhello: %s\r\n"</span>, <span class="string">"DRA&amp;PHO"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>创建并命名为 <code>makefile</code></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">test:main.o</div><div class="line">    gcc -o hello main.o</div><div class="line"></div><div class="line">main.o:main.c</div><div class="line">    gcc -c main.c</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>打开终端, 切换到这个工作目录</p>
<ul>
<li>输入 <code>make</code> 即可编译, 会生成 <code>main.o</code> <code>hello.exe</code> 两个文件</li>
<li>输入 <code>./hello.exe</code> 执行, 终端就会输出 <code>hello: DRA&amp;PHO</code></li>
</ul>
</li>
<li>资料和参考<ul>
<li><a href="http://blog.csdn.net/zhanghan3/article/details/1334308" target="_blank" rel="external">windows下使用makefile编译C语言</a></li>
</ul>
</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-atom插件]]></title>
      <url>https://draapho.github.io/2016/10/12/1610-WinSoft-atompack/</url>
      <content type="html"><![CDATA[<h1 id="atom简介"><a href="#atom简介" class="headerlink" title="atom简介"></a><a href="https://atom.io/" target="_blank" rel="external">atom</a>简介</h1><ul>
<li>界面简洁, 基本上手可用, 无需复杂设置</li>
<li>开源免费, 而且多平台支持, 有丰富的插件库</li>
<li>和git的整合度很好! 直观明了好用</li>
<li>启动相对较慢, 但可接受.</li>
<li>懒人不想折腾, atom无明显短板, 就作为主力代码编辑器了</li>
<li>定位是 Notepad++ 为快速处理文件, atom 处理项目</li>
<li>此篇重点介绍 atom 插件的选择和安装, 以及配置快捷键. 基础介绍见<a href="https://draapho.github.io/2016/09/30/1603-WinSoft-editor/">Windows 软件系列-文本编辑</a></li>
</ul>
<h1 id="atom-插件的安装方式"><a href="#atom-插件的安装方式" class="headerlink" title="atom 插件的安装方式"></a>atom 插件的安装方式</h1><ul>
<li><code>ctrl-,</code>-&gt;<code>Settings</code>-&gt;<code>Install</code>-&gt;选择要安装的插件</li>
<li>终端下使用命令行 <code>apm install</code>, 装完后需要重启atom.<br>有些插件只能通过这个方式安装. 譬如要安装 <code>linter</code>, 命令行输入<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apm install linter</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="atom-通用插件"><a href="#atom-通用插件" class="headerlink" title="atom 通用插件"></a>atom 通用插件</h1><ul>
<li><code>Sublime-Style-Column-Selection</code> 使用 <code>alt-鼠标左键</code> 进入列选模式</li>
<li><code>atom-beautify</code> 自动格式化代码,<ul>
<li>需设置 <code>ctrl-b</code> 美化</li>
</ul>
</li>
<li><del><code>autocomplete-paths</code></del> 辅助完成路径</li>
<li><code>block-comment-plus</code> 批量注释, 支持多种语言<ul>
<li>需设置 <code>ctrl-shift-/</code> 和 <code>ctrl-shift-\</code></li>
</ul>
</li>
<li><code>dash</code>  文档帮助, 配合 zeal (windows/linux) 或 dash(apple), 实现快速查询API<ul>
<li>需设置 <code>F1</code> 帮助</li>
</ul>
</li>
<li><del><code>disable-keybindings</code></del> 快速禁用atom的部分快捷键</li>
<li><code>docblockr</code> 注释辅助, 快速添加函数的注释<ul>
<li>支持 <code>tab</code> 键直接在参数间跳转</li>
<li><code>Align tags</code>-&gt;<code>deep</code></li>
<li><code>Auto add method tag</code></li>
<li><del><code>Extend double slash</code></del></li>
</ul>
</li>
<li><code>highlight-selected</code> 自动高亮匹配的词,</li>
<li><code>hyperclick</code> 快速跳转到定义处, 仅限单文件, 但可由别的插件扩展<ul>
<li><code>Trigger keys for Windows</code> <code>ctrl-shift-click</code>. 用ctrl键和系统多选冲突</li>
</ul>
</li>
<li><code>last-cursor-position</code> 浏览历史跳转<ul>
<li>需设置 <code>ctrl-shift-z</code> <code>ctrl-shift-y</code> 进行跳转</li>
</ul>
</li>
<li><code>linter</code> 语法检查基础包</li>
<li><code>minimap</code> 文件地图</li>
<li><code>minimap-highlight-selected</code> 在文件地图中显示匹配的词</li>
<li><code>platformio-ide-terminal</code> 终端软件 <ul>
<li>支持 <code>ctrl-~</code> 快速打开, <code>ctrl-enter</code> 输入选中的文本</li>
<li><code>Close Terminal on Exit</code></li>
<li><code>Shell Override</code>-&gt;<code>git-cmd.exe</code> 没有配置环境变量则需要使用绝对路径</li>
<li><code>Shell Arguments</code>-&gt;<code>--no-cd --command=usr/bin/bash.exe -l -i</code></li>
<li><code>Working Directory</code>-&gt;<code>Project</code></li>
<li><code>Theme</code>-&gt;<code>homebrew</code> 黑底绿字</li>
</ul>
</li>
<li><del><code>Project Manager</code></del> 加入项目的概念, 纯快捷键操作. 与<code>project-viewer</code>二选一即可.</li>
<li><code>project-viewer</code> 加入项目的概念,  带UI. 与<code>Project Manager</code>二选一即可.<ul>
<li><code>Status Bar Visibility</code></li>
<li><code>Autohide</code></li>
<li><code>Positon of the panel</code>-&gt;<code>Left</code></li>
<li><del><code>Convert Old Data</code></del></li>
</ul>
</li>
<li><code>script</code> 一键执行, 支持多种代码, 不弹窗<ul>
<li>需设置 <code>F5</code> 执行</li>
</ul>
</li>
<li><code>symbols-tree-view</code> 显示类/变量/函数列表<ul>
<li><code>Auto Hide</code></li>
<li><code>Auto Toggle</code></li>
</ul>
</li>
<li><code>tabs-to-spaces</code> tab空格互相转换</li>
<li><del><code>vim-mode</code></del> vim操作方式. 需要屏蔽按键 <code>ctrl-f</code>, 恢复为搜索按键<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&apos;atom-text-editor.vim-mode:not(.insert-mode)&apos;:</div><div class="line">  &apos;ctrl-f&apos;: &apos;unset!&apos;</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="git-插件"><a href="#git-插件" class="headerlink" title="git 插件"></a>git 插件</h1><ul>
<li><code>git-time-machine</code> 查看单文件的git历史<ul>
<li>需设置 <code>f6</code> 查看比较</li>
</ul>
</li>
<li><del><code>git-plus</code></del> git辅助, 我是通过 <code>platformio-ide-terminal</code> 打开终端敲git命令.</li>
<li>merge-conflicts 查看git文件冲突<ul>
<li>需设置 <code>ctrl-f6</code> 查看冲突</li>
</ul>
</li>
</ul>
<h1 id="python-插件"><a href="#python-插件" class="headerlink" title="python 插件"></a>python 插件</h1><ul>
<li>配置 <code>atom-beautify</code> 之python语言<ul>
<li>安装 <a href="https://www.python.org/" target="_blank" rel="external">python</a> </li>
<li>安装 <a href="https://github.com/hhatto/autopep8" target="_blank" rel="external">autopep8</a>, 调用 <code>pip install --upgrade autopep8</code></li>
<li>默认就是使用 <code>autopep8</code> 优化代码, 也推荐这个使用这个工具. <code>yapf</code>的优化结果无法满足<code>linter-flake8</code>的检查.</li>
<li>测试. 打开一个 <code>.py</code> 文件, 右键选择 <code>Beautify editor contents</code> 看是否成功了.</li>
</ul>
</li>
<li><del><code>atom-python-run</code></del> <code>F5</code>运行, 但是会弹cmd窗, 改用<code>script</code></li>
<li><code>autocomplete-python</code> python辅助, 配合 <code>hyperclick</code> 跳转很方便<ul>
<li>设置快捷键 <code>f4</code> 跳转</li>
<li><code>Show Descriptions</code></li>
<li><code>Autocomplete Function Parameters</code>-&gt;<code>all</code></li>
</ul>
</li>
<li><code>linter-flake8</code> 代码规范检查, 检查很严, 配合 autopep8 的自动格式化就很完美了.<ul>
<li>终端输入 <code>pip install flake8</code> python 安装 <code>flake8</code></li>
<li>终端输入 <code>apm install linter-flake8</code> atom 安装 <code>linter-flake8</code></li>
<li>插件配置 <code>Ignore Error</code>-&gt;<code>E501</code> 超过79列不要提示错误</li>
</ul>
</li>
</ul>
<h1 id="c-c-插件"><a href="#c-c-插件" class="headerlink" title="c/c++ 插件"></a>c/c++ 插件</h1><ul>
<li>配置 <code>atom-beautify</code> 之c/c++语言<ul>
<li>安装<a href="http://uncrustify.sourceforge.net/" target="_blank" rel="external">uncrustify</a>, 可以自动美化多种语言的格式.<ul>
<li>下载<a href="https://sourceforge.net/projects/uncrustify/files/uncrustify/uncrustify-0.63/" target="_blank" rel="external">uncrustify-0.63.0-g44ce0f1-win32.zip</a></li>
<li>解压后, 将uncrustify目录加入环境变量, 已 <code>D:\uncrustify\</code> 为例</li>
<li>终端内输入 <code>uncrustify -v</code>, 测试是否配置好 uncrustify</li>
</ul>
</li>
<li><code>atom-beautify</code> 插件的配置, 在c和c++下分别操作一次.<ul>
<li><code>Default Beautifier</code>-&gt;<code>Uncrustify</code> . <del>另一个选项 <code>clang-format</code> 需要安装clang, 里面带有指令<code>clang-format.exe</code></del></li>
<li><code>Config Path</code>-&gt;<code>D:\uncrustify\cfg\linux.cfg</code> 选择格式化模板</li>
</ul>
</li>
<li>测试, 打开一个 <code>.c</code> 文件, 右键选择 <code>Beautify editor contents</code> 看是否成功了.</li>
</ul>
</li>
<li><code>atom-gtags</code>, 能比较好的实现跳转<ul>
<li>设置快捷键 <code>f4</code> 跳转</li>
<li>右键项目根目录即可 <code>Build Gtags</code></li>
<li>放弃 <del><code>atom-ctags</code></del> 实测效果很差!</li>
<li>比较: <a href="https://github.com/OpenGrok/OpenGrok/wiki/Comparison-with-Similar-Tools" target="_blank" rel="external">https://github.com/OpenGrok/OpenGrok/wiki/Comparison-with-Similar-Tools</a></li>
</ul>
</li>
<li>基于gcc编译的配置<ul>
<li>下载 <a href="http://www.mingw.org/" target="_blank" rel="external">MinGW</a>, 安装并设置好环境变量<ul>
<li>安装好后, 只是 <code>MinGW Installation Manager</code>, 实际上是个绿色软件. 打开后继续安装组件</li>
<li><code>Basic Setup</code>-&gt;<code>mingw32-base</code> 和 <code>mingw32-gcc-g++</code>-&gt;左上 <code>Installation</code>-&gt;<code>Apply changes</code>-&gt;等待安装完成.</li>
<li>这里只需要编译c和c++文件, 无需安装其它组件了.</li>
<li>设置 <code>...\MinGW\bin</code> 文件夹到系统环境变量中</li>
<li>复制一份 <code>mingw32-make.exe</code> 并重命名为 <code>make.exe</code>, 这样就能直接用 <code>make</code> 指令了</li>
<li>测试. 终端中输入 <code>make -v</code> 和 <code>gcc -v</code>, 看是否可以识别到指令</li>
</ul>
</li>
<li><del><code>gpp-compiler</code></del> <code>f5</code>运行, 但会弹cmd窗, 决定使用内置终端</li>
<li><code>linter-gcc</code> 基于gcc进行语法检查<ul>
<li><code>GCC Excutable Path</code>-&gt;<code>gcc</code> 或 <code>g++</code>, 没有配置环境变量的话, 使用绝对路径, 注意斜杠!</li>
<li><code>GCC Include Paths</code>-&gt;<code>.../MinGW/include/*</code> 注意斜杠方向! 加入必要头文件.</li>
<li>只在保存时, 才会进行语法检查</li>
</ul>
</li>
</ul>
</li>
<li><del>基于clang编译的配置</del><ul>
<li>彻底放弃这个系列, 不用vs, 基于mingw的配置失败.</li>
<li>相关软件和参考如下</li>
<li><del><code>autocomplete-clang</code></del> 自动完成</li>
<li><del><code>linter-clang</code></del> 语法检查</li>
<li><a href="http://llvm.org/" target="_blank" rel="external">clang官网</a>. 官网进入的链接是找不到windows下编译好的版本的.</li>
<li>下载特定版本的clang, 如 <code>LLVM-3.9.0</code>, 使用链接:<a href="http://llvm.org/releases/3.9.0/" target="_blank" rel="external">http://llvm.org/releases/3.9.0/</a></li>
<li>参考 <a href="http://m.blog.csdn.net/article/details?id=49902519" target="_blank" rel="external">解决llvm/clang在windows下编译时找不到头文件和Lib的问题</a></li>
</ul>
</li>
</ul>
<h1 id="markdown插件"><a href="#markdown插件" class="headerlink" title="markdown插件"></a>markdown插件</h1><ul>
<li>atom已经支持markdown, 使用<code>ctrl-shift-m</code>即可预览. 如果要增强功能, 可以使用插件</li>
<li><del><code>markdown-preview-enhanced</code></del> markdown, 导出为pdf时, 制图显示有问题<ul>
<li><code>Break On Single Newline</code></li>
<li><code>Enable Typographer</code></li>
<li><code>Math Rendering Option</code>-&gt;<code>MathJax</code></li>
<li><del><code>Enable Wiki Link Syntax</code></del></li>
<li><del><code>Use GitHub.com syntax theme</code></del></li>
<li><del><code>Print Background when generating pdf</code></del> 否则pdf不显示制图</li>
<li><del><code>Use Github style when generating pdf</code></del> 否则pdf不显示制图</li>
<li><del><code>Open preview pane automatically when opening a markdown file</code></del></li>
<li><code>Image Uploader</code>-&gt;<code>sm.ms</code> 建议这个. <code>imgur</code> 有时限</li>
<li><code>Mermaid Theme</code>-&gt;<code>mermaid.forest.css</code></li>
</ul>
</li>
</ul>
<h1 id="atom快捷键配置"><a href="#atom快捷键配置" class="headerlink" title="atom快捷键配置"></a>atom快捷键配置</h1><ul>
<li>使用 <code>ctrl-.</code> 查看按键冲突. 如果无效, 试试点到非编辑区(如目录树)试试.</li>
<li><code>ctrl-,</code>-&gt;<code>Settings</code>-&gt;<code>Keybindings</code>-&gt;<code>your keymap file</code>-&gt;打开<code>keymap.cson</code></li>
<li>自定义快捷键方式可参考 <a href="http://flight-manual.atom.io/using-atom/sections/basic-customization/#_customizing_keybindings" target="_blank" rel="external">Basic Customization</a></li>
<li>很明显, 要备份自己的快捷键设置, 只需要保存这份 <code>keymap.cson</code> 文件</li>
<li>最后禁用插件里不需要的快捷键, 或者使用 <code>disable-keybindings</code>.<ul>
<li><code>Keybindings</code> -&gt; <del><code>Enable</code></del>. 屏蔽以下插件:</li>
<li><code>atom-beautify</code>, <code>atom-gtags</code>, <code>autocomplete-python</code></li>
<li><code>block-comment-plus</code>, <code>dash</code>, <code>git-time-machine</code></li>
<li><code>highlight-selected</code>, <code>hyperclick</code>, </li>
<li><code>script</code>, <code>symbols-tree-view</code>, <code>tabs-to-spaces</code></li>
</ul>
</li>
<li><p>我的 <code>keymap.cson</code> 配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line"># atom 大致原则是, 小窗口&gt;大窗口, 然后才是客户配置&gt;插件配置&gt;系统配置</div><div class="line"># 因此优先级 &apos;body&apos; &lt; &apos;atom-workspace&apos; &lt; &apos;atom-text-editor&apos; &lt; &apos;atom-text-editor:not([mini])&apos;</div><div class="line"></div><div class="line">&apos;atom-text-editor[data-grammar~=python]:not(.mini)&apos;:</div><div class="line">  &apos;f4&apos;: &apos;autocomplete-python:go-to-definition&apos;</div><div class="line">  &apos;shift-f4&apos;: &apos;autocomplete-python:go-to-definition&apos;</div><div class="line">  &apos;alt-shift-s&apos;: &apos;autocomplete-python:override-method&apos;</div><div class="line"></div><div class="line">&apos;atom-text-editor[data-grammar~=c]:not(.mini)&apos;:</div><div class="line">  &apos;f4&apos;: &apos;atom-gtags:get-definitions&apos;</div><div class="line">  &apos;shift-f4&apos;: &apos;atom-gtags:get-references&apos;</div><div class="line"></div><div class="line">&apos;.platform-win32 atom-workspace atom-text-editor:not([mini])&apos;:</div><div class="line"># character                            </div><div class="line">  &apos;ctrl-b&apos;: &apos;atom-beautify:beautify-editor&apos;</div><div class="line">  &apos;ctrl-d&apos;: &apos;core:delete&apos;</div><div class="line">  &apos;ctrl-shift-d&apos;: &apos;editor:delete-line&apos;</div><div class="line">  &apos;ctrl-j&apos;: &apos;core:move-down&apos; </div><div class="line">  &apos;ctrl-k&apos;: &apos;core:move-up&apos;   </div><div class="line">  &apos;ctrl-l&apos;: &apos;core:move-right&apos;</div><div class="line">  &apos;ctrl-h&apos;: &apos;core:move-left&apos;</div><div class="line">  &apos;ctrl-shift-j&apos;: &apos;editor:move-line-down&apos;</div><div class="line">  &apos;ctrl-shift-k&apos;: &apos;editor:move-line-up&apos;</div><div class="line">  &apos;ctrl-shift-l&apos;: &apos;editor:move-to-end-of-word&apos;</div><div class="line">  &apos;ctrl-shift-h&apos;: &apos;editor:move-to-beginning-of-word&apos;</div><div class="line">  &apos;alt-shift-j&apos;: &apos;editor:join-lines&apos;</div><div class="line">  &apos;ctrl-m&apos;: &apos;bookmarks:toggle-bookmark&apos;  </div><div class="line">  &apos;ctrl-r&apos;: &apos;core:redo&apos;</div><div class="line">  &apos;ctrl-u&apos;: &apos;core:undo&apos;</div><div class="line">  &apos;ctrl-shift-v&apos;: &apos;editor:duplicate-lines&apos;</div><div class="line">  &apos;ctrl-shift-W&apos;: &apos;tabs:close-other-tabs&apos;</div><div class="line">  &apos;ctrl-shift-x&apos;: &apos;editor:select-line&apos;</div><div class="line">  &apos;ctrl-shift-y&apos;: &apos;last-cursor-position:next&apos;</div><div class="line">  &apos;ctrl-shift-z&apos;: &apos;last-cursor-position:previous&apos;</div><div class="line"># special</div><div class="line">  &apos;ctrl-4&apos;: &apos;editor:move-to-end-of-screen-line&apos;         # ctrl-$</div><div class="line">  &apos;ctrl-6&apos;: &apos;editor:move-to-first-character-of-line&apos;    # ctrl-^</div><div class="line">  &apos;ctrl-$&apos;: &apos;editor:select-to-end-of-line&apos;              # ctrl-shift-$</div><div class="line">  &apos;ctrl-^&apos;: &apos;editor:select-to-first-character-of-line&apos;  # ctrl-shift-^</div><div class="line">  &apos;ctrl-?&apos;: &apos;block-comment-plus:toggle&apos;                 # ctrl-shift-/</div><div class="line">  &apos;ctrl-|&apos;: &apos;block-comment-plus:toggle&apos;                 # ctrl-shift-\</div><div class="line">  &apos;ctrl-]&apos;: &apos;bracket-matcher:select-inside-brackets&apos;</div><div class="line">  &apos;ctrl-[&apos;: &apos;bracket-matcher:go-to-matching-bracket&apos;</div><div class="line">  &apos;ctrl-.&apos;: &apos;tabs-to-spaces:untabify-all&apos;</div><div class="line">  &apos;ctrl-&gt;&apos;: &apos;tabs-to-spaces:tabify&apos;                     # ctrl-shift-.</div><div class="line"># alt</div><div class="line">  &apos;alt-0&apos;: &apos;editor:fold-all&apos;</div><div class="line">  &apos;alt-)&apos;: &apos;editor:unfold-all&apos;                          # alt-shift-0</div><div class="line">  &apos;alt-!&apos;: &apos;editor:unfold-all&apos;                          # alt-shift-1</div><div class="line">  &apos;alt-1&apos;: &apos;editor:fold-at-indent-level-1&apos;</div><div class="line">  &apos;alt-2&apos;: &apos;editor:fold-at-indent-level-2&apos;</div><div class="line">  &apos;alt-3&apos;: &apos;editor:fold-at-indent-level-3&apos;</div><div class="line">  &apos;alt-4&apos;: &apos;editor:fold-at-indent-level-4&apos;</div><div class="line">  &apos;alt-5&apos;: &apos;editor:fold-at-indent-level-5&apos;</div><div class="line">  &apos;alt-6&apos;: &apos;editor:fold-at-indent-level-6&apos;</div><div class="line">  &apos;alt-7&apos;: &apos;editor:fold-at-indent-level-7&apos;</div><div class="line">  &apos;alt-8&apos;: &apos;editor:fold-at-indent-level-8&apos;</div><div class="line">  &apos;alt-9&apos;: &apos;editor:fold-at-indent-level-9&apos;</div><div class="line"># f1-f6</div><div class="line">  &apos;f1&apos;: &apos;dash:shortcut&apos;</div><div class="line">  &apos;ctrl-f2&apos;: &apos;bookmarks:view-all&apos;</div><div class="line">  &apos;ctrl-shift-f2&apos;: &apos;bookmarks:clear-bookmarks&apos;</div><div class="line">  &apos;ctrl-f3&apos;: &apos;find-and-replace:select-all&apos;</div><div class="line">  &apos;f5&apos;: &apos;script:run&apos;</div><div class="line">  &apos;f6&apos;: &apos;git-time-machine:toggle&apos;</div><div class="line">  &apos;ctrl-f6&apos;: &apos;merge-conflicts:detect&apos;</div><div class="line">  &apos;shift-f6&apos;: &apos;merge-conflicts:next-unresolved&apos;</div><div class="line">  &apos;ctrl-shift-f6&apos;: &apos;merge-conflicts:previous-unresolved&apos;</div><div class="line"></div><div class="line">&apos;body&apos;:</div><div class="line">  &apos;ctrl-j&apos;: &apos;core:move-down&apos;</div><div class="line">  &apos;ctrl-k&apos;: &apos;core:move-up&apos;</div><div class="line">  &apos;ctrl-r&apos;: &apos;core:redo&apos;</div><div class="line">  &apos;ctrl-u&apos;: &apos;core:undo&apos;</div><div class="line">  &apos;ctrl-shift-S&apos;: &apos;window:save-all&apos;</div><div class="line"># unset ctrl-k *</div><div class="line">  &apos;ctrl-k up&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k down&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k left&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k right&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-w&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-alt-w&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-p&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-n&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-up&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-down&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-left&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-right&apos;: &apos;unset!&apos;</div><div class="line">&apos;atom-workspace atom-text-editor&apos;:</div><div class="line">  &apos;ctrl-k ctrl-u&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-l&apos;: &apos;unset!&apos;</div><div class="line">&apos;atom-workspace atom-text-editor:not([mini])&apos;:</div><div class="line">  &apos;ctrl-k ctrl-0&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-1&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-2&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-3&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-4&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-5&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-6&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-7&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-8&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k ctrl-9&apos;: &apos;unset!&apos;</div><div class="line">&apos;.platform-win32, .platform-linux&apos;: </div><div class="line">  &apos;ctrl-k ctrl-b&apos;: &apos;unset!&apos;</div><div class="line">&apos;.platform-win32 .tree-view, .platform-linux .tree-view&apos;:</div><div class="line">  &apos;ctrl-k right&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k l&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k left&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k h&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k up&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k k&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k down&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-k j&apos;: &apos;unset!&apos;</div><div class="line">&apos;.platform-win32 atom-text-editor, .platform-linux atom-text-editor&apos;:</div><div class="line">  &apos;ctrl-k ctrl-d&apos;: &apos;unset!&apos;</div><div class="line">  &apos;ctrl-u&apos;: &apos;unset!&apos;</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="参考和资料"><a href="#参考和资料" class="headerlink" title="参考和资料"></a>参考和资料</h1><ul>
<li><a href="http://flight-manual.atom.io/" target="_blank" rel="external">Atom Flight Manual</a>, atom手册</li>
<li><a href="https://atom.io/packages" target="_blank" rel="external">atom Packages</a>, atom插件中心</li>
<li>我的 <a href="https://draapho.github.io/2016/10/08/1607-Shortcut-win/">Windows快捷键</a></li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-终端]]></title>
      <url>https://draapho.github.io/2016/10/10/1609-WinSoft-terminal/</url>
      <content type="html"><![CDATA[<h1 id="ConEmu-简介"><a href="#ConEmu-简介" class="headerlink" title="ConEmu 简介"></a><a href="https://conemu.github.io/" target="_blank" rel="external">ConEmu</a> 简介</h1><ul>
<li><a href="https://conemu.github.io/" target="_blank" rel="external">ConEmu</a> 即 Console Emulate, 一款终端模拟器, 完全免费, 可以通过他加载多种终端如 cmd, shell, bash, putty 而且便于管理!</li>
<li>简而言之, 凡是喜欢用命令行方式的, windows就请使用这款软件, 分分钟变身geek或者hacker的感觉…</li>
<li>右键文件夹打开ConEmu就自动进入此文件夹, <code>ConEmu Inside</code> 甚至能嵌入到文件夹中.</li>
<li>顺便说一句, cmder就是他的马甲, 核心还是ConEmu.</li>
</ul>
<h2 id="我的ConEmu"><a href="#我的ConEmu" class="headerlink" title="我的ConEmu"></a>我的ConEmu</h2><ul>
<li>我希望的ConEmu, 就是想输命令行, 打开ConEmu就行!</li>
<li>本文的配置可以在ConEmu中执行:<ul>
<li><code>cmd</code> <code>shell</code> windows自带终端</li>
<li><code>git</code> windows下安装好git即可, 包含了<code>git-bash</code></li>
<li><code>mingw</code> windows下用gnu工具链编译c, c++</li>
<li><code>putty</code> ssh链接远程linux, 串口链接嵌入式linux</li>
<li><code>cygwin</code> windows下模拟linux运行环境 (目前尚未使用, 在用传统的虚拟机)</li>
<li>其它指令如: <code>hexo</code> 博客使用, <code>choco</code> 安装软件使用, <code>apm</code> atom下载插件使用.</li>
</ul>
</li>
<li>快速在指定文件夹下打开ConEmu, 可在 <code>Listary</code> 关联快捷键 <code>ctrl-~</code></li>
<li>快速在Notepad++下打开ConEmu, 关联快捷键 <code>ctrl-~</code></li>
</ul>
<h2 id="自制ConEmu绿色版"><a href="#自制ConEmu绿色版" class="headerlink" title="自制ConEmu绿色版"></a>自制ConEmu绿色版</h2><ul>
<li>下载 <a href="https://conemu.github.io/" target="_blank" rel="external">ConEmu便携版</a><ul>
<li>解压后放在理想的文件夹中. 下面以 <code>D:\Green\ConEmu</code> 路径为例.</li>
</ul>
</li>
<li>下载 <a href="https://mridgers.github.io/clink/" target="_blank" rel="external">clink便携版</a>, 用于增强终端操作, 如复制拷贝快捷键等<ul>
<li>解压后, 所有文件放入 <code>D:\Green\ConEmu\ConEmu\clink</code>, 这里面原来就有个 <code>Readme.txt</code>, 说的非常清楚了</li>
</ul>
</li>
<li>下载 <a href="https://git-scm.com/download/win" target="_blank" rel="external">git便携版</a>, 版本管理软件<ul>
<li>解压后命名为 <code>Git</code> 放到 <code>D:\Green\ConEmu\plugins</code>,</li>
</ul>
</li>
<li>下载并使用默认设置安装 <a href="http://www.mingw.org/" target="_blank" rel="external">mingw</a>, 用于在win下使用gnu工具编译<ul>
<li>只是装了 <code>MinGW Installation Manager</code> (实际上是个绿色软件). 打开后继续安装组件</li>
<li><code>Basic Setup</code>-&gt;<code>mingw32-base</code>和<code>mingw32-gcc-g++</code>-&gt;左上<code>Installation</code>-&gt;<code>Apply changes</code>-&gt;等待安装完成.</li>
<li>我只需要编译c和c++文件, <code>msys</code>也已经由git软件实现了, 因此无需安装其它组件了.</li>
<li>然后把整个 <code>MinGW</code> 文件夹放到 <code>D:\Green\ConEmu\plugins</code></li>
<li>复制一份 <code>mingw32-make.exe</code> 并重命名为 <code>make.exe</code>, 这样就能直接用 <code>make</code> 指令了</li>
</ul>
</li>
<li>下载 <a href="http://www.putty.org/" target="_blank" rel="external">putty.zip</a>, ssh远程连接软件及串口软件<ul>
<li>解压后命名为 <code>putty</code> 放到 <code>D:\Green\ConEmu\plugins</code></li>
</ul>
</li>
<li><p>然后需要将上述软件加入环境变量, 这个可以在ConEmu设置中完成!!!</p>
<ul>
<li><p>打开ConEmu, <code>Setting</code>-&gt;<code>Startup</code>-&gt;<code>Environment</code>-&gt;<code>set PATH=%ConEmuBaseDir%\Scripts;%PATH%</code> 下面加上如下语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># git PATH</div><div class="line">set PATH=%ConEmuDir%\plugins\Git;%PATH%</div><div class="line">set PATH=%ConEmuDir%\plugins\Git\cmd;%PATH%</div><div class="line"># mingw PATH</div><div class="line">set PATH=%ConEmuDir%\plugins\MinGW\bin;%PATH%</div><div class="line"># putty PATH%</div><div class="line">set PATH=%ConEmuDir%\plugins\putty;%PATH%</div></pre></td></tr></table></figure>
</li>
<li><p>这样, ConEmu在启动时, 会自动加入上述软件到PATH中</p>
</li>
<li>如果使用 <strong>更通用的做法</strong>, 把上述环境变量删除或注释掉.</li>
</ul>
</li>
<li>自制ConEmu绿色版就初步完成, 下面只需要配置了.</li>
</ul>
<h2 id="更通用的做法"><a href="#更通用的做法" class="headerlink" title="更通用的做法"></a>更通用的做法</h2><ul>
<li>用上述方法有三个缺点<ul>
<li>git便携版不支持ssh或GPG免密远程同步, 每次都要求输入用户名和密码, 非常麻烦.</li>
<li>如果不用ConEmu, 那么其它终端, 如atom下的终端就无法使用上述软件.</li>
<li>发现putty会新打开一个窗口, 而不是嵌入到ConEmu中.</li>
</ul>
</li>
<li>下载 <a href="https://git-scm.com/download/win" target="_blank" rel="external">git安装版</a>, 使用默认配置安装即可.<ul>
<li>为了便于使用, 建议把git的根目录也加入环境变量, 这样就能直接调用 <code>git-cmd.exe</code></li>
</ul>
</li>
<li>设置 <code>D:\Green\ConEmu\plugins\MinGW\bin</code> 文件夹到系统环境变量中</li>
<li>设置 <code>D:\Green\ConEmu\plugins\putty</code> 文件夹到系统环境变量中</li>
<li>还可以考虑下载安装 <a href="https://www.cygwin.com/" target="_blank" rel="external">cygwin</a> 并加入ConEmu中, 这是一款Windows下的Linux模拟器. 注意安装和卸载都比较麻烦.<h2 id="ConEmu的设置"><a href="#ConEmu的设置" class="headerlink" title="ConEmu的设置"></a>ConEmu的设置</h2></li>
<li>所有设置都会存放在 <code>conEmu.xml</code> 里, 所以设置的备份很简单</li>
<li>首次打开会有设置向导 <code>fast configuration</code>, 用于生成 <code>conEmu.xml</code></li>
<li>可以在设置好环境变量, 安装好git后, 删除<code>conEmu.xml</code>重新运行, 这样ConEmu会自动检测加入<code>Git bash</code> 和 <code>putty</code>, 省心不少. clink放在指定路径后, 其功能也会自动启用.</li>
<li>配置过程如下, 需要图文版可参考 <a href="https://higoge.github.io/2015/07/22/tools02/" target="_blank" rel="external">工具02：cmd的替代品ConEmu+Clink</a>, 配置上略有区别, 进入 <code>Settings</code> 后<ul>
<li><code>Main</code>-&gt;<code>Appearance</code>-&gt;<code>Generic</code>-&gt;<code>Single instance mode (...)</code></li>
<li><code>Main</code>-&gt;<code>Confirm</code>-&gt;<code>CLose confirmations</code>-&gt;<del><code>When running process was detected</code></del></li>
<li><code>Startup</code>-&gt;<code>Specified named task</code>-&gt;<code>Bash:: Git bash</code> 更改打开时默认使用的终端类型</li>
<li><code>Startup</code>-&gt;<code>Environment</code> 启动时, 会加载这里的环境变量. 配置好系统环境变量的话, 可以全部删除</li>
<li>注册鼠标右键 <code>ConEmu Here</code> 和 <code>ConEmu Inside</code>, 并设置为使用 <code>Git bash</code> 启动<ul>
<li><code>Integration</code>-&gt;<code>ConEmu Here</code>-&gt;<code>Command:</code>改为<code>{Git Bash} -cur_console:n</code>-&gt;<code>Register</code></li>
<li><code>Integration</code>-&gt;<code>ConEmu Inside</code>-&gt;<code>Command:</code>改为<code>{Git Bash} -cur_console:n</code>-&gt;<code>Register</code></li>
</ul>
</li>
<li><code>Integration</code>-&gt;<code>Default term</code>-&gt;<code>Force ConEmu as default terminal for console applications</code></li>
<li>添加 <code>tasks</code>. 选择 <code>Startup</code>-&gt;<code>Tasks</code>, 根据现有例子依样画葫芦即可.<ul>
<li><code>Bash::Git bash</code>: <code>git-cmd.lnk --no-cd --command=usr/bin/bash.exe -l -i</code> 也可以点击<code>File path...</code>使用绝对路径替代快捷方式.</li>
<li><code>Bash::Git bash(Admin)</code>: <code>*git-cmd.exe --no-cd --command=usr/bin/bash.exe -l -i</code> 最前面加个<code>*</code>就是管理员权限了.</li>
<li><code>Putty::default</code>: <code>putty.exe</code> 同样, 可能需要使用绝对路径, 点击<code>File path...</code>选择即可</li>
<li><code>Putty::Ubuntu</code>: <code>putty.exe -new_console -load &quot;ubuntu&quot;</code> 需要putty设置好名为<code>ubuntu</code>的session</li>
<li><code>Cygwin</code>: <code>set HOME=d:\cygwin\home\XXX &amp; &quot;d:\cygwin\bin\mintty.exe&quot; -i /Cygwin.ico -</code> 这条指令没有测试过.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="Putty"><a href="#Putty" class="headerlink" title="Putty"></a><a href="http://www.putty.org/" target="_blank" rel="external">Putty</a></h1><ul>
<li><a href="http://www.putty.org/" target="_blank" rel="external">Putty</a> 可用于ssh连接远程主机, 也支持串口. 使用简单, 完全免费</li>
<li>putty的配置, 一个配置就是一个<code>Session</code>. 可以参考<a href="http://blog.csdn.net/tianlesoftware/article/details/5831605" target="_blank" rel="external">Putty 工具 保存配置的 小技巧</a></li>
<li>putty免密登录, 没有尝试, 可以参考如下两篇文章.<ul>
<li><a href="https://segmentfault.com/a/1190000000639516" target="_blank" rel="external">PuTTY的自动登录设置</a></li>
<li><a href="http://blog.csdn.net/hxg130435477/article/details/9960187" target="_blank" rel="external">windows 上用程序putty使用 ssh自动登录linux</a></li>
</ul>
</li>
</ul>
<h2 id="设置Default"><a href="#设置Default" class="headerlink" title="设置Default"></a>设置Default</h2><ul>
<li><code>Window</code>-&gt;<code>Lines of scrollback</code>-<code>20000</code>  回看更多历史屏幕信息</li>
<li><code>Window</code>-&gt;<code>Apperance</code>-&gt;<code>Vertical line</code>, <code>Cursor blinks</code> 游标闪烁</li>
<li><code>Window</code>-&gt;<code>Colours</code>-&gt;<code>Default Backgroud</code>-&gt;<code>R0 G43 B54</code> 使用ConEmu背景色</li>
<li><code>Connection</code>-&gt;<code>Serial</code>-&gt;<code>Flow control</code>-&gt;<code>None</code> 默认串口不用流控制</li>
<li><code>Session</code>-&gt;<code>Saved Sessions</code>-&gt;输入 <code>Default Settings</code>-&gt;<code>Save</code> 默认值设置完成</li>
</ul>
<h2 id="设置ssh"><a href="#设置ssh" class="headerlink" title="设置ssh"></a>设置ssh</h2><ul>
<li><code>Session</code>-&gt;<code>Conncection type</code>选<code>SSH</code>-&gt;<code>Host Name (or IP address)</code>-&gt;<code>10.0.0.99</code> 或者  <code>username@10.0.0.99</code> 来指定登录名</li>
<li><code>Session</code>-&gt;<code>Saved Session</code> <code>Ubuntu</code>-&gt;<code>Save</code> 设置好配置名称, 保存即可.</li>
<li>如果需要免密登录, 明文的很简单, 调用 <code>putty.exe -load &quot;session_name&quot; -l &quot;username&quot; -pw &quot;password&quot;</code> 即可</li>
<li>如果需要密码加密, 稍微麻烦点. 参考 <a href="http://blog.csdn.net/hxg130435477/article/details/9960187" target="_blank" rel="external">windows 上用程序putty使用 ssh自动登录linux</a>. 我不需要这个功能, 略过不表.</li>
</ul>
<h2 id="设置serial"><a href="#设置serial" class="headerlink" title="设置serial"></a>设置serial</h2><ul>
<li><code>Session</code>-&gt;<code>Conncection type</code>选<code>Serial</code>-&gt;<code>Serial line</code> <code>COM4</code>-&gt;<code>Speed</code> <code>9600</code> 即串口4, 波特率9600</li>
<li><code>Connection</code>-&gt;<code>Serial</code>-&gt;<code>Flow control</code> <code>None</code> 这里可以设置其它串口参数, 不支持自动回显.</li>
<li><code>Session</code>-&gt;<code>Saved Session</code> <code>COM4-9600</code>-&gt;<code>Save</code> 设置好配置名称, 保存即可.</li>
</ul>
<h2 id="配置的导入和导出"><a href="#配置的导入和导出" class="headerlink" title="配置的导入和导出"></a>配置的导入和导出</h2><ul>
<li>putty直接把配置存放在注册表中. 所以思路就是导入导出注册表</li>
<li>cmd下-&gt;<code>regedit</code>-&gt;打开注册表</li>
<li>找到 <code>HKEY_CURRENT_USER\Software\SimonTatham</code></li>
<li>在 <code>SimonTatham</code> 这个节点上点击右键, 选择导出, 保存为<code>config.reg</code>. 这里不单单是putty的配置</li>
<li>恢复时, 管理员权限执行 <code>config.reg</code> 即可</li>
</ul>
<h2 id="putty的调用"><a href="#putty的调用" class="headerlink" title="putty的调用"></a>putty的调用</h2><ul>
<li>基本用法 <code>putty.exe -load &quot;session_name&quot;</code></li>
<li>自动登录 <code>putty.exe -load &quot;session_name&quot; -l &quot;username&quot; -pw &quot;password&quot;</code></li>
<li>更多调用方式可查看 <code>PUTTY.CHM 3.8.x</code> 包含于下载的<code>putty.zip</code>中</li>
</ul>
<h2 id="对比TeraTerm"><a href="#对比TeraTerm" class="headerlink" title="对比TeraTerm"></a>对比<a href="https://ttssh2.osdn.jp/index.html.en" target="_blank" rel="external">TeraTerm</a></h2><ul>
<li>TeraTerm相比于putty设置显得更复杂, 至少串口的功能比putty的要多一点</li>
<li>TeraTerm有自己的脚本语句, 可以实现比较复杂的自动化功能</li>
<li>TeraTerm在ConEmu字体显示有问题.</li>
<li>putty完全满足需求, 配置简单, 完美兼容ConEmu, 因此没有考虑TeraTerm</li>
</ul>
<h1 id="Cygwin"><a href="#Cygwin" class="headerlink" title="Cygwin"></a><a href="https://www.cygwin.com/" target="_blank" rel="external">Cygwin</a></h1><ul>
<li>是windows下的unix仿真环境, 可以用来做交叉编译, 因此可替代虚拟机安装linux.</li>
<li>安装, 可以参考 <a href="http://velep.com/archives/747.html" target="_blank" rel="external">cygwin介绍、安装及其使用</a></li>
<li>交叉编译, 可以参考<ul>
<li><a href="http://mazhijing.blog.51cto.com/215535/39539/" target="_blank" rel="external">Cygwin 安装  基本使用 交叉编译vivi kernel</a></li>
<li><a href="http://www.360doc.com/content/12/0929/14/5013584_238783155.shtml" target="_blank" rel="external">在cygwin中安装gcc编译器</a></li>
</ul>
</li>
<li>卸载, 因为权限问题, Cygwin卸载很麻烦. 可以参考两篇文章, 已经是最简单的方法了<ul>
<li><a href="http://blog.csdn.net/yelangjueqi/article/details/45199209" target="_blank" rel="external">window 下完全卸载Cygwin最简单方法</a>, 就是在运行一次 <code>setup.exe</code> 来卸载</li>
<li><a href="http://blog.163.com/zhuandi_h/blog/static/180270288201282204521376/" target="_blank" rel="external">Win7 完全删除cygwin（本人已删除成功）</a></li>
</ul>
</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-自定义环境变量]]></title>
      <url>https://draapho.github.io/2016/10/09/1608-WinSoft-path/</url>
      <content type="html"><![CDATA[<h1 id="自定义环境变量"><a href="#自定义环境变量" class="headerlink" title="自定义环境变量"></a>自定义环境变量</h1><ul>
<li>测试过几个例子, 简单的调用没问题, 但带参调用就会有各种无法预料的问题.</li>
<li><code>ConEmu.lnk</code> 后面不支持带参数, <code>git-cmd.lnk</code> 支持带参, 但有奇怪现象.</li>
<li><code>Typora.lnk</code> <code>zeal.lnk</code> 没有问题.</li>
<li>使用此方法可以配合 <code>win-r</code> 快速打开文件夹, 软件等功能! 我没有使用, 因为有更好的替代方案.</li>
<li>!!!注意!!!, 带参调用 <code>.lnk</code> 不完全等同于 <code>.exe</code>, 还是没有linux的链接来的便捷</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul>
<li>做软件开发是绕不过环境变量 <code>PATH</code> 的设置的, 经常到后来 <code>PATH</code> 就变得非常长, 难以管理维护.</li>
<li>借助linux链接的概念, 实验了一下windows的快捷方式是否也可以用命令行执行, 发现是可行的!</li>
<li>譬如创建 <code>ConEmu.exe</code> 的快捷方式 <code>ConEmu.lnk</code> (.lnk不会显示). 此时, 在cmd内执行 <code>ConEmu.lnk</code> 等同于执行 <code>ConEmu.exe</code></li>
<li>这样, 就有办法简化自定义 <code>PATH</code> 的数量了, 只需添加一个用户路径到 <code>PATH</code> 中, 如<code>D:\Green\userpath\bin</code>, 然后把用户软件的 <code>.exe</code> 和 <code>.lnk</code> 放到这个目录下面就可以了.</li>
</ul>
<h2 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h2><ul>
<li>譬如, 配置 <code>D:\Green\cli\bin</code> 到环境变量中.</li>
<li><code>我的电脑</code>-&gt;右键<code>属性</code> 或者 <code>控制面板</code>-&gt;<code>系统和安全</code>-&gt;<code>系统</code>-&gt;<code>高级系统设置</code></li>
<li>弹出 <code>系统属性</code> 页面-&gt;<code>高级</code> 标签-&gt;最下面 <code>环境变量...</code>-&gt;<code>系统变量</code>-&gt;<code>Path</code>-&gt;加入自定义路径如 <code>D:\Green\cli\bin</code>, windows7的话需要分隔符<code>;</code></li>
<li><code>D:\Green\cli\bin</code> 只是个例子, 可以自己规定任意一个文件夹, 便于记忆即可.</li>
</ul>
<h2 id="添加软件"><a href="#添加软件" class="headerlink" title="添加软件"></a>添加软件</h2><ul>
<li>MinGW, windows下提供 gnu 工具链, 像linux下一样使用 make 编译即可<br>把 <code>.\MinGW\bin</code> 下的所有文件复制一份到 <code>D:\Green\cli\bin</code> 即可</li>
<li>Pandoc, 格式转换软件. 众多markdown编辑器需要此软件来转换格式<br>把 <code>pandoc.exe</code> 和 <code>pandoc-citeproc.exe</code> 复制一份到 <code>D:\Green\cli\bin</code> 即可</li>
<li>putty, ssh和串口终端软件, 多用于远程连接<br><del>putty所有文件复制一份到 <code>D:\Green\cli\bin</code></del>, 放个 <code>putty.exe</code> 即可</li>
<li>uncrustify, 编程语言格式化软件. 可格式化 c, c++, d, java 等众多语言<br>把 <code>uncrustify.exe</code> 复制到 <code>D:\Green\cli\bin</code> 即可</li>
<li>下述软件创建快捷方式, 然后放到 <code>D:\Green\cli\bin</code> 即可</li>
<li><del><code>ConEmu.lnk</code></del> 模拟终端软件, 可整合多种终端如cmd, shell, bash, putty</li>
<li><del><code>Cygwin.lnk</code></del> 模拟linux环境, 可以部分充当windows下的linux虚拟机使用</li>
<li><del><code>git-cmd.lnk</code></del> 启动git, 供ConEmu调用</li>
<li><code>Typora.lnk</code> 一款markdown编辑器</li>
<li><code>zeal.lnk</code> 软件API离线查询工具, windows下的dash</li>
</ul>
<h2 id="便捷性"><a href="#便捷性" class="headerlink" title="便捷性"></a>便捷性</h2><ul>
<li>上述软件主要是辅助作用, 我会在常用软件中调用上述软件. 如notepad++, atom, ConEmu中</li>
<li>以 notepad++ 调用 <code>zeal.lnk</code> 为例.</li>
<li><code>notepad++</code>-&gt;<code>Run</code>-&gt;<code>Run...</code>-&gt;输入 <code>zeal.lnk $(CURRENT_WORD)</code>-&gt;<code>Save...</code>-&gt;<code>Name:``help</code>, 快捷键<code>F1</code>-&gt;<code>OK</code></li>
<li>配置好以后, 写代码遇到需要查询的地方, 只要选中关键词, 按 <code>F1</code> 就会自动调用 zeal 了</li>
<li>以后环境变了, 只需要重新创建一下 <code>zeal.lnk</code> 然后放到 <code>D:\Green\userpath\bin</code> 即可.</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows快捷键]]></title>
      <url>https://draapho.github.io/2016/10/08/1607-CheatSheet-win/</url>
      <content type="html"><![CDATA[<h1 id="专用快捷键"><a href="#专用快捷键" class="headerlink" title="专用快捷键"></a>专用快捷键</h1><table>
<thead>
<tr>
<th>atom</th>
<th>备注</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ctrl-shift-p</code></td>
<td>palette</td>
<td>调出命令板</td>
</tr>
<tr>
<td><code>ctrl-alt-i</code></td>
<td>information</td>
<td>调用控制台</td>
</tr>
<tr>
<td><code>ctrl-,</code></td>
<td></td>
<td>打开设置面板</td>
</tr>
<tr>
<td><code>ctrl-.</code></td>
<td>非编辑区有效</td>
<td>调试快捷键</td>
</tr>
<tr>
<td>+<code>ctrl-f6</code></td>
<td>merge-conflicts</td>
<td>显示有冲突的文件</td>
</tr>
<tr>
<td>+<code>shift-f6</code></td>
<td>merge-conflicts</td>
<td>显示下一个冲突</td>
</tr>
<tr>
<td>+<code>ctrl-shift-f6</code></td>
<td>merge-conflicts</td>
<td>显示上一个冲突</td>
</tr>
<tr>
<td><strong>eclipse</strong></td>
<td><strong>备注</strong></td>
<td><strong>说明</strong></td>
</tr>
<tr>
<td><code>ctrl-o</code></td>
<td></td>
<td>显示函数列表</td>
</tr>
<tr>
<td><code>ctrl-shift-o</code></td>
<td></td>
<td>自动处理 include/import</td>
</tr>
<tr>
<td><code>alt-shift-s</code></td>
<td>source</td>
<td>显示代码常用操作</td>
</tr>
<tr>
<td><code>alt-/</code></td>
<td></td>
<td>代码提示</td>
</tr>
<tr>
<td>+ <code>ctrl \</code></td>
<td><del><code>ctrl-tab</code></del></td>
<td>切换<code>.c``.h</code>文件</td>
</tr>
<tr>
<td>+ <code>alt-\</code></td>
<td><code>alt-shift-a</code></td>
<td>列选模式</td>
</tr>
<tr>
<td>+ <code>ctrl-f3</code></td>
<td><code>ctrl-1</code></td>
<td>快速修复</td>
</tr>
<tr>
<td>+ <code>alt-shift-f</code></td>
<td><code>ctrl-shift-t</code></td>
<td>查找类</td>
</tr>
</tbody>
</table>
<h1 id="编辑器快捷键"><a href="#编辑器快捷键" class="headerlink" title="编辑器快捷键"></a>编辑器快捷键</h1><table>
<thead>
<tr>
<th>文件操作</th>
<th>助记</th>
<th>说明</th>
<th>来源</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ctrl-n</code></td>
<td>new</td>
<td>创建文件</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-o</code></td>
<td>open</td>
<td>打开文件</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-s</code></td>
<td>save</td>
<td>保存</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-shift-s</code></td>
<td>save</td>
<td>保存所有</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>ctrl-w</code></td>
<td>windows</td>
<td>关闭当前页</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-shift-w</code></td>
<td>windows</td>
<td>关闭其它页面</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-shift-t</code></td>
<td>tags</td>
<td>恢复关闭的文件</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>ctrl-tab</code></td>
<td>tab</td>
<td>下一个标签</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>ctrl-shift-tab</code></td>
<td>tab</td>
<td>上一个标签</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>f1</code></td>
<td></td>
<td>help</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-f1</code></td>
<td></td>
<td>google搜索选定内容</td>
<td>custom</td>
</tr>
<tr>
<td><strong>文件编辑</strong></td>
<td><strong>助记</strong></td>
<td><strong>说明</strong></td>
<td><strong>来源</strong></td>
</tr>
<tr>
<td><code>ctrl-a</code></td>
<td>all</td>
<td>全部选中</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-c</code></td>
<td>copy</td>
<td>复制</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-shift-c</code></td>
<td>copy</td>
<td>复制文档路径</td>
<td>atom</td>
</tr>
<tr>
<td><code>ctrl-d</code></td>
<td>delete</td>
<td>删除</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-shift-d</code></td>
<td>delete</td>
<td>删除当前行</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-</code> <code>h</code> <code>j</code> <code>k</code> <code>l</code></td>
<td>vim</td>
<td>上下左右</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-shift-h</code> <code>ctrl-←</code></td>
<td>vim h</td>
<td>左移到词首</td>
<td>custom / sublime</td>
</tr>
<tr>
<td><code>ctrl-shift-l</code> <code>ctrl-→</code></td>
<td>vim l</td>
<td>右移到词尾</td>
<td>custom / sublime</td>
</tr>
<tr>
<td><code>ctrl-shift-j</code> <code>ctrl-↓</code></td>
<td>vim j</td>
<td>向下移行</td>
<td>custom / sublime</td>
</tr>
<tr>
<td><code>ctrl-shift-k</code> <code>ctrl-↑</code></td>
<td>vim k</td>
<td>向上移行</td>
<td>custom / sublime</td>
</tr>
<tr>
<td><code>alt-shift-j</code></td>
<td>vim J</td>
<td>合并行</td>
<td>custom</td>
</tr>
<tr>
<td><del><code>ctrl-t</code></del></td>
<td>禁用掉</td>
<td>避免<code>ctrl-y</code>失效</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-v</code></td>
<td>velcro</td>
<td>黏贴</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-shift-v</code></td>
<td>ctrl-v</td>
<td>复制当前行</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-x</code></td>
<td></td>
<td>剪切</td>
<td>windows</td>
</tr>
<tr>
<td><code>ctrl-shift-x</code></td>
<td>ctrl-x</td>
<td>剪切当前行</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>ctrl-y</code> <code>ctrl-r</code></td>
<td>redo</td>
<td>恢复更改</td>
<td>windows / vim</td>
</tr>
<tr>
<td><code>ctrl-z</code> <code>ctrl-u</code></td>
<td>undo</td>
<td>撤销更改</td>
<td>windows / vim</td>
</tr>
<tr>
<td><code>ctrl-shift-y</code></td>
<td></td>
<td>下一个浏览记录</td>
<td>custom</td>
</tr>
<tr>
<td><code>ctrl-shift-z</code></td>
<td></td>
<td>上一个浏览记录</td>
<td>custom</td>
</tr>
</tbody>
</table>
<p>| <code>alt-鼠标</code> <code>alt-\</code>        |          | 列选模式          | notepad++ / custom |<br>| <code>ctrl-enter</code>            | enter    | 下面新增一行        | sublime            |<br>| <code>ctrl-shift-enter</code>      | enter    | 上面新增一行        | sublime            |<br>| <code>tab</code> <code>shift-tab</code>       |          | 插入缩进/删除缩进     | notepad++          |<br>| <code>ctrl-^</code>                | vim      | 移到行首          | custom             |<br>| <code>ctrl-shift-^</code>          | vim      | 选到行首          | custom             |<br>| <code>ctrl-$</code>                | vim      | 移到行尾          | custom             |<br>| <code>ctrl-shift-$</code>          | vim      | 选到行尾          | custom             |<br>| <strong>查找与替换</strong>               | <strong>助记</strong>   | <strong>说明</strong>        | <strong>来源</strong>             |<br>| <code>ctrl-f</code>                | find     | 查找            | windows            |<br>| <code>ctrl-shift-f</code>          | find     | 多文件查找         | sublime            |<br>| <code>f3</code> <code>shift-f3</code>         |          | 查找下一个 / 查找上一个 | windows            |<br>| <code>ctrl-f3</code>               |          | 选中所有匹配的关键字    | custom             |<br>| <code>ctrl-m</code>                | mark     | 打标记           | custom             |<br>| <code>f2</code> <code>shift-f2</code>         | tag      | 下一个标记/上一个标记   | notepad++          |<br>| <code>ctrl-f2</code>               | tag      | 显示所有标签        | custom             |<br>| <code>ctrl-shift-f2</code>         | tag      | 清空所有标签        | custom             |<br>| <code>ctrl-.</code>                | ..       | TAB转为空格       | custom             |<br>| <code>ctrl-shift-.</code>          | &gt;&gt;       | 空格转为TAB       | custom             |<br>| <strong>代码专用</strong>                | <strong>助记</strong>   | <strong>说明</strong>        | <strong>来源</strong>             |<br>| <code>ctrl-b</code>                | beautify | 格式化代码         | custom             |<br>| <code>ctrl-shift-m</code>          | markdown | markdown预览    | atom               |<br>| <code>alt-0</code> <code>alt-shift-0</code>   | 0-9      | 折叠代码/展开代码     | notepad++          |<br>| <code>ctrl-[</code> <code>ctrl-]</code>       |          | 移动/全选对应括号     | custom             |<br>| <code>ctrl-鼠标</code> <code>shift-鼠标</code>    |          | 跳转            | eclipse / custom   |<br>| <code>f4</code> <code>shift-f4</code>         |          | 跳转 / 跳回       | custom             |<br>| <code>f5</code>                    | run      | 运行            | notepad++          |<br>| <code>f6</code>                    |          | 比较文件          | custom             |<br>| <code>ctrl-/</code>                | <code>//</code>     | 单行注释翻转        | eclipse            |<br>| <code>ctrl-shift-/</code>          | <code>/*</code>     | 多行注释          | eclipse            |<br>| <code>ctrl-shift-\</code>          | <code>/*</code>     | 取消多行注释        | eclipse            |<br>| <code>ctrl-~</code>                |          | 打开终端          | sublime            |</p>
<h1 id="Win系统快捷键"><a href="#Win系统快捷键" class="headerlink" title="Win系统快捷键"></a>Win系统快捷键</h1><table>
<thead>
<tr>
<th>Listary</th>
<th>助记</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>win-~</code></td>
<td></td>
<td>打开Listary</td>
</tr>
<tr>
<td><code>enter</code></td>
<td>enter</td>
<td>打开文件</td>
</tr>
<tr>
<td><code>ctrl-enter</code></td>
<td>enter</td>
<td>打开路径</td>
</tr>
<tr>
<td><code>ctrl-c</code></td>
<td>copy</td>
<td>复制</td>
</tr>
<tr>
<td><code>ctrl-shift-c</code></td>
<td>copy</td>
<td>复制路径</td>
</tr>
<tr>
<td><code>ctrl+j</code> <code>ctrl+k</code></td>
<td>vim j,k</td>
<td>下一个 / 上一个(需设置)</td>
</tr>
<tr>
<td><strong>Ditto</strong></td>
<td><strong>助记</strong></td>
<td><strong>文件夹/应用</strong></td>
</tr>
<tr>
<td><code>ctrl-q</code></td>
<td>quick paste</td>
<td>打开ditto面板</td>
</tr>
<tr>
<td><code>enter</code></td>
<td>enter</td>
<td>黏贴</td>
</tr>
<tr>
<td><code>shift-enter</code></td>
<td>enter</td>
<td>纯文本黏贴</td>
</tr>
<tr>
<td><strong>AHK</strong></td>
<td><strong>助记</strong></td>
<td><strong>功能</strong></td>
</tr>
<tr>
<td><code>鼠标中键</code></td>
<td></td>
<td>复制</td>
</tr>
<tr>
<td><code>shift-鼠标中键</code></td>
<td></td>
<td>剪切</td>
</tr>
<tr>
<td><code>ctrl-shift-鼠标中键</code></td>
<td></td>
<td>复制当前路径</td>
</tr>
<tr>
<td><code>鼠标右键</code></td>
<td></td>
<td>首次黏贴</td>
</tr>
<tr>
<td><code>ctrl-鼠标右键</code></td>
<td></td>
<td>黏贴</td>
</tr>
<tr>
<td><code>ctrl-~</code></td>
<td></td>
<td>打开终端 (关联路径)</td>
</tr>
<tr>
<td><code>alt-win-鼠标中键</code></td>
<td></td>
<td>复制屏幕颜色</td>
</tr>
<tr>
<td><code>alt-win-←↑↓→</code></td>
<td></td>
<td>单像素移动鼠标</td>
</tr>
<tr>
<td><code>alt-win-d</code></td>
<td>date</td>
<td>输入当前日期</td>
</tr>
<tr>
<td><strong>AHK快捷方式</strong></td>
<td><strong>助记</strong></td>
<td><strong>文件夹/应用</strong></td>
</tr>
<tr>
<td><code>alt-a</code> <code>win-a</code></td>
<td>all / audio</td>
<td>我的电脑 / 音频处理软件</td>
</tr>
<tr>
<td><code>alt-b</code> <code>win-b</code></td>
<td>backup</td>
<td>backup / FreeFileSync</td>
</tr>
<tr>
<td><code>alt-c</code> <code>win-c</code></td>
<td>c盘 / caculate</td>
<td>c盘 / 计算器</td>
</tr>
<tr>
<td><code>alt-d</code> <code>win-d</code></td>
<td>download</td>
<td>download / 迅雷</td>
</tr>
<tr>
<td><code>alt-e</code> <code>win-e</code></td>
<td>e盘 / editor</td>
<td>e盘 / 编辑器</td>
</tr>
<tr>
<td><code>alt-f</code> <code>win-f</code></td>
<td>f盘 / find</td>
<td>f盘 / everything</td>
</tr>
<tr>
<td><code>alt-g</code> <code>win-g</code></td>
<td>green / google</td>
<td>绿色软件 / 浏览器</td>
</tr>
<tr>
<td><code>win-h</code></td>
<td>help</td>
<td>zeal 文档帮助</td>
</tr>
<tr>
<td><code>win-i</code></td>
<td>ie</td>
<td>IE核浏览器</td>
</tr>
<tr>
<td><code>win-j</code></td>
<td>记账</td>
<td>MoneyHome</td>
</tr>
<tr>
<td><code>alt-l</code> <code>win-l</code></td>
<td>life / look</td>
<td>life / 视频搜索</td>
</tr>
<tr>
<td><code>alt-m</code> <code>win-m</code></td>
<td>music</td>
<td>music / mcool</td>
</tr>
<tr>
<td><code>win-n</code></td>
<td>notepad</td>
<td>notepad++</td>
</tr>
<tr>
<td><code>alt-p</code> <code>win-p</code></td>
<td>picture</td>
<td>picture / Paint.Net</td>
</tr>
<tr>
<td><code>alt-s</code> <code>win-s</code></td>
<td>study / ScreenShot</td>
<td>study / 截屏</td>
</tr>
<tr>
<td><code>alt-v</code> <code>win-v</code></td>
<td>video</td>
<td>video / PotPlayer</td>
</tr>
<tr>
<td><code>alt-w</code> <code>win-w</code></td>
<td>work / word</td>
<td>work / word</td>
</tr>
<tr>
<td><code>win-x</code></td>
<td>虚拟机</td>
<td>Hyper-V</td>
</tr>
<tr>
<td><code>alt-y</code> <code>win-y</code></td>
<td>移动硬盘 / 翻译</td>
<td>y盘 / 有道词典</td>
</tr>
<tr>
<td><code>win-z</code></td>
<td>证券</td>
<td>证券</td>
</tr>
</tbody>
</table>
<h1 id="大致原则"><a href="#大致原则" class="headerlink" title="大致原则"></a>大致原则</h1><ul>
<li><code>ctrl</code> 基本操作</li>
<li><code>shift</code> 反向操作/块操作</li>
<li><code>alt</code> 处理文件-AHK使用</li>
<li><code>win</code> 打开应用-AHK使用</li>
<li><code>alt-win</code> 特殊应用-AHK使用</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-基于NFS的家庭网]]></title>
      <url>https://draapho.github.io/2016/10/03/1606-WinSoft-cloud/</url>
      <content type="html"><![CDATA[<h1 id="家庭网设想"><a href="#家庭网设想" class="headerlink" title="家庭网设想"></a>家庭网设想</h1><h2 id="理想的云"><a href="#理想的云" class="headerlink" title="理想的云"></a>理想的云</h2><ul>
<li>理想的家庭网是由NAS做数据中心, 是家里的云</li>
<li>需要使用千兆网来支持数据分享(如视频流)</li>
<li>考虑到设备多样性, 可使用多种分享模式, 如NFS, windows共享服务等等</li>
<li>理想很丰满, 现实很骨干. 由于预算, 稳定性, 易用性等问题, 多半会用折中方案</li>
<li>可以看看混乱的方案推荐: <a href="https://www.zhihu.com/question/20791825" target="_blank" rel="external">如何实现一个简单的家庭云存储（NAS）系统？</a></li>
</ul>
<h2 id="现实的云"><a href="#现实的云" class="headerlink" title="现实的云"></a>现实的云</h2><ul>
<li>理想之所以遥远, 往往是因为没有明确需求, 导致什么都想要! 所以, 先明确需求<ul>
<li>NAS是用来折腾和看电影的(电影存在硬盘上, 能在沙发上和床上观影).</li>
<li>日常资料还是存储在本地硬盘比较便捷</li>
<li>有安全需求, 要备份或镜像本地资料到家庭云(<strong>双设备备份</strong>, 相比NAS的各种RAID, 一大优势是<strong>防偷</strong>)</li>
<li>做嵌入式开发, 需要在windows上装linux虚拟机, 然后数据共享</li>
<li>关键数据出问题时, 在可靠和有把握的环境下来恢复数据.</li>
</ul>
</li>
<li>给出最终使用的方案. 折腾记就不写在此文了.<ul>
<li>使用 Intel NUC 作为桌面主机和云服务器. 小巧, 够用(不玩游戏), 省电.</li>
<li>使用 Hyper-V 安装 家用NAS 和 Ubuntu.</li>
<li>另有嵌入式linux开发板, 投影仪, 手机等设备需要和云交换数据.</li>
<li>使用 <a href="https://www.hanewin.net/nfs-e.htm" target="_blank" rel="external">HaneWIN</a> 向其它设备提供NFS服务</li>
<li>使用 <a href="http://www.freefilesync.org/" target="_blank" rel="external">freefilesync</a> 备份资料到移动硬盘(和理想中的备份方式差好多…)</li>
</ul>
</li>
</ul>
<h1 id="HaneWIN"><a href="#HaneWIN" class="headerlink" title="HaneWIN"></a><a href="https://www.hanewin.net/nfs-e.htm" target="_blank" rel="external">HaneWIN</a></h1><ul>
<li><a href="https://www.hanewin.net/nfs-e.htm" target="_blank" rel="external">HaneWIN</a>是收费软件, 个人用户收费 EUR 19.80. 只需简单功能可尝试免费的 <a href="http://freenfs.sourceforge.net/" target="_blank" rel="external">Free NFS</a></li>
<li>需要支持嵌入式linux端的NFS(只支持NFS v2), 配置见图:<br><img src="https://draapho.github.io/images/1606/haneWIN_NFS.PNG" alt="haneWIN_NFS"></li>
<li>务必使用<code>UTF-8 character set</code><br><img src="https://draapho.github.io/images/1606/haneWIN_Server.PNG" alt="haneWIN_Server"></li>
<li><p>重点说一下<code>Exports</code>这一块, 即把文件通过NFS分享出去.<br><img src="https://draapho.github.io/images/1606/haneWIN_Exports.PNG" alt="haneWIN_Exports"></p>
<ul>
<li><code>E:\Downloads -name:Downloads 10.0.0.99</code><br>就是把本地<code>Downloads</code>文件夹分享给<code>ip=10.0.0.99</code>的机器, 对外名称为<code>Downloads</code></li>
<li><code>-mapall:0:0</code> 是提供给linux端root权限. (这句最短? 花了一周时间才实验成功啊…)</li>
<li><code>-range 10.0.0.1 10.0.0.111</code> 是设置ip范围, 这里是从<code>10.0.0.1</code>-<code>10.0.0.111</code></li>
<li><p>语法规则不多, 详见<a href="https://www.hanewin.net/doc/nfs/nfsd.htm" target="_blank" rel="external">官网说明</a>. 可用参数如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># The following options are supported:</div><div class="line">-name:&lt;sharename&gt;   assigns a name to the exported path as an alternate name for mounting.</div><div class="line">-alldirs    allows the host(s) to mount at any point within the filesystem.</div><div class="line">-umask:&lt;mask&gt;   set the umask for group and world permissions on the filesystem, default 022</div><div class="line">-readonly   limits access to reading</div><div class="line">-public Enables WebNFS access.</div><div class="line">-lowercase  maps all file names to lowercase, otherwise case is preserved.</div><div class="line">-exec   forces in access rights the x bit for all files.</div><div class="line">-mapall:&lt;uid&gt;[:&lt;gid&gt;]   all Unix user-ids and group-ids are mapped to the specified user-id and group-id.</div><div class="line">-maproot:&lt;uid&gt;[:&lt;gid&gt;]  the Unix super user root is mapped to the specified user-id, group-id. Without a mapping entry root will be mapped to user and group nobody.</div><div class="line">-range  IP adresses are interpreted in pairs as from-to ranges enabling client access from all addresses in a range (more flexible than the unix -net -mask options).</div></pre></td></tr></table></figure>
</li>
<li><p>再举几个例子:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># exports example</div><div class="line">c:\ftp -range 192.168.1.1 192.168.1.10</div><div class="line">c:\public -public -readonly</div><div class="line">c:\tools -readonly 192.168.1.4</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果NFS被成功加载, 那么会在<code>Mounts</code>页显示出来<br><img src="https://draapho.github.io/images/1606/haneWIN_Mounts.PNG" alt="haneWIN_Mounts"></p>
</li>
<li>参考<ul>
<li><a href="http://www.nasyun.com/thread-25086-1-1.html" target="_blank" rel="external">GEN8折腾日记-第三方NFS工具 hanewin 设置(需登录)</a></li>
<li><a href="http://wenku.baidu.com/view/c78baefefad6195f302ba665.html" target="_blank" rel="external">GEN8折腾日记-第三方NFS工具 hanewin 设置(百度文库)</a></li>
<li><a href="https://www.chiphell.com/thread-1240623-1-1.html" target="_blank" rel="external">群晖加载Windows NFS文件</a></li>
</ul>
</li>
</ul>
<h1 id="Hyper-V"><a href="#Hyper-V" class="headerlink" title="Hyper-V"></a>Hyper-V</h1><ul>
<li>从Win8开始, Hyper-V是Windows自带的软件.</li>
<li>启用Hper-V, <code>控制面板</code>-&gt;<code>程序和功能</code>-&gt;<code>启用或关闭Windows功能</code>-&gt;<code>Hyper-V</code><br><img src="https://draapho.github.io/images/1606/HyperV_Enable.PNG" alt="HyperV_Enable"></li>
<li>设置虚拟网络<br><img src="https://draapho.github.io/images/1606/HyperV_NIC1.PNG" alt="HyperV_NIC1"><br><img src="https://draapho.github.io/images/1606/HyperV_NIC2.PNG" alt="HyperV_NIC2"></li>
<li>新建虚拟机<br><img src="https://draapho.github.io/images/1606/HyperV_Install1.png" alt="HyperV_Install1"><br><img src="https://draapho.github.io/images/1606/HyperV_Install2.png" alt="HyperV_Install2"><br><img src="https://draapho.github.io/images/1606/HyperV_Install3.png" alt="HyperV_Install3"></li>
<li>安装Ubuntu 32位服务器版本, 用于交叉编译. (另一个备选方案是用cygwin)</li>
<li>安装家用NAS, 用于多设备(投影仪, 平板, 手机)看硬盘上的影片.</li>
</ul>
<h1 id="NAS和智能路由器"><a href="#NAS和智能路由器" class="headerlink" title="NAS和智能路由器"></a>NAS和智能路由器</h1><h2 id="两者的区别"><a href="#两者的区别" class="headerlink" title="两者的区别"></a>两者的区别</h2><ul>
<li>NAS, Network Attached Storage. 家用的话, 大多定位于多媒体观赏和数据备份两个核心功能.</li>
<li>专做NAS的厂家, <a href="https://www.synology.com/" target="_blank" rel="external">Synology(群晖)</a> 和 <a href="https://www.qnap.com/" target="_blank" rel="external">QNAP(威联通)</a> 比较有名</li>
<li>智能路由器, 从小米路由器到airport extreme.</li>
<li>两者区别的话, 就是一个更专业, 一个更娱乐.<br>所谓专业, 就是更多的权限设置和管理(对用户不友好), 更多的功能, 更高的安全要求.<br>所谓娱乐, 就是傻瓜易上手, 能用好用为主要需求.<br>简而言之, 一个是专业单反, 一个是傻瓜机, 然后有一些就是处于中间位置的微单…</li>
</ul>
<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><ul>
<li>大多数的家庭, 对此类产品的第一要求就是<strong>好用</strong>. 只有Geek一类的人需要<strong>好玩</strong>.</li>
<li>NAS在宣传上, 必然会强调数据安全, 列出诸如支持多种RAID这种让非专业人士云里雾里的概念.</li>
<li>而普通家庭最大的数据安全问题就是数据过于集中, 防偷防意外损坏之类的风险防范反而不足了.</li>
<li>因此, 家用云市场应该侧重于易于配置和使用. 家庭的数据安全问题不是靠一台专业NAS设备就能解决的.</li>
<li>结论: 在家用市场, 智能路由器有更好的市场前景.</li>
</ul>
<h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><ul>
<li>家庭环境的话, 建议用移动硬盘备份关键资料(即RAID1), 然后分开存储, 当然也可以基于SFTP等服务自动备份. 这样可以做到物理上相对独立, 而且因为用的是RAID1, 数据出问题后的恢复也非常简单.</li>
<li>中小企业就需要用到稍微专业一点的NAS才比较好了. 话说, 很多本土企业对数据安全这一块很不上心啊…</li>
<li>推荐完全免费的同步软件<a href="http://www.freefilesync.org/" target="_blank" rel="external">freefilesync</a>, 买块硬盘, 家用足够了.</li>
</ul>
<h2 id="个人推荐"><a href="#个人推荐" class="headerlink" title="个人推荐"></a>个人推荐</h2><ul>
<li>听说过家庭云, 不知道具体需求, 买个便宜的小米路由器先体验体验.</li>
<li>苹果爱好者直接上 airport extreme, 二千元可以给手机平板太多额外的存储空间了.</li>
<li>想要玩NAS的, 可以先用虚拟机装了体验一下效果.</li>
<li>如果买专业的NAS, 推荐直接用企业入门级产品QNAP的<code>TS-251</code>或<code>TS-253 Pro</code>,内置虚拟机, 可玩性很高.</li>
<li>群晖的机器不太推荐, 因为数据的存储格式很奇怪, 万一出点问题自己一点办法也没有!</li>
<li>组装机也不是太推荐, 因为功耗美观服务都要考虑进去.</li>
</ul>
<h1 id="同步软件freefilesync"><a href="#同步软件freefilesync" class="headerlink" title="同步软件freefilesync"></a>同步软件<a href="http://www.freefilesync.org/" target="_blank" rel="external">freefilesync</a></h1><ul>
<li><a href="http://www.freefilesync.org/" target="_blank" rel="external">freefilesync</a>是一款完全免费的同步软件, 可以完全媲美GoodSync</li>
<li>支持sftp, 所以也可以通过网络自动备份数据</li>
<li>家庭用户使用RAID1, 即关键资料双硬盘完整备份, 然后分开存放就足够了.</li>
</ul>
<h1 id="远程开机"><a href="#远程开机" class="headerlink" title="远程开机"></a>远程开机</h1><p>如果是7x24小时开机当服务器用, 则不用考虑这一块. 远程开机是针对虚拟机和组装机用户说的.</p>
<h2 id="LAN唤醒"><a href="#LAN唤醒" class="headerlink" title="LAN唤醒"></a>LAN唤醒</h2><ul>
<li>LAN唤醒需要主板的支持, 不支持无线网络, 必须使用有线. 新一点的机器一般都能支持.</li>
<li>启用主板的WOL功能<ul>
<li>开机进入BIOS, 寻找<code>wake on lan``resume on lan``power on PME``power on by PCI-E device``Power on by Onboard LAN</code>等与电源管理和唤醒有关的选项并使能</li>
</ul>
</li>
<li>设置网卡驱动<ul>
<li><code>设备管理器</code>-&gt;<code>网络适配器</code>-&gt;选择有线网卡设备-&gt;右键<code>属性</code>-&gt;在<code>高级</code>和<code>电源管理</code>标签下-&gt;启用<code>唤醒模式``唤醒魔包``幻数据包``唤醒计算机</code>之类的选项</li>
</ul>
</li>
<li>配置 WIN10 WOL(Wake on Lan 远程唤醒) 最大的坑就是要关闭 “启用快速启动(推荐)”, 而默认是打开的. 另外, <ul>
<li><code>控制面板</code>-&gt;<code>硬件和声音</code>-&gt;<code>电源选项</code>-&gt;左边栏<code>选择电源按钮的功能</code>-&gt;弹出<code>系统设置</code>页面-&gt;<code>关机设置</code>-&gt;<del><code>启用快速启动(推荐)</code></del></li>
</ul>
</li>
<li>电脑非正常关机后, 是无法远程唤醒的.</li>
<li>建议分级测试.<ol>
<li>可以先确定bios配置正确. 配置好bios, 进入winPE之类的系统, 选择关机, 看WOL是否起作用.</li>
<li>然后进入win10配置网卡的相关选项, 然后让机器进入睡眠模式, 看WOL是否起作用.</li>
<li>最后win10关机, 测试WOL是否起作用.</li>
<li>“启用快速启动(推荐)”, 位于 控制面板\硬件和声音\电源选项\唤醒时需要密码(系统设置)\关机设置.</li>
<li>注意: bios设置内关于PCI节能的设置特别注意, 考虑全部关闭</li>
</ol>
</li>
<li>Android端WOL软件推荐. <code>Wake On LAN</code> 配置简单, 界面友好.</li>
<li>参考链接<ul>
<li><a href="https://www.teamviewer.com/zhCN/res/pdf/Teamviewer9-Manual-Wake-on-LAN-zhCN.pdf" target="_blank" rel="external">TeamViewer手册-LAN唤醒</a></li>
<li><a href="http://www.iplaysoft.com/wol.html" target="_blank" rel="external">WOL 网络唤醒远程开机设置方法教程 + 多款软件下载！(手机远程开启电脑)</a></li>
</ul>
</li>
</ul>
<h2 id="WAN远程唤醒"><a href="#WAN远程唤醒" class="headerlink" title="WAN远程唤醒"></a>WAN远程唤醒</h2><ul>
<li>WAN远程唤醒的前提是配置好LAN唤醒.</li>
<li>需要设置路由器, 设置过程非常复杂, 而且免费的不稳定.</li>
<li>我买了向日葵开机棒, 但实际体验不好. 一是向日葵的服务器不太稳定, 而是远程操作意义不大, 纯玩性质.</li>
<li>所以, 建议普通用户不用折腾这块了. 真有异地工作, 资料同步的需求, 用公共云, github, BitBucket都很好.</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[stm32选型及资料搜索指南]]></title>
      <url>https://draapho.github.io/2016/10/01/1605-Stm32Selection/</url>
      <content type="html"><![CDATA[<h1 id="stm32选型及手册搜索"><a href="#stm32选型及手册搜索" class="headerlink" title="stm32选型及手册搜索"></a>stm32选型及手册搜索</h1><ul>
<li>进入搜索网页<a href="http://www.st.com/content/st_com/en/products/microcontrollers.html" target="_blank" rel="external">STM选型</a></li>
<li>在搜索框输入指定型号, 点击进入具体型号的页面. 如<a href="http://www.st.com/content/st_com/en/products/microcontrollers/stm32-32-bit-arm-cortex-mcus/stm32f1-series/stm32f103/stm32f103rc.html" target="_blank" rel="external">STM32F103RC</a></li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/datasheet/59/f6/fa/84/20/4e/4c/59/CD00191185.pdf/files/CD00191185.pdf/jcr:content/translations/en.CD00191185.pdf" target="_blank" rel="external">DS5792</a> -  <strong>DataSheet, 数据手册. 电气参数详解, 软硬件必备</strong></li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/reference_manual/59/b9/ba/7f/11/af/43/d5/CD00171190.pdf/files/CD00171190.pdf/jcr:content/translations/en.CD00171190.pdf" target="_blank" rel="external">RM0008</a> - <strong>Reference Manuals, 参考手册. 寄存器详解. 软件开发必备</strong></li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/application_note/a2/9c/07/d9/2a/b2/47/dc/CD00004479.pdf/files/CD00004479.pdf/jcr:content/translations/en.CD00004479.pdf" target="_blank" rel="external">AN1709</a> - <strong>Application Notes, 应用指南. 需要仔细看这类文档</strong>. 是针对具体问题的指南, 如这一篇是EMC设计指南</li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/programming_manual/10/98/e8/d4/2b/51/4b/f5/CD00283419.pdf/files/CD00283419.pdf/jcr:content/translations/en.CD00283419.pdf" target="_blank" rel="external">PM0075</a> - Programming Manuals, 烧录手册. 介绍擦写flash相关的流程和寄存器</li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/errata_sheet/f5/50/c9/46/56/db/4a/f6/CD00197763.pdf/files/CD00197763.pdf/jcr:content/translations/en.CD00197763.pdf" target="_blank" rel="external">ES0340</a> - Errata Sheets, 勘误表. 遇到非常奇怪的问题时, 可以先来看看勘误表, 是否源文件就是错的!</li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/technical_note/92/30/3c/a1/4c/bb/43/6f/DM00103228.pdf/files/DM00103228.pdf/jcr:content/translations/en.DM00103228.pdf" target="_blank" rel="external">TN1163</a> - Technical Notes &amp; Articles, 技术指南, 存储焊接, 开发工具配置之类的解答. <strong>生产必备</strong></li>
<li><a href="http://www.st.com/content/ccc/resource/technical/document/user_manual/f9/4a/8d/e6/b8/20/4a/46/DM00062592.pdf/files/DM00062592.pdf/jcr:content/translations/en.DM00062592.pdf" target="_blank" rel="external">UM1561</a> - User Manuals, 对官方开发板或开发工具的用户说明书</li>
</ul>
<h1 id="其它设计资料的搜索"><a href="#其它设计资料的搜索" class="headerlink" title="其它设计资料的搜索"></a>其它设计资料的搜索</h1><ul>
<li>根据型号并不能找出期望的文档. 譬如需要一份电源设计参考.</li>
<li>进去搜索网页<a href="http://www.st.com/content/st_com/en/products/microcontrollers.html" target="_blank" rel="external">STM选型</a></li>
<li>在搜索框输入关键词<code>hardware power</code>, 在搜索结果页面, 选择<code>Resouces</code>标签</li>
<li>这里第一条就是 <a href="http://www.st.com/content/ccc/resource/technical/document/application_note/87/b8/0f/5e/ab/d0/4f/2d/DM00071779.pdf/files/DM00071779.pdf/jcr:content/translations/en.DM00071779.pdf" target="_blank" rel="external">AN4218: Hardware design guideline power supply and voltage measurement</a></li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Vim常用快捷键]]></title>
      <url>https://draapho.github.io/2016/10/01/1604-CheatSheet-vim/</url>
      <content type="html"><![CDATA[<h1 id="Vim常用快捷键"><a href="#Vim常用快捷键" class="headerlink" title="Vim常用快捷键"></a>Vim常用快捷键</h1><h2 id="进入输入模式"><a href="#进入输入模式" class="headerlink" title="进入输入模式"></a>进入输入模式</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>i</code></td>
<td>insert</td>
<td>光标前插入文本</td>
</tr>
<tr>
<td><code>I</code></td>
<td>insert</td>
<td>行首插入文本</td>
</tr>
<tr>
<td><code>ea</code></td>
<td>end append</td>
<td>单词末插入文本</td>
</tr>
<tr>
<td><code>a</code></td>
<td>append</td>
<td>光标后插入文本</td>
</tr>
<tr>
<td><code>A</code></td>
<td>append</td>
<td>行尾插入文本</td>
</tr>
<tr>
<td><code>o</code></td>
<td>open new line</td>
<td>向下插入新行</td>
</tr>
<tr>
<td><code>O</code></td>
<td>open new line</td>
<td>向上插入新行</td>
</tr>
<tr>
<td><code>cw</code></td>
<td>change word</td>
<td>修改单词</td>
</tr>
<tr>
<td><code>cc</code></td>
<td>change</td>
<td>删除整行后修改</td>
</tr>
<tr>
<td><code>c^</code> <code>c$</code></td>
<td>change</td>
<td>删除到行首/行尾后修改</td>
</tr>
</tbody>
</table>
<h2 id="光标移动"><a href="#光标移动" class="headerlink" title="光标移动"></a>光标移动</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>h</code> <code>j</code> <code>k</code> <code>l</code></td>
<td></td>
<td>左/下/上/右</td>
</tr>
<tr>
<td><code>^</code> <code>0</code> <code>$</code></td>
<td></td>
<td>行首/首字母/行尾</td>
</tr>
<tr>
<td><code>w</code></td>
<td>word</td>
<td>下个字开头</td>
</tr>
<tr>
<td><code>e</code></td>
<td>end</td>
<td>本字结尾</td>
</tr>
<tr>
<td><code>b</code></td>
<td>before</td>
<td>上个字开头</td>
</tr>
<tr>
<td><code>fx</code></td>
<td>find+字符</td>
<td>移动到x字符处</td>
</tr>
<tr>
<td><code>5enter</code></td>
<td></td>
<td>向下移5行</td>
</tr>
<tr>
<td><code>gg</code> <code>1G</code></td>
<td>go</td>
<td>回首行</td>
</tr>
<tr>
<td><code>G</code></td>
<td>go</td>
<td>到末行</td>
</tr>
<tr>
<td><code>5G</code></td>
<td>num+go</td>
<td>到第5行</td>
</tr>
<tr>
<td><code>ctrl+u</code></td>
<td>up</td>
<td>向上翻半页</td>
</tr>
<tr>
<td><code>ctrl+d</code></td>
<td>down</td>
<td>向下翻半页</td>
</tr>
<tr>
<td><code>{</code> <code>}</code></td>
<td></td>
<td>块首/块尾</td>
</tr>
<tr>
<td><code>H</code></td>
<td>high</td>
<td>屏幕顶部</td>
</tr>
<tr>
<td><code>M</code></td>
<td>medium</td>
<td>屏幕中部</td>
</tr>
<tr>
<td><code>L</code></td>
<td>low</td>
<td>屏幕底部</td>
</tr>
</tbody>
</table>
<h2 id="文本编辑"><a href="#文本编辑" class="headerlink" title="文本编辑"></a>文本编辑</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>r</code></td>
<td>repalce</td>
<td>替换单个字符</td>
</tr>
<tr>
<td><code>~</code></td>
<td></td>
<td>改变字符大小写</td>
</tr>
<tr>
<td><code>x</code> <code>5x</code></td>
<td></td>
<td>删除字符</td>
</tr>
<tr>
<td><code>dw</code> <code>5dw</code></td>
<td>delete word</td>
<td>删除单词</td>
</tr>
<tr>
<td><code>db</code> <code>5db</code></td>
<td>delete befor</td>
<td>向前删除单词</td>
</tr>
<tr>
<td><code>dd</code> <code>5dd</code></td>
<td>delete</td>
<td>删除整行</td>
</tr>
<tr>
<td><code>d^</code> <code>d$</code></td>
<td>delete</td>
<td>删除到行首/行尾</td>
</tr>
<tr>
<td><code>d1G</code> <code>dG</code></td>
<td>delete</td>
<td>删除到第一行/最后一行</td>
</tr>
<tr>
<td><code>yw</code> <code>5yw</code></td>
<td>yank word</td>
<td>复制单词</td>
</tr>
<tr>
<td><code>yy</code> <code>5yy</code></td>
<td>yank</td>
<td>复制整行</td>
</tr>
<tr>
<td><code>y^</code> <code>y$</code></td>
<td>yank</td>
<td>复制到行首/行尾</td>
</tr>
<tr>
<td><code>&gt;&gt;</code> <code>&lt;&lt;</code></td>
<td></td>
<td>单行缩进</td>
</tr>
<tr>
<td><code>p</code> <code>P</code></td>
<td>paste</td>
<td>黏贴(光标后/光标前)</td>
</tr>
<tr>
<td><code>J</code></td>
<td>join</td>
<td>将下一行合并到当前行</td>
</tr>
<tr>
<td><code>u</code></td>
<td>undo</td>
<td>撤销更改/撤销输入</td>
</tr>
<tr>
<td><code>ctrl+r</code></td>
<td>redo</td>
<td>恢复</td>
</tr>
<tr>
<td><code>ctrl+r</code></td>
<td>redo</td>
<td>恢复</td>
</tr>
<tr>
<td><code>.</code></td>
<td></td>
<td>重复编辑动作</td>
</tr>
</tbody>
</table>
<h2 id="视图模式"><a href="#视图模式" class="headerlink" title="视图模式"></a>视图模式</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>v</code></td>
<td>visual</td>
<td>进入视图模式</td>
</tr>
<tr>
<td><code>&gt;</code> <code>&lt;</code></td>
<td></td>
<td>代码缩进</td>
</tr>
<tr>
<td><code>d</code> <code>y</code></td>
<td>delete yank</td>
<td>剪切/复制</td>
</tr>
<tr>
<td><code>~</code></td>
<td></td>
<td>改变大小写</td>
</tr>
</tbody>
</table>
<h2 id="查找与替换"><a href="#查找与替换" class="headerlink" title="查找与替换"></a>查找与替换</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/str</code></td>
<td></td>
<td>查找str</td>
</tr>
<tr>
<td><code>n</code> <code>N</code></td>
<td>next</td>
<td>查找下一个/上一个</td>
</tr>
<tr>
<td><code>:s/old/new/g</code></td>
<td>start…go</td>
<td>所在行old替换为new</td>
</tr>
<tr>
<td><code>:n1,n2s/old/new/g</code></td>
<td>start…go</td>
<td>n1-n2行old替换为new</td>
</tr>
<tr>
<td><code>:0,$/old/new/g</code></td>
<td>start…go</td>
<td>全文old替换为new</td>
</tr>
<tr>
<td><code>:%s/old/new/g</code></td>
<td>start…go</td>
<td>全文old替换为new</td>
</tr>
<tr>
<td><code>:n1,n2s/^/\/\//g</code></td>
<td><code>^</code> 行首 <code>/</code> 转义</td>
<td>行首替换为//, 即注释掉</td>
</tr>
</tbody>
</table>
<h2 id="保存与退出"><a href="#保存与退出" class="headerlink" title="保存与退出"></a>保存与退出</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>助记</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>esc</code></td>
<td></td>
<td>返回命令模式</td>
</tr>
<tr>
<td><code>:wq</code> <code>:wq!</code></td>
<td>write &amp; quit</td>
<td>保存并退出</td>
</tr>
<tr>
<td><code>:q</code> <code>:q!</code></td>
<td>quit  <code>!</code> sudo</td>
<td>退出</td>
</tr>
</tbody>
</table>
<h2 id="Vim-助记图-总有一款适合你"><a href="#Vim-助记图-总有一款适合你" class="headerlink" title="Vim 助记图, 总有一款适合你"></a>Vim 助记图, 总有一款适合你</h2><ul>
<li><p><a href="http://vim.rtorr.com/lang/zh_cn/" target="_blank" rel="external">中文版 Vim Cheat Sheet</a> 网页版, 支持多语言</p>
</li>
<li><p><a href="http://vimsheet.com/" target="_blank" rel="external">A Great Vim Cheat Sheet</a> 网页版</p>
</li>
<li><p><a href="http://www.viemu.com/a_vi_vim_graphical_cheat_sheet_tutorial.html" target="_blank" rel="external">Graphical vi-vim Cheat Sheet and Tutorial</a><br><img src="http://www.viemu.com/vi-vim-cheat-sheet.gif" alt="vi/vim graphical cheat sheet"></p>
</li>
<li><a href="http://vimcheatsheet.com/" target="_blank" rel="external">Beautiful Vim Cheat-Sheet</a><br><img src="https://cdn.shopify.com/s/files/1/0165/4168/files/preview.png" alt="Vim Cheat-Sheet Preview"></li>
<li><a href="https://www.gosquared.com/blog/vi-linux-terminal-help-sheet" target="_blank" rel="external">VI (Linux Terminal) Help Sheet</a><br><img src="https://downloads.gosquared.com/help_sheets/10/VI-Help-Sheet-large.jpg" alt="VI Help Sheet"></li>
<li><a href="http://blog.vgod.tw/2009/12/08/vim-cheat-sheet-for-programmers/" target="_blank" rel="external">給程式設計師的Vim入門圖解說明</a><br><img src="http://blog.vgod.tw.s3.amazonaws.com/wp-content/uploads/2009/12/vim-cheat-sheet-diagram.png" alt="Vim入門圖解說明"></li>
<li><a href="http://linux.vbird.org/linux_basic/0310vi.php" target="_blank" rel="external">vim极简中文示意图</a>-&gt;<code>9.3.6 vim 常用指令示意图</code><br><img src="https://draapho.github.io/images/1604/vimCheatSheet.jpg" alt="vim极简中文示意图"></li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-文本编辑]]></title>
      <url>https://draapho.github.io/2016/09/30/1603-WinSoft-editor/</url>
      <content type="html"><![CDATA[<h1 id="Notepad"><a href="#Notepad" class="headerlink" title="Notepad++"></a><a href="https://notepad-plus-plus.org/" target="_blank" rel="external">Notepad++</a></h1><h2 id="Npp简介"><a href="#Npp简介" class="headerlink" title="Npp简介"></a>Npp简介</h2><ul>
<li><a href="https://notepad-plus-plus.org/" target="_blank" rel="external">Notepad++</a>简称Npp, 是免费好用的记事本</li>
<li>轻便小巧, 打开速度快. 自带丰富功能且有插件, 如语法高亮</li>
<li>建议用他彻底替换windows自带的记事本</li>
<li>目前出到npp7, <strong>不要装64位版本</strong>, 很多插件都不支持</li>
<li>有绿色便携版, 但需要额外设置右键打开和文件关联功能</li>
</ul>
<h2 id="Npp设置"><a href="#Npp设置" class="headerlink" title="Npp设置"></a>Npp设置</h2><h3 id="首选项设置"><a href="#首选项设置" class="headerlink" title="首选项设置"></a>首选项设置</h3><ul>
<li><code>Setting</code>-&gt;<code>Preferences</code> 打开首选项页面</li>
<li><code>General</code>-&gt;<code>Double click to close document</code></li>
<li><code>Editing</code>-&gt;<code>Muli-Editing Setting</code>-&gt;<code>Enable (Ctrl...)</code></li>
<li><code>Editing</code>-&gt;<code>Vertical Edge Setting</code>-&gt;<code>Show vertical edge</code>-&gt;<code>Line mode</code>-&gt;<code>Number of columns: 80</code></li>
<li><code>File Association</code>-&gt;选择需要关联的文件后缀, 加入到<code>Registered extensions</code><br>关联其它后缀名, 只需在<code>customize</code>-&gt;填入后缀并加入, 如 <code>.config</code> <code>.gitignore</code><br>注意: <strong>绿色便携版设置了文件关联也是没有效果的</strong>, 用windows下右键<code>打开方式</code>设置吧</li>
<li><code>Tab Setting</code>-&gt;<code>[Default]</code>-&gt;<code>Tab size:4</code>-&gt;<code>Replace by space</code></li>
<li><code>Tab Setting</code>-&gt;<code>makefile</code>-&gt;<del><code>Use default value</code></del>-&gt;<del><code>Replace by space</code></del>, 因为make只认TAB键</li>
<li><code>Auto-Completion</code>-&gt;<code>Auto-Completion</code>-&gt;<code>From 2 th character</code></li>
<li><code>Auto-Completion</code>-&gt;<code>Auto-Insert</code>-&gt;<code>&#39;</code></li>
<li><code>Auto-Completion</code>-&gt;<code>Auto-Insert</code>-&gt;<code>html/xml close tag</code></li>
<li><del><code>Auto-Completion</code>-&gt;<code>Auto-Insert</code>-&gt;<code>Matched pair</code></del> 加入 <code>*</code> 和 <code>(即</code>~`键), !!!重启后失效, 原因不明.</li>
</ul>
<h3 id="主题设置"><a href="#主题设置" class="headerlink" title="主题设置"></a>主题设置</h3><ul>
<li><code>Settings</code>-&gt;<code>Style Configurator</code>-&gt;<code>Select theme</code>-&gt;<code>Twilight</code></li>
<li>对<code>Monokai</code>注释配色非常无语, 而且对python的配色也太不友好了, 只好放弃.</li>
</ul>
<h3 id="自定义语法高亮"><a href="#自定义语法高亮" class="headerlink" title="自定义语法高亮"></a>自定义语法高亮</h3><ul>
<li>以导入自定义的 markdown 语法高亮为例</li>
<li>可以去网上搜索<a href="https://github.com/draapho/Blog/tree/master/_blog_stuff/Notepad%2B%2B/markdown" target="_blank" rel="external">下载markdown语法高亮文件</a></li>
<li><code>Language</code>-&gt;<code>Define your language ...</code>-&gt;<code>Import</code>-&gt;选择下载的<code>markdown_*.xml</code>文件即可</li>
<li>导入成功后, <code>Language</code>-&gt;<code>Define your language ...</code>下面就会有markdown语言了</li>
</ul>
<h3 id="Npp插件"><a href="#Npp插件" class="headerlink" title="Npp插件"></a>Npp插件</h3><ul>
<li>插件的安装 (<strong>64位版本无法支持大多数插件</strong>)<ol>
<li><code>Plugins</code>-&gt;<code>Plugin Manager</code>-&gt;<code>Show Plugin Manager</code>-&gt;安装插件</li>
<li>将插件的<code>.dll</code>文件直接放到<code>plugins</code>目录下. (说明插件可以免安装)</li>
</ol>
</li>
<li><code>compare</code> 文件比较功能.<br>由于使用了深色主题, 需要使用深色作为背景<br><code>Plugins</code>-&gt;<code>compare</code>-&gt;<code>Option</code>-&gt;<code>Clolr setting</code>-&gt;点选颜色<code>More Colors</code> 调深即可</li>
<li><code>customize toolbar</code> 可自定义工具栏</li>
<li><code>File Switcher</code> 提供<code>ctrl+tab</code>在视图窗口切换标签的功能</li>
<li><code>Hex-Editor</code> 增加二进制编辑模式</li>
<li><code>Light Explorer</code> 增加资源管理器界面</li>
<li><code>Location Navigate</code> 浏览历史跳转<br>取消 <code>Mark Changed Line</code>, 配色看不清楚!</li>
<li><del><code>ViSimulator</code></del> vim模式, <code>ctrl+shift+alt+v</code> 使能或禁止. 可以从<a href="https://web.archive.org/web/20150515145616/http://www.visimulator.com/download.html" target="_blank" rel="external">这里下载</a></li>
<li><code>Zoom Disabler</code> 屏蔽ctrl+滚轮的缩放功能</li>
</ul>
<h2 id="Python-Script插件"><a href="#Python-Script插件" class="headerlink" title="Python Script插件"></a><a href="http://npppythonscript.sourceforge.net/index.shtml" target="_blank" rel="external">Python Script</a>插件</h2><ul>
<li><a href="http://npppythonscript.sourceforge.net/index.shtml" target="_blank" rel="external">Python Script</a>针对notepad++的python插件, 可以用来批量处理文件</li>
<li><a href="https://sourceforge.net/projects/npppythonscript/files/Python%20Script%201.0.8.0/" target="_blank" rel="external">下载最新版本1.0.8.0</a> <code>PythonScript_Full_1.0.8.0.zip</code> 即可</li>
<li><p>解压后将整个文件拷贝到notepad++的根目录下, 目录结构如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Notepad++ (Notepad++ 根目录, 例如&quot;C:\Program Files\npp&quot;)</div><div class="line"> +</div><div class="line"> |-- python26.dll</div><div class="line"> +-- plugins</div><div class="line">           |-- PythonScript.dll</div><div class="line">           |-- PythonScript</div><div class="line">           |   |-- lib</div><div class="line">           |   |     |-- (*.py)</div><div class="line">           |   |-- scripts</div><div class="line">           |             |-- (machine-level scripts)</div><div class="line">           |-- doc</div><div class="line">           |     |-- PythonScript</div><div class="line">           |             |-- PythonScript.chm</div><div class="line">           |-- Config (也可能在 %APPDATA%\Notepad++\plugins\config\)</div><div class="line">                         \-- PythonScript</div><div class="line">                                         |-- scripts</div><div class="line">                                                   |-- (用户脚本)</div></pre></td></tr></table></figure>
</li>
<li><p>检测是否安装成功. 重启notepad++. 按如下步骤进行测试<br><code>Plugins-&gt;Python Script</code>-&gt;<code>Show Console</code>-&gt;显示<code>Python ... Ready.</code></p>
</li>
<li><p><a href="https://github.com/draapho/Blog/tree/master/_blog_stuff/Notepad%2B%2B/Python%20Script" target="_blank" rel="external">一个实用的脚本示例</a>, <strong>注意</strong>, 需要使用Notepad++ 7及以上版本, 否则执行结果和预期会有差别.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os;</div><div class="line"><span class="keyword">import</span> sys;</div><div class="line"><span class="keyword">from</span> Npp <span class="keyword">import</span> *</div><div class="line"></div><div class="line"><span class="comment"># 对所有打开的文件去除行尾空格并将空格替换为TAB</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_menu_command</span><span class="params">()</span>:</span></div><div class="line">  <span class="comment"># Edit-&gt;Blank Operations</span></div><div class="line">  notepad.runMenuCommand(<span class="string">"Blank Operations"</span>, <span class="string">"Trim Trailing Space"</span>)</div><div class="line">  notepad.runMenuCommand(<span class="string">"Blank Operations"</span>, <span class="string">"Space to TAB (All)"</span>)</div><div class="line">  <span class="keyword">return</span></div><div class="line"></div><div class="line"><span class="comment"># Find and operate files opened at notepad</span></div><div class="line"><span class="comment"># There is something wrong run in NPP6.X</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">operate_file_in_notepad</span><span class="params">()</span>:</span></div><div class="line">  file_list = notepad.getFiles()</div><div class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> file_list:</div><div class="line">      fn = file[<span class="number">0</span>]</div><div class="line">      notepad.activateFile(fn)</div><div class="line">      run_menu_command()</div><div class="line"></div><div class="line">operate_file_in_notepad()</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="绿色版注册右键"><a href="#绿色版注册右键" class="headerlink" title="绿色版注册右键"></a>绿色版注册右键</h2><ul>
<li>基本思路是直接修改注册表, 增加右键<code>Notepad++ Here</code></li>
<li>写了批处理文件, 放到notepad++根目录, 管理员权限执行即可.<br><a href="https://github.com/draapho/Blog/blob/master/_blog_stuff/Notepad%2B%2B/_RegisterKey_Admin.bat" target="_blank" rel="external">_RegisterKey_Admin.bat</a> 注册右键, 需管理员权限执行.<br><a href="https://github.com/draapho/Blog/blob/master/_blog_stuff/Notepad%2B%2B/_UnregisterKey_Admin.bat" target="_blank" rel="external">_UnregisterKey_Admin.bat</a> 注销右键, 需管理员权限执行.</li>
<li>也可以手动创建文件 <code>注册右键.reg</code>, 内容如下.<br><strong>上述批处理的思路</strong>就是自动生成这个 <code>.reg</code> 文件然后导入注册表.<br><strong>需要替换notepad++安装路径</strong>. 然后管理员权限执行即可.<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_CLASSES_ROOT\*\Shell\NotePad++ Here]</div><div class="line">[HKEY_CLASSES_ROOT\*\Shell\NotePad++ Here\Command]</div><div class="line">@=&quot;\&quot;D:\\Program Files\\npp\\notepad++.exe\&quot; \&quot;%1\&quot;&quot;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="快捷键设置"><a href="#快捷键设置" class="headerlink" title="快捷键设置"></a>快捷键设置</h2><ul>
<li>需按照<a href="https://draapho.github.io/2016/10/08/1607-Shortcut-win/">编辑器快捷键</a>设置</li>
<li>设置好的<a href="https://github.com/draapho/Blog/tree/master/_blog_stuff/Notepad%2B%2B/shortcuts.xml" target="_blank" rel="external">快捷键配置文件</a>, 直接替换原有的shortcuts.xml即可</li>
<li>说明一下<code>run</code>的设置, 可参考官方说明<a href="http://docs.notepad-plus-plus.org/index.php/External_Programs" target="_blank" rel="external">Notepad++调用外部程序</a><ul>
<li><code>Zeal.lnk $(CURRENT_WORD)</code> 在Zeal中查询选中内容</li>
<li><code>Typora.lnk &quot;$(FULL_CURRENT_PATH)&quot;</code> 在Typora中预览文件</li>
<li><code>ConEmu.lnk -Dir &quot;$(CURRENT_DIRECTORY)&quot;</code> 使用当前路径打开ConEmu</li>
<li>上述三个指令需要配置好全局变量, 或者使用绝对路径. </li>
<li>后缀名为lnk是因为我用了快捷方式放在同一个目录下, 简化设置全局变量的步骤</li>
<li><code>http://www.google.com/search?q=$(CURRENT_WORD)</code> 选中的内容直接google搜索</li>
</ul>
</li>
<li>环境变量的配置, 可以参考<a href="https://draapho.github.io/2016/10/09/1608-WinSoft-path/">Windows 软件系列-自定义环境变量</a></li>
<li>notepad++的宏录制功能也非常有用, 譬如可以录制一个 <code>TAB to Space</code> + <code>Trim Trailing Space</code> + <code>Save</code> 保存并设置快捷键为 <code>ctrl-s</code>, 这样就可以保存前自动完成空格处理了.</li>
</ul>
<h2 id="资源和参考"><a href="#资源和参考" class="headerlink" title="资源和参考"></a>资源和参考</h2><p><a href="https://notepad-plus-plus.org/" target="_blank" rel="external">Notepad++官网</a><br><a href="http://docs.notepad-plus-plus.org/index.php/Plugin_Central" target="_blank" rel="external">Notepad++插件中心</a><br><a href="http://docs.notepad-plus-plus.org/index.php/External_Programs" target="_blank" rel="external">Notepad++调用外部程序</a><br><a href="http://www.crifan.com/files/doc/docbook/rec_soft_npp/release/html/rec_soft_npp.html" target="_blank" rel="external">轻量级文本编辑器，Notepad最佳替代品：Notepad++</a><br><a href="http://jingyan.baidu.com/article/a24b33cd71f2d619ff002b60.html" target="_blank" rel="external">notepad++如何关联到右键菜单</a></p>
<h1 id="atom"><a href="#atom" class="headerlink" title="atom"></a><a href="https://atom.io/" target="_blank" rel="external">atom</a></h1><h2 id="atom简介"><a href="#atom简介" class="headerlink" title="atom简介"></a>atom简介</h2><ul>
<li>界面简洁, 基本上手可用, 无需复杂设置</li>
<li>开源免费, 而且多平台支持, 有丰富的插件库</li>
<li>和git的整合度很好! 直观明了好用</li>
<li>启动相对较慢, 但可接受.</li>
<li>懒人不想折腾, atom无明显短板, 就作为主力代码编辑器了</li>
<li>定位是 Notepad++ 为快速处理文件, atom 处理项目</li>
</ul>
<h2 id="两个快捷键"><a href="#两个快捷键" class="headerlink" title="两个快捷键"></a>两个快捷键</h2><ul>
<li>为了避免打开atom后一头雾水, 需要记住两个快捷键</li>
<li><code>ctrl+shift+p</code>, 打开atom命令窗口, 可以输入指令如<code>setting</code></li>
<li><code>ctrl+,</code> 打开设置页面</li>
</ul>
<h2 id="atom设置"><a href="#atom设置" class="headerlink" title="atom设置"></a>atom设置</h2><ul>
<li><code>ctrl+,</code>进入设置界面 <code>Settings</code></li>
<li><code>Editor</code> 界面下, 设置基本参数<ul>
<li><code>Show Ivisibles</code></li>
<li><code>Soft Tabs</code></li>
<li><code>Tab Length</code>-&gt;<code>4</code></li>
<li><code>Tab Type</code>-&gt;<code>auto</code>, 由于makefile必须为TAB, 否则可以设为 <code>soft</code> Tab键输入4个空格</li>
</ul>
</li>
<li><code>System</code> 界面下, 增加系统右键<ul>
<li><code>Register as file handler</code></li>
<li><code>Show in file context menus</code></li>
<li><code>Show in folder context menus</code></li>
</ul>
</li>
<li><code>Themes</code> 界面下, 选个喜欢的主题. 默认是<code>One Dark</code></li>
<li><code>Packages</code>-&gt;搜索<code>tree view</code>-&gt;<code>Core Packages</code>-&gt;<code>tree-view</code>-&gt;<code>Settings</code><ul>
<li><code>Hide Ignored Names</code> 隐藏atom指定的文件</li>
<li><code>Hide VCS Ignored Files</code> 隐藏<code>.gitignore</code>指定的文件</li>
</ul>
</li>
</ul>
<h2 id="atom插件"><a href="#atom插件" class="headerlink" title="atom插件"></a>atom插件</h2><ul>
<li>插件太多, 脱离需求讲插件是没有意义的. 新手的话, 先探索着玩玩吧.</li>
<li>记得仔细阅读插件的使用说明, 有些插件配置起来挺麻烦的. 但atom的插件管理已经很好了.</li>
<li>后续会根据自己的需求再写一篇atom的插件篇, 并详述如何配置.</li>
<li>下面推荐几个通用型的实用插件.</li>
<li><code>ctrl+,</code>进入设置界面 <code>Settings</code></li>
<li><code>Install</code> 界面下, 搜索安装如下插件<ul>
<li><code>atom-beautify</code> 代码格式美化, 需要安装辅助软件</li>
<li><code>git-time-machine</code> 查看比较文件的git历史</li>
<li><code>highlight-selected</code> 高亮选择的词</li>
<li><code>minimap</code> 文件小地图</li>
<li><code>minimap-highlight-selected</code> 在minimap内高亮选择的词</li>
<li><code>platformio-ide-terminal</code> 内嵌终端</li>
<li><code>project-manager</code> 管理项目.</li>
<li><code>project-viewer</code> 管理项目, 带UI</li>
<li><code>Sublime-Style-Column-Selection</code> 列操作使用<code>alt+drag</code></li>
<li><code>tabs-to-spaces</code> 空格/TAB自动转换</li>
<li><code>vim-mode</code> 提供vim模式.</li>
</ul>
</li>
</ul>
<h2 id="自定义快捷键"><a href="#自定义快捷键" class="headerlink" title="自定义快捷键"></a>自定义快捷键</h2><ul>
<li>以 <code>ctrl-f</code> 为例, 安装vim后, 变成翻页键, 但希望的是文件搜索和替换键.</li>
<li>可以禁止vim的<code>keybindings</code>, 但这里不适用, 因为还要用vim的其它快捷键.</li>
<li><code>ctrl+,</code>-&gt;进入设置界面 <code>Settings</code>-&gt;<code>Keybindings</code>-&gt;输入<code>ctrl-f</code></li>
<li>找到<code>vim-mode:scroll-full-screen-down</code>-&gt;点左边的复制图标</li>
<li><p>点击<code>your keymap file</code>-&gt;打开<code>keymap.cson</code>-&gt;黏贴内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&apos;atom-text-editor.vim-mode:not(.insert-mode)&apos;:</div><div class="line">  &apos;ctrl-f&apos;: &apos;vim-mode:scroll-full-screen-down&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>要屏蔽 vim 的 <code>ctrl-f</code>, 修改为<code>unset!</code>即可. 内容如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&apos;atom-text-editor.vim-mode:not(.insert-mode)&apos;:</div><div class="line">  &apos;ctrl-f&apos;: &apos;unset!&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>自定义详情可以参考官网的<a href="http://flight-manual.atom.io/using-atom/sections/basic-customization/#_customizing_keybindings" target="_blank" rel="external">Basic Customization</a></p>
</li>
<li>需按照<a href="https://draapho.github.io/2016/10/08/1607-Shortcut-win/">编辑器快捷键</a>设置</li>
<li>环境变量的配置, 可以参考<a href="https://draapho.github.io/2016/10/09/1608-WinSoft-path/">Windows 软件系列-自定义环境变量</a></li>
</ul>
<h1 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a><a href="http://www.typora.io/" target="_blank" rel="external">Typora</a></h1><h2 id="markdown简介"><a href="#markdown简介" class="headerlink" title="markdown简介"></a>markdown简介</h2><ul>
<li><strong><em>强烈推荐 Markdown</em></strong>, 基本可以放弃office word了!!!</li>
<li>markdown在专注于写作内容的同时, 快速便捷的自动美化格式</li>
<li><a href="https://draapho.github.io/about/markdownplus/">查看Markdown语法和效果</a></li>
<li>atom做编辑器也不错, 推荐插件 <code>markdown-preview-enhanced</code>. 但mermaid制图打印有问题.</li>
<li>而且什么都用atom, atom就太重了, 这里推荐 <a href="http://www.typora.io/" target="_blank" rel="external">Typora</a>.</li>
</ul>
<h2 id="Typora简介"><a href="#Typora简介" class="headerlink" title="Typora简介"></a>Typora简介</h2><ul>
<li><a href="http://www.typora.io/" target="_blank" rel="external">Typora</a>是一款极简的markdown编辑器. 多平台可用</li>
<li>单窗口显示, 使用 <code>ctrl+/</code> 切换预览和写作模式. 而且预览模式下也可直接写作.</li>
<li>支持<a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics" target="_blank" rel="external">LaTex数学公式</a>, <a href="http://knsv.github.io/mermaid/" target="_blank" rel="external">mermaid制图</a>,<a href="http://www.webpagefx.com/tools/emoji-cheat-sheet/" target="_blank" rel="external">Emoji图标</a></li>
<li>借助<a href="http://pandoc.org/" target="_blank" rel="external">pandoc</a>,可导出多种格式</li>
<li>缺点: 打开较慢, 不支持列操作, 不能用鼠标右键.</li>
<li>熟悉markdown格式后, 可以用notepad++写作, 用Typora查看效果和转换格式.</li>
</ul>
<h2 id="Typora安装和设置"><a href="#Typora安装和设置" class="headerlink" title="Typora安装和设置"></a>Typora安装和设置</h2><ul>
<li>下载并安装<a href="http://www.typora.io/#windows" target="_blank" rel="external">Typora windows 版本</a></li>
<li>下载并安装<a href="http://pandoc.org/installing.html" target="_blank" rel="external">pandoc-xxx-windows.msi</a></li>
<li>打开<code>Typora</code>-&gt;<code>File</code>-&gt;<code>Preference</code></li>
<li><code>Syntax Support</code> 使能如下选项<ul>
<li><code>Inline math</code> 数学公式</li>
<li><code>Subscript</code> 下标</li>
<li><code>Superscript</code> 上标</li>
<li><code>Highlight</code> 高亮</li>
<li><code>Diagrams</code> 制图</li>
</ul>
</li>
<li><code>Syntax Preference</code><ul>
<li><code>Heading Style</code> <code>atx(#)</code> 偏好使用<code>#</code>标记为标题</li>
<li><code>Unodered List</code> <code>-</code> 偏好使用<code>-</code>标记为列表</li>
</ul>
</li>
</ul>
<h2 id="markdown语法参考"><a href="#markdown语法参考" class="headerlink" title="markdown语法参考"></a>markdown语法参考</h2><ul>
<li><a href="https://draapho.github.io/about/markdownplus/">Markdown语法</a></li>
<li><a href="http://knsv.github.io/mermaid/" target="_blank" rel="external">mermaid制图</a></li>
<li><a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics" target="_blank" rel="external">LaTeX数学公式</a></li>
<li><a href="http://www.webpagefx.com/tools/emoji-cheat-sheet/" target="_blank" rel="external">Emoji图标</a></li>
</ul>
<h1 id="google-drive"><a href="#google-drive" class="headerlink" title="google drive"></a><a href="https://drive.google.com/" target="_blank" rel="external">google drive</a></h1><ul>
<li>主要作为云使用, 不少手机APP支持<a href="https://drive.google.com/" target="_blank" rel="external">google drive</a>, 而且还有好用的网页端应用</li>
<li>在线markdown编辑器<a href="https://stackedit.io/" target="_blank" rel="external">stackedit</a></li>
<li>在线制图软件<a href="https://www.draw.io" target="_blank" rel="external">draw.io</a></li>
<li>手机端markdown编辑器<a href="https://ia.net/writer" target="_blank" rel="external">iA Writer</a></li>
</ul>
<h1 id="默认新建utf-8文本文件"><a href="#默认新建utf-8文本文件" class="headerlink" title="默认新建utf-8文本文件"></a>默认新建utf-8文本文件</h1><ul>
<li>用notepad++建立一个样本文件, 命名为<code>UTF8.txt</code>, 设置为 <code>UTF-8</code> 编码(不带BOM), 放在 <code>C:\Windows\SHELLNEW</code> 下. 建议内容为空(内容会出现在新建文件中).</li>
<li><code>regedit</code>-&gt;打开 <code>注册表</code>-&gt;<code>HKEY_CLASSES_ROOT\.txt\ShellNew</code>-&gt;右侧新建 <code>字符串值</code>-&gt;名称 <code>FileName</code>-&gt; 数据 <code>UTF8.txt</code></li>
<li>此时, 新建的<code>文本文档</code>就是<code>UTF-8</code>编码的的文件. 事实上是复制了 <code>UTF8.txt</code> 这个样本文件.</li>
<li>参考 <a href="http://alanhou.org/windows-default-encoding-utf8/" target="_blank" rel="external">Windows新建文件改为默认UTF8</a></li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows 软件系列-提高效率]]></title>
      <url>https://draapho.github.io/2016/09/28/1602-WinSoft-efficiency/</url>
      <content type="html"><![CDATA[<h1 id="AutoHotKey"><a href="#AutoHotKey" class="headerlink" title="AutoHotKey"></a><a href="https://autohotkey.com/" target="_blank" rel="external">AutoHotKey</a></h1><h2 id="AHK-简介"><a href="#AHK-简介" class="headerlink" title="AHK 简介"></a>AHK 简介</h2><ul>
<li><a href="https://autohotkey.com/" target="_blank" rel="external">AutoHotkey</a>是一个windows下的开源, 免费, 自动化软件工具. </li>
<li>我主要用于绑定快捷键, 便于快速打开应用和文件夹. 以此提高<strong>工作效率</strong></li>
<li>常用符号含义<blockquote>
<p><code>#</code> 代表 Win 键<br><code>!</code> 代表 Alt 键<br><code>^</code> 代表 Ctrl 键<br><code>+</code> 代表 shift 键<br><code>::</code> 起分隔作用<br><code>run</code> 非常常用 的 AHK 命令之一<br><code>;</code>  注释后面一行内容</p>
</blockquote>
</li>
<li>举个例子<br>用 <code>Ctrl - Alt - Shift - Win - n</code> 打开记事本的脚本<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">^!+#n::run C:\Windows\notepad.exe</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="AHK懒人用法-ezAHK"><a href="#AHK懒人用法-ezAHK" class="headerlink" title="AHK懒人用法: ezAHK"></a>AHK懒人用法: <a href="https://github.com/draapho/ezAHK" target="_blank" rel="external">ezAHK</a></h2><ul>
<li>安装 <a href="https://autohotkey.com/download/" target="_blank" rel="external">AutoHotKey</a> V1.1.* 版本</li>
<li>下载 <a href="https://github.com/draapho/ezAHK" target="_blank" rel="external">ezAHK</a> 放到任意位置</li>
<li>把文件或目录的<strong>快捷方式放到link目录</strong>里, 改成希望使用的<strong>快捷键名称</strong>即可.<br>譬如, 希望把notepad绑定到 <code>win-n</code>这个快捷键, 只需要:<ol>
<li>创建<strong>notepad.exe的快捷方式</strong>到<strong>link目录</strong></li>
<li>重命名该快捷方式为 <code>win-n</code></li>
<li>注意 <code>-</code> 的左右<strong>没有空格</strong>, <strong>删除后缀</strong> <code>.exe</code></li>
<li>可以考虑使用 <code>win-r</code> 的方式替代, 毕竟快捷键数量有限, 命令行更灵活.</li>
</ol>
</li>
<li>ezAHK 还包括如下几个实用功能<ul>
<li><code>鼠标中键</code> 复制</li>
<li><code>shift-鼠标中键</code> 剪切</li>
<li><code>ctrl-shift-鼠标中键</code> 复制路径</li>
<li><code>鼠标右键</code> 使用鼠标中键复制后, 首次黏贴</li>
<li><code>ctrl-鼠标右键</code> 黏贴</li>
<li><code>ctrl-~</code> 根据所在目录打开终端</li>
<li><code>alt-win-鼠标中键</code> 复制颜色</li>
<li><code>alt-win-↑ ↓ ← →</code> 单像素移动鼠标</li>
<li><code>alt-win-d</code> 输入当前日期</li>
</ul>
</li>
<li>添加到开机自启动: 创建<code>ezAHK.ahk</code>的快捷方式, 并放到如下 Windows 的 <strong>StartUp目录</strong>.<br>Windows 10 的 StartUp 目录如下:<br><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code></li>
</ul>
<h2 id="资源和参考"><a href="#资源和参考" class="headerlink" title="资源和参考"></a>资源和参考</h2><ul>
<li><a href="https://autohotkey.com/boards/viewtopic.php?t=4296" target="_blank" rel="external">实用 AutoHotkey 脚本推荐</a></li>
<li><a href="https://autohotkey.com/boards/viewtopic.php?t=4267" target="_blank" rel="external">AHK 快餐店系列索引</a></li>
<li><a href="https://autohotkey.com/docs/scripts/#AutoHotkey_Script_Showcase" target="_blank" rel="external">AutoHotkey_Script_Showcase</a></li>
<li><a href="https://autohotkey.com/board/topic/60985-get-paths-of-selected-items-in-an-explorer-window/" target="_blank" rel="external">Get paths of selected items in an explorer window</a></li>
<li>AutoHotKey<a href="https://autohotkey.com/" target="_blank" rel="external">官网</a> 及 <a href="http://ahkcn.sourceforge.net/docs/AutoHotkey.htm" target="_blank" rel="external">中文帮助</a></li>
<li><a href="http://www.jeffjade.com/2016/03/11/2016-03-11-autohotkey/" target="_blank" rel="external">Win下最爱效率神器:AutoHotKey</a></li>
</ul>
<h1 id="快速搜索和定位"><a href="#快速搜索和定位" class="headerlink" title="快速搜索和定位"></a>快速搜索和定位</h1><h2 id="Everything"><a href="#Everything" class="headerlink" title="Everything"></a><a href="https://www.voidtools.com/" target="_blank" rel="external">Everything</a></h2><ul>
<li><a href="https://www.voidtools.com/" target="_blank" rel="external">Everything</a>是免费软件, 有<strong>便携版</strong>.</li>
<li><a href="https://www.voidtools.com/" target="_blank" rel="external">Everything</a>是<strong>普通搜索工具</strong>, 便于在搜索结果中慢慢查阅.</li>
</ul>
<h2 id="Listary"><a href="#Listary" class="headerlink" title="Listary"></a><a href="http://www.listary.com/" target="_blank" rel="external">Listary</a></h2><ul>
<li><a href="http://www.listary.com/" target="_blank" rel="external">Listary</a>分为免费版和专业版.</li>
<li>相比于 <a href="https://www.voidtools.com/" target="_blank" rel="external">Everything</a>, 索引方式相似,但操作体验完全不同.</li>
<li><a href="http://www.listary.com/" target="_blank" rel="external">Listary</a>是<strong>随时随地的查找定位</strong>, 目标明确时很方便. </li>
<li>强烈推荐都尝试一下后决定用哪个, 或和我一样同时使用.</li>
<li>Listary 实用快捷键</li>
</ul>
<table>
<thead>
<tr>
<th>Listary</th>
<th>助记</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>win-~</code></td>
<td></td>
<td>打开Listary</td>
</tr>
<tr>
<td><code>enter</code></td>
<td>enter</td>
<td>打开文件</td>
</tr>
<tr>
<td><code>ctrl-enter</code></td>
<td>enter</td>
<td>打开路径</td>
</tr>
<tr>
<td><code>ctrl-c</code></td>
<td>copy</td>
<td>复制</td>
</tr>
<tr>
<td><code>ctrl-shift-c</code></td>
<td>copy</td>
<td>复制路径</td>
</tr>
<tr>
<td><code>ctrl+j</code> <code>ctrl+k</code></td>
<td>vim j,k</td>
<td>下一个 / 上一个(需设置)</td>
</tr>
</tbody>
</table>
<h2 id="使用-win-r-快速启动"><a href="#使用-win-r-快速启动" class="headerlink" title="使用 win-r 快速启动"></a>使用 <code>win-r</code> 快速启动</h2><ul>
<li>基本原理是使用 <code>Run</code> 来直接运行配置在环境变量中的快捷方式 <code>.lnk</code>, </li>
<li>由于是执行命令行, 比快捷键方式有更好的扩展性和灵活性更好. 也可以在任何终端中直接调用!</li>
<li>运行环境的搭建可以参考 <a href="https://draapho.github.io/2016/10/09/1608-WinSoft-path/">Windows 软件系列-自定义环境变量</a></li>
<li>详细介绍可参考 <a href="https://xbeta.info/win-run.htm#h-6" target="_blank" rel="external">最绿色最高效，用win+r启动常用程序和文档</a></li>
<li>为了更省事, 可以使用AHK设置为<code>win</code>键替代<code>win-r</code>键</li>
<li>要把win键也省了的话, 专业版 <a href="http://www.listary.com/" target="_blank" rel="external">Listary</a> 可以满足这个需求</li>
</ul>
<h1 id="Ditto"><a href="#Ditto" class="headerlink" title="Ditto"></a><a href="http://ditto-cp.sourceforge.net/" target="_blank" rel="external">Ditto</a></h1><ul>
<li><a href="http://ditto-cp.sourceforge.net/" target="_blank" rel="external">Ditto</a> 一款剪切板增强软件, 免费开源. 有绿色便携版(无法支持部分功能)</li>
<li>对复制黏贴功能多多支持总是好的, 使用频率太高了! 这个软件的功能非常实用.<ul>
<li>软件的核心在于 <code>ctrl-~</code> 调用出 Ditto 信息板</li>
<li><code>shift-enter</code> 忽略格式黏贴纯文本</li>
<li><code>新建剪辑</code>-&gt;<code>项目标题</code> <code>email</code>-&gt;<code>快速黏贴文本</code> <code>myemail@gmail.com</code>-&gt;设置为<code>禁止自动删除</code>, 也可以归类到组. 以后只需输入email, 就可以直接黏贴具体email地址了</li>
<li>轻松管理复制历史, 可用作搜索资料, 然后批量黏贴</li>
</ul>
</li>
<li>重新设置 <code>激活Ditto</code> 快捷键为 <code>ctrl-q</code>, 因为 <code>ctrl-~</code>默认用于打开终端</li>
<li>参考 <a href="https://xbeta.info/ditto.htm" target="_blank" rel="external">Ditto:首选的剪贴板增强软件</a></li>
</ul>
<h1 id="Chocolatey"><a href="#Chocolatey" class="headerlink" title="Chocolatey"></a><del><a href="https://chocolatey.org/" target="_blank" rel="external">Chocolatey</a></del></h1><p><strong><a href="https://chocolatey.org/" target="_blank" rel="external">Chocolatey</a>可以作为软件安装的补充, 但不做推荐</strong> </p>
<h2 id="Chocolatey-简介"><a href="#Chocolatey-简介" class="headerlink" title="Chocolatey 简介"></a>Chocolatey 简介</h2><ul>
<li><a href="https://chocolatey.org/" target="_blank" rel="external">Chocolatey</a>是windows下的软件管理工具. 软件源由社区成员提交和维护. 基础版免费.</li>
<li>基于命令行来查找和安装软件,方便快捷,<del>耍酷</del>.</li>
<li>安装包的类型:<ul>
<li>无后缀, 如 git</li>
<li><em>.install, 如 git.install, 这个会出现在系统的 <em>*卸载或更改程序</em></em> 界面里</li>
<li>*.commandline, 如 git.commandline. 不建议使用</li>
<li>*.portable, 如 putty.portable, zip包, 我的理解就是绿色便携软件</li>
</ul>
</li>
<li>软件都是自动静默安装, 无法指定安装位置, 无法再安装时配置.</li>
<li>由于运行在管理员权限且不能保证软件绝对无毒, 所以有安全风险. <a href="https://chocolatey.org/about" target="_blank" rel="external">Chocolatey官网</a>有如下语句:<blockquote>
<p>If you need better peace of mind, we offer <a href="https://chocolatey.org/docs/features-virus-check" target="_blank" rel="external">runtime malware protection</a> in <a href="https://chocolatey.org/pricing" target="_blank" rel="external">Chocolatey Pro</a> and <a href="https://chocolatey.org/pricing" target="_blank" rel="external">Chocolatey for Business</a></p>
</blockquote>
</li>
<li>搜索和下载指定版本的软件也没有想象中方便.</li>
<li>综合考虑后, <a href="https://chocolatey.org/" target="_blank" rel="external">Chocolatey</a>可以作为软件安装的补充(如制作安装脚本), 但不做推荐</li>
</ul>
<h2 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h2><ul>
<li><p>windows <a href="https://chocolatey.org/install" target="_blank" rel="external">安装 Chocolatey</a>. 使用管理员权限打开 cmd.exe, 输入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@powershell -NoProfile -ExecutionPolicy Bypass -Command &quot;iex ((New-Object System.Net.WebClient).DownloadString(&apos;https://chocolatey.org/install.ps1&apos;))&quot; &amp;&amp; SET &quot;PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>几个常用指令</p>
<ul>
<li><code>choco -?</code> 帮助指令, 获取choco指令的详细说明</li>
<li><code>choco search</code> 搜索. 用 <code>-all</code> 可显示所有版本. 也可以查看<a href="https://chocolatey.org/packages/" target="_blank" rel="external">网页版</a></li>
<li><code>choco install</code> 安装. 用 ‘-version’ 可指定版本</li>
<li><code>choco upgrade</code> 升级</li>
<li><code>choco uninstall</code> 删除</li>
<li><code>choco list -localonly</code> 查看本地已安装的软件</li>
</ul>
</li>
<li>以nodejs为例<ul>
<li><code>choco search nodejs</code> 加 <code>-all</code> 会显示所有版本!!! </li>
<li>建议网页端搜索 <a href="https://chocolatey.org/packages/" target="_blank" rel="external"><strong>软件源列表</strong></a></li>
<li><code>choco install nodejs -version 5.0.0</code>  安装nodejs 5.0.0这个版本, 默认使用安装 <strong>.install</strong></li>
<li><code>choco upgrade nodejs</code>  升级nodejs到最新版本</li>
<li><code>choco uninstall nodejs</code>  删除nodejs</li>
<li><code>choco list -localonly</code> 确认是否已删除</li>
</ul>
</li>
</ul>
<h2 id="资料和参考"><a href="#资料和参考" class="headerlink" title="资料和参考"></a>资料和参考</h2><ul>
<li>Chocolatey 官方说明的 <a href="https://chocolatey.org/install" target="_blank" rel="external">安装方式</a></li>
<li><a href="https://chocolatey.org/packages/" target="_blank" rel="external">Chocolatey 软件源列表</a></li>
<li><a href="http://ninghao.net/blog/2071" target="_blank" rel="external">更好的安装软件的方法</a></li>
<li><a href="http://www.jianshu.com/p/831aa4a280e7" target="_blank" rel="external">Windows下的包管理器Chocolatey</a></li>
<li><a href="https://medium.com/@keivan/why-chocolatey-is-broken-beyond-any-hope-d1a4e33b3d23#.jzmj9o5cd" target="_blank" rel="external">Why Chocolatey is broken beyond any hope</a></li>
</ul>
<h1 id="Zeal"><a href="#Zeal" class="headerlink" title="Zeal"></a><a href="https://zealdocs.org/" target="_blank" rel="external">Zeal</a></h1><ul>
<li><a href="https://zealdocs.org/" target="_blank" rel="external">Zeal</a>是一款在windows和Linux上, 功能类似于Mac上Dash的一款离线文档查看软件.</li>
<li>免费软件, 有绿色便携版, 支持的手册种类和Dash是一样的. 应该是为了跨平台, 基于Qt5开发, 反应有点慢.</li>
<li>下载安装完成后, <code>Tool</code>-&gt;<code>Docksets...</code>-&gt;窗口<code>Docsets</code>下-&gt;<code>Available</code>-&gt;选择语言-&gt;<code>Download</code>即可.</li>
<li><strong>软件开发人员必备</strong>. 还可以在atom直接调用查看API, 省去大量的文档搜索时间.</li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Windows下使用github和hexo建独立博客]]></title>
      <url>https://draapho.github.io/2016/09/24/1601-InitBlog/</url>
      <content type="html"><![CDATA[<h1 id="我需要一个博客"><a href="#我需要一个博客" class="headerlink" title="我需要一个博客"></a>我需要一个<a href="https://draapho.github.io">博客</a></h1><p>三年前学linux的时候, 深感复杂,  然后也略微记录了些笔记放在电脑里. 但是真要用的时候, 依旧会google或baidu, 原因很简单: 电脑的笔记用起来不方便, 找文档慢不说, 找到后要么是没有格式的txt文档, 有些是花了力气排版好的word, 又觉得打开很慢. 于是觉得需要一个博客, 在CSDN开了博, 坚持不到10篇文章就放弃了, 原因很简单: 太麻烦了. 我的本意只是学习笔记加资料仓库, 但维护它的时间成本太高了. 一晃三年, 工作上进入一个新领域, 需要系统的学习嵌入式linux和python, 再度觉得需要建一个博客来管理和维护一些笔记和资料.</p>
<p><strong>工欲善其事, 必先利其器</strong>. 所以, 我需要一个博客. 寻寻觅觅, 幸运寻得github.io和markdown写作这么一个方案.</p>
<h1 id="折腾记-jekyII方案"><a href="#折腾记-jekyII方案" class="headerlink" title="折腾记, jekyII方案"></a><del>折腾记, jekyII方案</del></h1><p>不过依旧走了一点弯路, 因为github.io推荐的是jekyII环境, 如果对这个方案感兴趣, 点击<a href="https://help.github.com/articles/using-jekyll-as-a-static-site-generator-with-github-pages/" target="_blank" rel="external">这里</a>可以按照官方教程来操作. 人家第一句话就是<a href="https://help.github.com/articles/setting-up-your-github-pages-site-locally-with-jekyll/" target="_blank" rel="external"><strong>jekyII并不原生支持Windows</strong></a> , 但我岂是会轻易投降的人, 遇到问题就解决问题, 这不还有另外一句 <a href="http://jekyllrb.com/docs/windows/#installation" target="_blank" rel="external"><strong>Jekyll on Windows</strong></a>, 流程如下, 然后还要注意编码问题.</p>
<ul>
<li>装<a href="http://rubyinstaller.org/downloads/" target="_blank" rel="external">Ruby</a> 或者 <code>choco install ruby -y</code></li>
<li>装jekyII,   <code>gem install jekyll</code><br>最终, 我是安装失败了…具体卡在哪个错误提示也给忘了. 所幸的是搜到了对windows友好的hexo方案.</li>
</ul>
<h1 id="Hexo方案"><a href="#Hexo方案" class="headerlink" title="Hexo方案"></a>Hexo方案</h1><p>恩, 这里才是正文的开始! windows下安装hexo这个任务非常简单!</p>
<ul>
<li>对<a href="https://git-scm.com/" target="_blank" rel="external">Git软件</a>和<a href="https://github.com/" target="_blank" rel="external">GitHub网站</a>不熟的话, 建议安装<a href="https://desktop.github.com/" target="_blank" rel="external">GitHub Windows</a>, 安装后根据提示操作.</li>
<li>安装<a href="https://nodejs.org/en/" target="_blank" rel="external">Node.JS</a>, 选推荐版本, 目前是v4.5.0 LTS (即 Long Term Support), 环境变量默认会设置好.</li>
<li><p>安装Hexo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g hexo-cli</div></pre></td></tr></table></figure>
</li>
<li><p>创建并初始化博客文件夹,这里命名为<strong><em>Blog</em></strong>, 右键点”Git Bash Here”, 或者打开cmd进入到<strong><em>Blog</em></strong>目录下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cd Blog           # 确保在Blog这文件夹下</div><div class="line">npm install hexo --save # 安装hexo</div><div class="line">hexo init         # 初始化Blog文件夹内容</div><div class="line">npm install       # 安装必要的依赖包</div><div class="line"># 下面是必要的插件包</div><div class="line">npm install hexo-deployer-git --save      # 使用github发布</div><div class="line">npm install hexo-deployer-rsync --save    # 不装, 使用 rysnc发布</div><div class="line">npm install hexo-deployer-openshift --save    # 不装, 使用OpenShift发布</div><div class="line">npm install hexo-generator-feed --save    # 不装, 生成atom.xml, 供RSS使用</div><div class="line">npm install hexo-generator-sitemap --save # 不装, 生成sitemap.xml, 用于提高搜索量</div><div class="line">npm install hexo-generator-search --save  # 用于本地搜索</div></pre></td></tr></table></figure>
</li>
<li><p>本地查看效果, 输入<code>hexo s</code>成功后登录 <code>localhost:4000</code>查看效果<br>这里, 我遇到了错误, 提示是 4000 端口已经被占用.<br>最后发现是 foxitProtect.exe (福昕PDF保护进程)占用此端口, 先结束, 然后直接删除.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">netstat -aon | findstr &quot;4000&quot;     # 查找占用4000端口的PID, 譬如, 结果为1234</div><div class="line">tasklist | findstr &quot;1234&quot;         # 查找PID=1234的进程名称, 譬如, 结果为foxitProtect.exe</div><div class="line">taskkill /f /t /im foxitProtect.exe   # 强制杀死此进程</div></pre></td></tr></table></figure>
</li>
<li><p>配置 hexo 的 <code>_config.yml</code></p>
<blockquote>
<p># Site<br>title: DRA&amp;PHO                  # 博客名字<br>subtitle: thinking &amp; logging    # 副标题<br>description: Embedded System, IoT, M2M  # 博客描述<br>author: draapho                 # 作者<br>language: en        # 语言, 中文为 zh-Hans, 需设置category_map和tag_map</p>
<p># URL<br>url: <a href="https://YourGitHubName.github.io/" target="_blank" rel="external">https://YourGitHubName.github.io/</a>  # 替换<strong><em>YourGitHubName</em></strong><br># 譬如: <a href="https://draapho.github.io/">https://draapho.github.io/</a> 我的GitHub注册名是<strong><em>draapho</em></strong></p>
<p># Directory<br>source_dir: source      # source文件夹, 用来写文章<br>public_dir: public      # public文件夹, 自动生成的静态页面都放在这里<br>tag_dir: tags           # 标签文件夹, 需要安装 hexo-generator-tag<br>archive_dir: archives   # 归档文件夹, 需安装 hexo-generator-archive<br>category_dir: categories    # 分类文件夹, 需安装 hexo-generator-category</p>
<p># Extensions<br>theme: next         # 随了大流, 用了next主题</p>
<p># Deployment<br>deploy:<br>  type: git         # 使用git部署, 需安装 hexo-deployer-git<br>  repository: <a href="https://github.com/YourGitHubName/YourGitHubName.github.io.git" target="_blank" rel="external">https://github.com/YourGitHubName/YourGitHubName.github.io.git</a><br>  # 我的注册名是<strong><em>draapho</em></strong>, 就写成: <a href="https://github.com/draapho/draapho.github.io.git" target="_blank" rel="external">https://github.com/draapho/draapho.github.io.git</a><br>  branch: master</p>
<p># search Settings, 默认没有这行内容, 自己添加即可<br>search:             # 本地搜索功能, 需安装 hexo-generator-search<br>   path: search.xml<br>   field: post</p>
</blockquote>
</li>
<li><p>创建about,categories,tags文件夹及文件<br>在<code>Blog\source</code>下, 新建文件夹about, 然后新建文件index.md, 用于生成关于页面</p>
<blockquote>
<p>-–<br>title: about<br>date: 2016-09-08<br>comments: false<br>-–<br>这一篇的内容是自我介绍</p>
</blockquote>
<p>在<code>Blog\source</code>下, 新建文件夹categories, 然后新建文件index.md, 用于生成分类页面</p>
<blockquote>
<p>-–<br>title: categories<br>date: 2016-09-08<br>type: “categories”<br>comments: false<br>-–</p>
</blockquote>
<p>在<code>Blog\source</code>下, 新建文件夹tags, 然后新建文件index.md, 用于生成标签页面</p>
<blockquote>
<p>-–<br>title: tags<br>date: 2016-09-08<br>type: “tags”<br>comments: false<br>-–</p>
</blockquote>
</li>
</ul>
<h1 id="github端的配置"><a href="#github端的配置" class="headerlink" title="github端的配置"></a>github端的配置</h1><ul>
<li>如果之前没有使用过github, 第一次上传应该要求输入用户名和密码. 但如果每次部署都要这样, 就显得很麻烦. github端可以使用SSH 或 GPG keys来免去这个步骤. 建议使用GPG keys.</li>
<li>这里就不详细展开了, 具体步骤参考github, <a href="https://help.github.com/articles/generating-a-gpg-key/" target="_blank" rel="external">生成一个GPG key</a></li>
</ul>
<h1 id="使用mermaid插件支持流程图等"><a href="#使用mermaid插件支持流程图等" class="headerlink" title="使用mermaid插件支持流程图等"></a><del>使用mermaid插件支持流程图等</del></h1><ul>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-tag-mermaid --save</div></pre></td></tr></table></figure>
</li>
<li><p>添加mermaid依赖到主题模板<br>进入themes/your_theme_folder/layout/partial目录，添加mermaid相关文件。<br>head.jade 添加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">link(rel=&quot;stylesheet&quot;, href=url_for(&quot;https://cdn.bootcss.com/mermaid/6.0.0/mermaid.min.css&quot;))</div></pre></td></tr></table></figure>
<p>scripts.jade 添加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">link(rel=&quot;stylesheet&quot;, script(src=&quot;//cdn.bootcss.com/mermaid/6.0.0/mermaid.min.js&quot;)</div></pre></td></tr></table></figure>
</li>
<li><p>我暂时放弃了<br>next用的swig, 不知道和jade文件是什么关系. 暂时不愿去研究.<br>看了下此插件的格式, 和我常用的Typora使用的mermaid不一样.<br>博客上用到流程图之类的机会不多, 偶尔需要使用图片即可.<br>如有兴趣, 可参考 <a href="http://jcchow.com/2016/07/11/mermaid-sequence/" target="_blank" rel="external">Hexo流程图等插件安装教程</a></p>
</li>
</ul>
<h1 id="NexT主题"><a href="#NexT主题" class="headerlink" title="NexT主题"></a>NexT主题</h1><p>主题的选择我没有花太多时间, 测试了2-3个主题后, 最终还是随大流的用了NexT主题. 说实话, 设计感很好, 用的人很多, 略有审美疲劳. 好在博客目标明确, NexT能很好的覆盖我几个基本需求, 文档又写的很完善, 就不折腾了.</p>
<ul>
<li>安装NexT, 见<a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="external">官方文档</a></li>
<li>menu_icons 图标配置, 名称用的是<a href="http://fontawesome.io/icons/" target="_blank" rel="external">Font Awesome</a></li>
<li>about 页面的链接是 <a href="https://YourGitHubName.github.io/about" target="_blank" rel="external">https://YourGitHubName.github.io/about</a><br>我的注册名是<strong><em>draapho</em></strong>, 就写成 <a href="https://draapho.github.io/about">https://draapho.github.io/about</a></li>
<li><code>\themes\next\_config.yml</code>文件内找到<code>use_motion:</code> 设置为<code>false</code>. 表示禁止动画效果, 立刻显示页面</li>
</ul>
<h1 id="Hexo的日常使用"><a href="#Hexo的日常使用" class="headerlink" title="Hexo的日常使用"></a>Hexo的日常使用</h1><ul>
<li>习惯于直接在 \Blog\source_posts\ 下面直接新建文件 xxx.md<br>然后打开文件, 添加并修改如下内容:<blockquote>
<p>title: Windows下使用github和hexo建立自己的博客<br>date: 2016-09-08<br>categories: environment<br>tags: [blog, hexo, next]</p>
</blockquote>
</li>
<li>Hexo的常用指令<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hexo clean    #更换hexo主题后, 建议先执行此条命令清空</div><div class="line">hexo g        # g=generate, 生成public静态文件</div><div class="line">hexo s        # s=server, 本地发布预览效果, 默认地址是 localhost:4000</div><div class="line">hexo d        # d=deploy, 自动部署</div><div class="line">hexo d -g     # 我最常用的指令, 意思是先generate再deploy.</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="https://wsgzao.github.io/post/hexo-guide/" target="_blank" rel="external">使用GitHub和Hexo搭建免费静态Blog</a></li>
<li><a href="http://www.jianshu.com/p/35e197cb1273" target="_blank" rel="external">Hexo搭建Github-Pages博客填坑教程</a></li>
<li><a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="external">Hexo 文档</a></li>
<li><a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="external">Next 主题</a></li>
</ul>
<hr>
<p><strong><em>原创于 <a href="https://draapho.github.io/">DRA&amp;PHO</a></em></strong></p>
]]></content>
    </entry>
    
  
  
</search>
